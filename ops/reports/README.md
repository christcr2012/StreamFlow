# Binder Reports Directory

This directory contains reports generated by the binder processing and verification pipeline.

## Binder Processing Reports

### Generated by Binder Run
- **`validation_pre.json`** - Pre-processing validation data showing detected items in each binder
- **`validation_post.json`** - Post-processing validation data confirming items were processed
- **`orchestrator-report.json`** - Detailed log of each binder's processing (mode, counts, errors)
- **`FINAL_SUMMARY.md`** - Human-readable summary of the binder rebuild

## Verification Reports

### Generated by `npm run verify:binders` or `npm run guard:binders`
- **`VERIFY_SUMMARY.md`** - Human-readable verification summary
  - File counts (API, UI)
  - Generation marker detection
  - Mapping score (binder items → actual code)
  - Pass/Fail status
  
- **`verify_binder_to_code.json`** - Machine-readable verification data
  - Detailed metrics
  - Threshold comparisons
  - Individual check results

## Binder Guard & Self-Heal

### Overview

The binder system includes a self-healing guard that automatically:
1. Validates binder detection and generation quality
2. Retries failed binders with exponential backoff
3. Ensures all quality gates pass before allowing merges
4. Generates comprehensive reports

### Quick Start

**Run the full guard pipeline (recommended):**
```bash
npm run guard:binders
```

This will:
- Run pre-validation (detect items in binders)
- Execute orchestrator (generate code)
- Run post-validation (verify generation)
- Calculate success metrics
- Auto-retry failed binders if needed
- Verify code quality
- Generate all reports

### Individual Commands

```bash
# Pre-validation only
npm run binders:pre

# Run orchestrator only
npm run binders:run

# Post-validation only
npm run binders:post

# Retry failed binders
npm run binders:retry

# Verify generated code
npm run binders:verify

# Quick file statistics
npm run binders:quickstat
```

### Exit Codes

- `0` - All quality gates passed (success ≥95%, mapping 100%)
- `2` - Quality gates failed after retries
- `3` - Missing or corrupt reports

## Self-Heal Report

When binders fail, the system automatically retries them with:
- **Max retries:** 2 per binder
- **Backoff:** 20s, then 60s
- **Criteria for retry:**
  - Mapping score < 100%
  - Binder skipped but has content
  - Config hub artifacts missing
  - Generation failed

The self-heal log is saved to `self_heal_log.json` and appended to `FINAL_SUMMARY.md`.

## Quality Thresholds

**Hard Requirements (guard will fail if not met):**
- Success Rate: ≥95%
- Global Mapping Score: 100%
- Binder14 Artifacts: All present
  - `src/config/system-registry.ts`
  - `src/config/binder-map.json`
  - `src/app/admin/orchestrator-panel.tsx`

**Advisory Only (won't block):**
- Pre-existing TypeScript errors in app code
- Known issues: `AuditService.log`, `withAudience` signature

## CI/CD Integration

The GitHub Actions workflow `.github/workflows/binders-guard.yml` runs on:
- Pull requests to `main`
- Manual workflow dispatch

It will:
- Run the full guard pipeline
- Upload reports as artifacts
- Comment on PRs with results
- Block merge if quality gates fail

## Report Files

| File | Description |
|------|-------------|
| `validation_pre.json` | Items detected in each binder before processing |
| `validation_post.json` | Items detected after processing |
| `orchestrator-report.json` | Per-binder processing log (mode, counts, status) |
| `VERIFY_SUMMARY.md` | Human-readable verification summary |
| `verify_binder_to_code.json` | Machine-readable verification metrics |
| `FINAL_SUMMARY.md` | Executive summary with self-heal section |
| `self_heal_log.json` | Retry attempts and outcomes |

