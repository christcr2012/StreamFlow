"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/dashboard/summary";
exports.ids = ["pages/api/dashboard/summary"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard%2Fsummary&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fdashboard%2Fsummary.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard%2Fsummary&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fdashboard%2Fsummary.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_dashboard_summary_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/dashboard/summary.ts */ \"(api-node)/./src/pages/api/dashboard/summary.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_dashboard_summary_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_dashboard_summary_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/dashboard/summary\",\n        pathname: \"/api/dashboard/summary\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_dashboard_summary_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/dashboard/summary\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/dashboard/summary\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGZGFzaGJvYXJkJTJGc3VtbWFyeSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGZGFzaGJvYXJkJTJGc3VtbWFyeS50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDQztBQUN1QztBQUNyQztBQUMxRDtBQUNpRTtBQUNPO0FBQ0Y7QUFDdEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGdFQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxnRUFBUTtBQUNwQztBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRCxDQUFDO0FBQ007QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsS0FBcUIsRUFBRSxFQUUxQjtBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3REFBd0Q7QUFDcEU7QUFDQTtBQUNBLHVCQUF1Qiw0RUFBUztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSw2Q0FBNkMsRUFBNkM7QUFDMUYsNENBQTRDLEtBQXdDO0FBQ3BGLGlDQUFpQyxLQUFvQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0ZBQWM7QUFDL0UsK0RBQStELHlDQUF5QztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEVBQUUsTUFBTTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGtCQUFrQjtBQUNsQix1Q0FBdUMsUUFBUSxFQUFFLFFBQVE7QUFDekQ7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxRUFBUztBQUNqQixNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VuZEVycm9yIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBpLXV0aWxzXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyYy9wYWdlcy9hcGkvZGFzaGJvYXJkL3N1bW1hcnkudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZGFzaGJvYXJkL3N1bW1hcnlcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9kYXNoYm9hcmQvc3VtbWFyeVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kLFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJ1xufSk7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvZGFzaGJvYXJkL3N1bW1hcnlcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvZGFzaGJvYXJkL3N1bW1hcnlcIixcbiAgICAgICAgICAgICAgICBpbnRlcm5hbFJldmFsaWRhdGU6IHJvdXRlclNlcnZlckNvbnRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclNlcnZlckNvbnRleHQucmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiAoLi4uYXJncyk9Pm9uUmVxdWVzdEVycm9yKHJlcSwgLi4uYXJncylcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludm9rZVJvdXRlTW9kdWxlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gd2UgcmUtdGhyb3cgaW4gZGV2IHRvIHNob3cgdGhlIGVycm9yIG92ZXJsYXlcbiAgICAgICAgaWYgKHJvdXRlTW9kdWxlLmlzRGV2KSB7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcyBpcyB0ZWNobmljYWxseSBhbiBpbnZhcmlhbnQgYXMgZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgLy8gc2hvdWxkIGJlIGRvbmUgaW5zaWRlIG9mIGFwaS1yZXNvbHZlciBvbkVycm9yXG4gICAgICAgIHNlbmRFcnJvcihyZXMsIDUwMCwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicpO1xuICAgIH0gZmluYWxseXtcbiAgICAgICAgLy8gV2UgZG9uJ3QgYWxsb3cgYW55IHdhaXRVbnRpbCB3b3JrIGluIHBhZ2VzIEFQSSByb3V0ZXMgY3VycmVudGx5XG4gICAgICAgIC8vIHNvIGlmIGNhbGxiYWNrIGlzIHByZXNlbnQgcmV0dXJuIHdpdGggcmVzb2x2ZWQgcHJvbWlzZSBzaW5jZSBub1xuICAgICAgICAvLyBwZW5kaW5nIHdvcmtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard%2Fsummary&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fdashboard%2Fsummary.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/config/leadScoringConfig.ts":
/*!*****************************************!*\
  !*** ./src/config/leadScoringConfig.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/*\n * Lead Scoring Configuration - Northern Colorado Cleaning Business\n * \n * This module defines the scoring weights and modifiers used to prioritize leads\n * for a janitorial/cleaning business headquartered in Sterling, CO.\n * \n * ARCHITECTURE:\n * - Geographic Priority: Sterling (HQ) > Greeley > Fort Collins/Loveland > Denver\n * - Lead Type Modifiers: Hot (1.5x) > Warm (1.0x) > Cold (0.7x)\n * - Service Weights: Favor janitorial, carpet, floor care services\n * - Source Weights: Government RFPs get highest priority\n * \n * HOT vs WARM LEAD CLASSIFICATION:\n * - HOT: Actively seeking cleaning services (RFPs, solicitations) - get 50% boost\n * - WARM: May need services eventually (construction permits) - no modifier\n * - COLD: General prospects - 30% reduction\n * \n * FUTURE EXTENSIONS:\n * - Add seasonal modifiers (winter = higher indoor cleaning needs)\n * - Industry-specific weights (healthcare, schools get priority)\n * - Competition density scoring (fewer competitors = higher score)\n * - Customer lifetime value predictors\n * \n * CUSTOMIZATION:\n * - Adjust geoPriority weights based on service capacity and profitability\n * - Modify leadTypeModifiers.hot to be more/less aggressive on hot leads\n * - Add new serviceWeights for specialized services (move-in/out, post-construction)\n */ const config = {\n    geoPriority: {\n        // TIER 1: Sterling headquarters area (20+ points)\n        sterling: 25,\n        logan: 18,\n        // TIER 2: Primary service area (15-20 points)\n        greeley: 20,\n        evans: 15,\n        weld: 15,\n        // TIER 3: Secondary service area (10-12 points)\n        \"fort collins\": 12,\n        loveland: 12,\n        windsor: 10,\n        // TIER 4: Extended area (6-8 points)\n        longmont: 8,\n        boulder: 8,\n        // TIER 5: Denver metro - high value only (6-8 points)\n        denver: 8,\n        arvada: 6,\n        westminster: 6,\n        thornton: 6\n    },\n    serviceWeights: {\n        // CORE SERVICES (high margin, regular contracts)\n        janitorial: 20,\n        carpet: 15,\n        floorcare: 12,\n        // SPECIALTY SERVICES (growing demand)\n        disinfection: 8,\n        window: 5\n    },\n    sourceWeights: {\n        // HIGHEST VALUE SOURCES (pre-qualified, ready to buy)\n        LSA: 15,\n        RFP: 12,\n        // AUTOMATED SOURCES (consistent quality, scalable)\n        SYSTEM: 10,\n        // MANUAL SOURCES (variable quality, sales team dependent)\n        MANUAL: 5,\n        EMPLOYEE_REFERRAL: 0\n    },\n    leadTypeModifiers: {\n        // CRITICAL: These modifiers determine sales priority and response urgency\n        hot: 1.5,\n        // Examples: Active RFPs, inbound quote requests, existing customers\n        // Action: Respond within 2 hours, auto-SMS to sales team\n        warm: 1.0,\n        // Examples: Construction permits, new business openings, referrals\n        // Action: Educational email sequence, monthly follow-up\n        cold: 0.7\n    },\n    thresholds: {\n        // WORKFLOW AUTOMATION TRIGGERS - these determine lead routing and response\n        hot: 70,\n        // Actions: Immediate SMS alert, auto-assigned to senior rep,\n        // 2-hour response requirement, AI auto-response enabled\n        // Expected: ~15% of leads, 40%+ conversion rate\n        warm: 40\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (config);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9jb25maWcvbGVhZFNjb3JpbmdDb25maWcudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0EyQkMsR0EyQ0QsTUFBTUEsU0FBNEI7SUFDaENDLGFBQWE7UUFDWCxrREFBa0Q7UUFDbERDLFVBQVU7UUFDVkMsT0FBTztRQUVQLDhDQUE4QztRQUM5Q0MsU0FBUztRQUNUQyxPQUFPO1FBQ1BDLE1BQU07UUFFTixnREFBZ0Q7UUFDaEQsZ0JBQWdCO1FBQ2hCQyxVQUFVO1FBQ1ZDLFNBQVM7UUFFVCxxQ0FBcUM7UUFDckNDLFVBQVU7UUFDVkMsU0FBUztRQUVULHNEQUFzRDtRQUN0REMsUUFBUTtRQUNSQyxRQUFRO1FBQ1JDLGFBQWE7UUFDYkMsVUFBVTtJQUtaO0lBQ0FDLGdCQUFnQjtRQUNkLGlEQUFpRDtRQUNqREMsWUFBWTtRQUNaQyxRQUFRO1FBQ1JDLFdBQVc7UUFFWCxzQ0FBc0M7UUFDdENDLGNBQWM7UUFDZEMsUUFBUTtJQVFWO0lBQ0FDLGVBQWU7UUFDYixzREFBc0Q7UUFDdERDLEtBQUs7UUFDTEMsS0FBSztRQUVMLG1EQUFtRDtRQUNuREMsUUFBUTtRQUVSLDBEQUEwRDtRQUMxREMsUUFBUTtRQUNSQyxtQkFBbUI7SUFVckI7SUFDQUMsbUJBQW1CO1FBQ2pCLDBFQUEwRTtRQUUxRUMsS0FBSztRQUNPLG9FQUFvRTtRQUNwRSx5REFBeUQ7UUFFckVDLE1BQU07UUFDTSxtRUFBbUU7UUFDbkUsd0RBQXdEO1FBRXBFQyxNQUFNO0lBUVI7SUFDQUMsWUFBWTtRQUNWLDJFQUEyRTtRQUUzRUgsS0FBSztRQUNPLDZEQUE2RDtRQUM3RCx3REFBd0Q7UUFDeEQsZ0RBQWdEO1FBRTVEQyxNQUFNO0lBa0JSO0FBQ0Y7QUFFQSxpRUFBZTdCLE1BQU1BLEVBQUMiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL2NvbmZpZy9sZWFkU2NvcmluZ0NvbmZpZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTGVhZCBTY29yaW5nIENvbmZpZ3VyYXRpb24gLSBOb3J0aGVybiBDb2xvcmFkbyBDbGVhbmluZyBCdXNpbmVzc1xuICogXG4gKiBUaGlzIG1vZHVsZSBkZWZpbmVzIHRoZSBzY29yaW5nIHdlaWdodHMgYW5kIG1vZGlmaWVycyB1c2VkIHRvIHByaW9yaXRpemUgbGVhZHNcbiAqIGZvciBhIGphbml0b3JpYWwvY2xlYW5pbmcgYnVzaW5lc3MgaGVhZHF1YXJ0ZXJlZCBpbiBTdGVybGluZywgQ08uXG4gKiBcbiAqIEFSQ0hJVEVDVFVSRTpcbiAqIC0gR2VvZ3JhcGhpYyBQcmlvcml0eTogU3RlcmxpbmcgKEhRKSA+IEdyZWVsZXkgPiBGb3J0IENvbGxpbnMvTG92ZWxhbmQgPiBEZW52ZXJcbiAqIC0gTGVhZCBUeXBlIE1vZGlmaWVyczogSG90ICgxLjV4KSA+IFdhcm0gKDEuMHgpID4gQ29sZCAoMC43eClcbiAqIC0gU2VydmljZSBXZWlnaHRzOiBGYXZvciBqYW5pdG9yaWFsLCBjYXJwZXQsIGZsb29yIGNhcmUgc2VydmljZXNcbiAqIC0gU291cmNlIFdlaWdodHM6IEdvdmVybm1lbnQgUkZQcyBnZXQgaGlnaGVzdCBwcmlvcml0eVxuICogXG4gKiBIT1QgdnMgV0FSTSBMRUFEIENMQVNTSUZJQ0FUSU9OOlxuICogLSBIT1Q6IEFjdGl2ZWx5IHNlZWtpbmcgY2xlYW5pbmcgc2VydmljZXMgKFJGUHMsIHNvbGljaXRhdGlvbnMpIC0gZ2V0IDUwJSBib29zdFxuICogLSBXQVJNOiBNYXkgbmVlZCBzZXJ2aWNlcyBldmVudHVhbGx5IChjb25zdHJ1Y3Rpb24gcGVybWl0cykgLSBubyBtb2RpZmllclxuICogLSBDT0xEOiBHZW5lcmFsIHByb3NwZWN0cyAtIDMwJSByZWR1Y3Rpb25cbiAqIFxuICogRlVUVVJFIEVYVEVOU0lPTlM6XG4gKiAtIEFkZCBzZWFzb25hbCBtb2RpZmllcnMgKHdpbnRlciA9IGhpZ2hlciBpbmRvb3IgY2xlYW5pbmcgbmVlZHMpXG4gKiAtIEluZHVzdHJ5LXNwZWNpZmljIHdlaWdodHMgKGhlYWx0aGNhcmUsIHNjaG9vbHMgZ2V0IHByaW9yaXR5KVxuICogLSBDb21wZXRpdGlvbiBkZW5zaXR5IHNjb3JpbmcgKGZld2VyIGNvbXBldGl0b3JzID0gaGlnaGVyIHNjb3JlKVxuICogLSBDdXN0b21lciBsaWZldGltZSB2YWx1ZSBwcmVkaWN0b3JzXG4gKiBcbiAqIENVU1RPTUlaQVRJT046XG4gKiAtIEFkanVzdCBnZW9Qcmlvcml0eSB3ZWlnaHRzIGJhc2VkIG9uIHNlcnZpY2UgY2FwYWNpdHkgYW5kIHByb2ZpdGFiaWxpdHlcbiAqIC0gTW9kaWZ5IGxlYWRUeXBlTW9kaWZpZXJzLmhvdCB0byBiZSBtb3JlL2xlc3MgYWdncmVzc2l2ZSBvbiBob3QgbGVhZHNcbiAqIC0gQWRkIG5ldyBzZXJ2aWNlV2VpZ2h0cyBmb3Igc3BlY2lhbGl6ZWQgc2VydmljZXMgKG1vdmUtaW4vb3V0LCBwb3N0LWNvbnN0cnVjdGlvbilcbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIExlYWRTY29yaW5nQ29uZmlnIHtcbiAgLyoqXG4gICAqIEdlb2dyYXBoaWMgcHJpb3JpdHkgc2NvcmVzLiBLZXlzIGFyZSBsb3dlcmNhc2UgY2l0eSBvciBjb3VudHkgbmFtZXMgYW5kIHZhbHVlc1xuICAgKiBhcmUgcG9pbnRzIGFkZGVkIHdoZW4gYSBsZWFk4oCZcyBjaXR5IG1hdGNoZXMuIEFkanVzdCB0aGVzZSB2YWx1ZXMgdG8gcmVmbGVjdFxuICAgKiB5b3VyIGJ1c2luZXNz4oCZcyB0YXJnZXQgbWFya2V0cy5cbiAgICovXG4gIGdlb1ByaW9yaXR5OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuXG4gIC8qKlxuICAgKiBTZXJ2aWNlIHdlaWdodHMuIEtleXMgYXJlIGxvd2VyY2FzZSBzdWJzdHJpbmdzIG9mIGEgc2VydmljZSBkZXNjcmlwdGlvblxuICAgKiAoZS5nLiBcImphbml0b3JpYWxcIiwgXCJjYXJwZXRcIikuIEEgbWF0Y2ggYWRkcyB0aGUgc3BlY2lmaWVkIG51bWJlciBvZlxuICAgKiBwb2ludHMuIEV4dGVuZCB0aGlzIG1hcCBmb3IgYWRkaXRpb25hbCBzZXJ2aWNlIGNvZGVzLlxuICAgKi9cbiAgc2VydmljZVdlaWdodHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG5cbiAgLyoqXG4gICAqIFNvdXJjZSB3ZWlnaHRzLiBUaGVzZSBudW1iZXJzIGFyZSBhZGRlZCBiYXNlZCBvbiB0aGUgbGVhZOKAmXMgc291cmNlVHlwZS5cbiAgICogUkZQcyBhbmQgb3RoZXIgc3lzdGVtLWdlbmVyYXRlZCBsZWFkcyBhcmUgd2VpZ2h0ZWQgaGlnaGVzdC4gRW1wbG95ZWVcbiAgICogcmVmZXJyYWxzIGFyZSBpbnRlbnRpb25hbGx5IG5vbi1iaWxsYWJsZSBhbmQgdGhlcmVmb3JlIHJlY2VpdmUgbm8gYm9vc3QuXG4gICAqL1xuICBzb3VyY2VXZWlnaHRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuXG4gIC8qKlxuICAgKiBMZWFkIHR5cGUgc2NvcmluZyBtb2RpZmllcnMuIFRoZXNlIG11bHRpcGx5IHRoZSBiYXNlIHNjb3JlIHRvIHByaW9yaXRpemVcbiAgICogbGVhZHMgd2hvIGFyZSBhY3RpdmVseSBzZWVraW5nIHNlcnZpY2VzIHZzLiB0aG9zZSB3aG8gbWF5IG5lZWQgdGhlbSBldmVudHVhbGx5LlxuICAgKi9cbiAgbGVhZFR5cGVNb2RpZmllcnM6IHtcbiAgICBob3Q6IG51bWJlcjsgICAgLy8gQWN0aXZlbHkgc2Vla2luZyBjbGVhbmluZyBzZXJ2aWNlcyAoUkZQcywgc29saWNpdGF0aW9ucylcbiAgICB3YXJtOiBudW1iZXI7ICAgLy8gTWF5IG5lZWQgc2VydmljZXMgYnV0IG5vdCBhY3RpdmVseSBzZWVraW5nIChwZXJtaXRzLCBuZXcgYnVpbGRpbmdzKVxuICAgIGNvbGQ6IG51bWJlcjsgICAvLyBHZW5lcmFsIHByb3NwZWN0c1xuICB9O1xuXG4gIC8qKlxuICAgKiBTY29yaW5nIHRocmVzaG9sZHMgZm9yIGxlYWQgY2xhc3NpZmljYXRpb25cbiAgICovXG4gIHRocmVzaG9sZHM6IHtcbiAgICBob3Q6IG51bWJlcjsgICAgLy8gU2NvcmUgPj0gNzAgPSBIT1QgbGVhZCAoYWN0aXZlbHkgc2Vla2luZylcbiAgICB3YXJtOiBudW1iZXI7ICAgLy8gU2NvcmUgPj0gNDAgPSBXQVJNIGxlYWQgKGJlbG93IDQwID0gQ09MRClcbiAgfTtcbn1cblxuY29uc3QgY29uZmlnOiBMZWFkU2NvcmluZ0NvbmZpZyA9IHtcbiAgZ2VvUHJpb3JpdHk6IHtcbiAgICAvLyBUSUVSIDE6IFN0ZXJsaW5nIGhlYWRxdWFydGVycyBhcmVhICgyMCsgcG9pbnRzKVxuICAgIHN0ZXJsaW5nOiAyNSwgICAgICAgLy8gSFEgbG9jYXRpb24gLSAxNSBtaW4gZHJpdmUsIGxvd2VzdCBjb3N0cywgaGlnaGVzdCBtYXJnaW5cbiAgICBsb2dhbjogMTgsICAgICAgICAgIC8vIENvdW50eSBjb250cmFjdHMsIFN0ZXJsaW5nIGlzIGNvdW50eSBzZWF0XG4gICAgXG4gICAgLy8gVElFUiAyOiBQcmltYXJ5IHNlcnZpY2UgYXJlYSAoMTUtMjAgcG9pbnRzKVxuICAgIGdyZWVsZXk6IDIwLCAgICAgICAgLy8gTWFqb3IgbWFya2V0LCAzMCBtaW4gZHJpdmUsIGhpZ2ggY29tbWVyY2lhbCBkZW5zaXR5XG4gICAgZXZhbnM6IDE1LCAgICAgICAgICAvLyBHcmVlbGV5IHN1YnVyYiwgZ3Jvd2luZyBjb21tZXJjaWFsIGFyZWFcbiAgICB3ZWxkOiAxNSwgICAgICAgICAgIC8vIENvdW50eS1sZXZlbCBjb250cmFjdHMsIGdvb2Qgc2l6ZSBvcHBvcnR1bml0aWVzXG4gICAgXG4gICAgLy8gVElFUiAzOiBTZWNvbmRhcnkgc2VydmljZSBhcmVhICgxMC0xMiBwb2ludHMpXG4gICAgXCJmb3J0IGNvbGxpbnNcIjogMTIsIC8vIFVuaXZlcnNpdHkgdG93biwgNDUgbWluIGRyaXZlLCBjb21wZXRpdGl2ZSBtYXJrZXRcbiAgICBsb3ZlbGFuZDogMTIsICAgICAgIC8vIEdyb3dpbmcgY29tbWVyY2lhbCBhcmVhLCByZWFzb25hYmxlIGRyaXZlIHRpbWVcbiAgICB3aW5kc29yOiAxMCwgICAgICAgIC8vIFNtYWxsIGJ1dCBncm93aW5nLCBiZXR3ZWVuIEdyZWVsZXkgYW5kIEZvcnQgQ29sbGluc1xuICAgIFxuICAgIC8vIFRJRVIgNDogRXh0ZW5kZWQgYXJlYSAoNi04IHBvaW50cylcbiAgICBsb25nbW9udDogOCwgICAgICAgIC8vIDEgaG91ciBkcml2ZSwgbGFyZ2VyIGNvbnRyYWN0cyBvbmx5XG4gICAgYm91bGRlcjogOCwgICAgICAgICAvLyBVbml2ZXJzaXR5IHRvd24sIGNvbXBldGl0aXZlLCBsb25nZXIgZHJpdmVcbiAgICBcbiAgICAvLyBUSUVSIDU6IERlbnZlciBtZXRybyAtIGhpZ2ggdmFsdWUgb25seSAoNi04IHBvaW50cylcbiAgICBkZW52ZXI6IDgsICAgICAgICAgIC8vIDIrIGhvdXIgZHJpdmUsIHZlcnkgY29tcGV0aXRpdmUsICQ3NWsrIG1pbmltdW1cbiAgICBhcnZhZGE6IDYsICAgICAgICAgIC8vIERlbnZlciBzdWJ1cmIsIGxvbmdlciBkcml2ZVxuICAgIHdlc3RtaW5zdGVyOiA2LCAgICAgLy8gRGVudmVyIHN1YnVyYiwgbG9uZ2VyIGRyaXZlICBcbiAgICB0aG9ybnRvbjogNiwgICAgICAgIC8vIERlbnZlciBzdWJ1cmIsIGxvbmdlciBkcml2ZVxuICAgIFxuICAgIC8vIEZVVFVSRSBBRERJVElPTlM6XG4gICAgLy8gXCJjaGV5ZW5uZVwiOiAxMCwgICAgLy8gV3lvbWluZyBtYXJrZXQgZXhwYW5zaW9uXG4gICAgLy8gXCJuZWJyYXNrYVwiOiA1LCAgICAgLy8gTG9uZy10ZXJtIGV4cGFuc2lvbiBwb3NzaWJpbGl0eVxuICB9LFxuICBzZXJ2aWNlV2VpZ2h0czoge1xuICAgIC8vIENPUkUgU0VSVklDRVMgKGhpZ2ggbWFyZ2luLCByZWd1bGFyIGNvbnRyYWN0cylcbiAgICBqYW5pdG9yaWFsOiAyMCwgICAgLy8gUHJpbWFyeSBzZXJ2aWNlLCByZWN1cnJpbmcgcmV2ZW51ZSwgaGlnaGVzdCBwcmlvcml0eVxuICAgIGNhcnBldDogMTUsICAgICAgICAvLyBTcGVjaWFsaXplZCBlcXVpcG1lbnQsIGxlc3MgY29tcGV0aXRpb24sIGdvb2QgbWFyZ2luc1xuICAgIGZsb29yY2FyZTogMTIsICAgICAvLyBSZWd1bGFyIG1haW50ZW5hbmNlLCBwcmVkaWN0YWJsZSByZXZlbnVlXG4gICAgXG4gICAgLy8gU1BFQ0lBTFRZIFNFUlZJQ0VTIChncm93aW5nIGRlbWFuZClcbiAgICBkaXNpbmZlY3Rpb246IDgsICAgLy8gUG9zdC1DT1ZJRCBkZW1hbmQsIHByZW1pdW0gcHJpY2luZ1xuICAgIHdpbmRvdzogNSwgICAgICAgICAvLyBTZWFzb25hbCBhZGQtb24gc2VydmljZSwgZ29vZCBidW5kbGluZyBvcHBvcnR1bml0eVxuICAgIFxuICAgIC8vIEZVVFVSRSBTRVJWSUNFIEVYUEFOU0lPTlM6XG4gICAgLy8gXCJwb3N0LWNvbnN0cnVjdGlvblwiOiAxOCwgIC8vIEhvdCBsZWFkcyBmcm9tIG5ldyBidWlsZGluZ3NcbiAgICAvLyBcIm1lZGljYWxcIjogMTUsICAgICAgICAgICAvLyBTcGVjaWFsaXplZCBjbGVhbmluZywgaGlnaGVyIHJhdGVzXG4gICAgLy8gXCJzY2hvb2xcIjogMTIsICAgICAgICAgICAgLy8gTGFyZ2UgY29udHJhY3RzLCBzZWFzb25hbFxuICAgIC8vIFwiZW1lcmdlbmN5XCI6IDIwLCAgICAgICAgIC8vIEZsb29kL2ZpcmUgY2xlYW51cCwgdXJnZW50LCBwcmVtaXVtIHJhdGVzXG4gICAgLy8gXCJtb3ZlLW91dFwiOiAxMCwgICAgICAgICAgLy8gT25lLXRpbWUgc2VydmljZSwgZ29vZCBtYXJnaW5zXG4gIH0sXG4gIHNvdXJjZVdlaWdodHM6IHtcbiAgICAvLyBISUdIRVNUIFZBTFVFIFNPVVJDRVMgKHByZS1xdWFsaWZpZWQsIHJlYWR5IHRvIGJ1eSlcbiAgICBMU0E6IDE1LCAgICAgICAgICAgICAgIC8vIExlYWQgU2VydmljZSBBZ3JlZW1lbnQgcGFydG5lcnMsIHdhcm0gaW50cm9kdWN0aW9uc1xuICAgIFJGUDogMTIsICAgICAgICAgICAgICAgLy8gR292ZXJubWVudCBSRlBzLCBjbGVhciBidWRnZXRzLCBsZXNzIHByaWNlIHNob3BwaW5nXG4gICAgXG4gICAgLy8gQVVUT01BVEVEIFNPVVJDRVMgKGNvbnNpc3RlbnQgcXVhbGl0eSwgc2NhbGFibGUpXG4gICAgU1lTVEVNOiAxMCwgICAgICAgICAgICAvLyBBdXRvLWltcG9ydHMgKHBlcm1pdHMsIHB1YmxpYyByZWNvcmRzKSwgRlJFRSBzb3VyY2VzXG4gICAgXG4gICAgLy8gTUFOVUFMIFNPVVJDRVMgKHZhcmlhYmxlIHF1YWxpdHksIHNhbGVzIHRlYW0gZGVwZW5kZW50KVxuICAgIE1BTlVBTDogNSwgICAgICAgICAgICAgLy8gU2FsZXMtZ2VuZXJhdGVkLCBxdWFsaXR5IHZhcmllcyBieSByZXBcbiAgICBFTVBMT1lFRV9SRUZFUlJBTDogMCwgIC8vIEZyZWUgbGVhZHMsIG5vIGJvb3N0IHRvIGF2b2lkIGRvdWJsZS1jb3VudGluZyB2YWx1ZVxuICAgIFxuICAgIC8vIEZVVFVSRSBTT1VSQ0UgVFlQRVM6XG4gICAgLy8gXCJQQVJUTkVSU0hJUFwiOiAxMiwgICAgIC8vIFJlZmVycmFsIHBhcnRuZXJzIChjb250cmFjdG9ycywgcmVhbCBlc3RhdGUpXG4gICAgLy8gXCJXRUJTSVRFXCI6IDgsICAgICAgICAgIC8vIEluYm91bmQgd2ViIGxlYWRzLCBzZWxmLXF1YWxpZnlpbmdcbiAgICAvLyBcIlNPQ0lBTFwiOiAzLCAgICAgICAgICAgLy8gU29jaWFsIG1lZGlhIGxlYWRzLCB0eXBpY2FsbHkgbG93ZXIgcXVhbGl0eVxuICAgIC8vIFwiQ09MRF9DQUxMXCI6IDIsICAgICAgICAvLyBPdXRib3VuZCBjYWxsaW5nLCBsb3dlc3QgY29udmVyc2lvblxuICAgIFxuICAgIC8vIE5PVEU6IFRoZXNlIG1hcCB0byBMZWFkU291cmNlIGVudW0gaW4gUHJpc21hIHNjaGVtYVxuICAgIC8vIFRPRE86IFRyYWNrIGNvbnZlcnNpb24gcmF0ZXMgYnkgc291cmNlIGFuZCBhZGp1c3Qgd2VpZ2h0cyBhY2NvcmRpbmdseVxuICB9LFxuICBsZWFkVHlwZU1vZGlmaWVyczoge1xuICAgIC8vIENSSVRJQ0FMOiBUaGVzZSBtb2RpZmllcnMgZGV0ZXJtaW5lIHNhbGVzIHByaW9yaXR5IGFuZCByZXNwb25zZSB1cmdlbmN5XG4gICAgXG4gICAgaG90OiAxLjUsICAgLy8gNTAlIGJvb3N0IC0gQUNUSVZFTFkgU0VFS0lORyBzZXJ2aWNlcyByaWdodCBub3dcbiAgICAgICAgICAgICAgICAvLyBFeGFtcGxlczogQWN0aXZlIFJGUHMsIGluYm91bmQgcXVvdGUgcmVxdWVzdHMsIGV4aXN0aW5nIGN1c3RvbWVyc1xuICAgICAgICAgICAgICAgIC8vIEFjdGlvbjogUmVzcG9uZCB3aXRoaW4gMiBob3VycywgYXV0by1TTVMgdG8gc2FsZXMgdGVhbVxuICAgIFxuICAgIHdhcm06IDEuMCwgIC8vIE5vIG1vZGlmaWVyIC0gTUFZIE5FRUQgc2VydmljZXMgZXZlbnR1YWxseSAgXG4gICAgICAgICAgICAgICAgLy8gRXhhbXBsZXM6IENvbnN0cnVjdGlvbiBwZXJtaXRzLCBuZXcgYnVzaW5lc3Mgb3BlbmluZ3MsIHJlZmVycmFsc1xuICAgICAgICAgICAgICAgIC8vIEFjdGlvbjogRWR1Y2F0aW9uYWwgZW1haWwgc2VxdWVuY2UsIG1vbnRobHkgZm9sbG93LXVwXG4gICAgXG4gICAgY29sZDogMC43LCAgLy8gMzAlIHJlZHVjdGlvbiAtIEdlbmVyYWwgcHJvc3BlY3RzXG4gICAgICAgICAgICAgICAgLy8gRXhhbXBsZXM6IFByb3NwZWN0IGxpc3RzLCBvbGQgbGVhZHMsIGxvdy1lbmdhZ2VtZW50IGNvbnRhY3RzXG4gICAgICAgICAgICAgICAgLy8gQWN0aW9uOiBRdWFydGVybHkgbmV3c2xldHRlciwgbm8gaW1tZWRpYXRlIGZvbGxvdy11cFxuICAgIFxuICAgIC8vIEZVVFVSRSBURU1QRVJBVFVSRSBUWVBFUzpcbiAgICAvLyB1cmdlbnQ6IDIuMCwgICAvLyBFbWVyZ2VuY3kgY2xlYW5pbmcgKGZsb29kLCBmaXJlKSAtIGltbWVkaWF0ZSByZXNwb25zZVxuICAgIC8vIHJlbmV3YWw6IDEuMywgIC8vIEV4aXN0aW5nIGN1c3RvbWVyIGNvbnRyYWN0IHJlbmV3YWxzIC0gaGlnaCBwcmlvcml0eVxuICAgIC8vIGxvc3Q6IDAuNSwgICAgIC8vIFByZXZpb3VzbHkgbG9zdCBvcHBvcnR1bml0aWVzIC0gbG93ZXIgcHJpb3JpdHlcbiAgfSxcbiAgdGhyZXNob2xkczoge1xuICAgIC8vIFdPUktGTE9XIEFVVE9NQVRJT04gVFJJR0dFUlMgLSB0aGVzZSBkZXRlcm1pbmUgbGVhZCByb3V0aW5nIGFuZCByZXNwb25zZVxuICAgIFxuICAgIGhvdDogNzAsICAgIC8vIFNjb3JlID49IDcwID0gSE9UIExFQURcbiAgICAgICAgICAgICAgICAvLyBBY3Rpb25zOiBJbW1lZGlhdGUgU01TIGFsZXJ0LCBhdXRvLWFzc2lnbmVkIHRvIHNlbmlvciByZXAsXG4gICAgICAgICAgICAgICAgLy8gMi1ob3VyIHJlc3BvbnNlIHJlcXVpcmVtZW50LCBBSSBhdXRvLXJlc3BvbnNlIGVuYWJsZWRcbiAgICAgICAgICAgICAgICAvLyBFeHBlY3RlZDogfjE1JSBvZiBsZWFkcywgNDAlKyBjb252ZXJzaW9uIHJhdGVcbiAgICBcbiAgICB3YXJtOiA0MCwgICAvLyBTY29yZSA0MC02OSA9IFdBUk0gTEVBRCAgXG4gICAgICAgICAgICAgICAgLy8gQWN0aW9uczogV2Vla2x5IGZvbGxvdy11cCBxdWV1ZSwgZWR1Y2F0aW9uYWwgZW1haWwgc2VxdWVuY2UsXG4gICAgICAgICAgICAgICAgLy8gbW9udGhseSBjaGVjay1pbnMsIG5vIGltbWVkaWF0ZSByZXNwb25zZSByZXF1aXJlZFxuICAgICAgICAgICAgICAgIC8vIEV4cGVjdGVkOiB+MzUlIG9mIGxlYWRzLCAxMC0xNSUgY29udmVyc2lvbiByYXRlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2NvcmUgPDQwID0gQ09MRCBMRUFEIChpbXBsaWNpdClcbiAgICAgICAgICAgICAgICAvLyBBY3Rpb25zOiBRdWFydGVybHkgbmV3c2xldHRlciwgbWF5IGFyY2hpdmUgYWZ0ZXIgNiBtb250aHNcbiAgICAgICAgICAgICAgICAvLyBFeHBlY3RlZDogfjUwJSBvZiBsZWFkcywgMi01JSBjb252ZXJzaW9uIHJhdGVcbiAgICBcbiAgICAvLyBDQUxJQlJBVElPTiBOT1RFUzpcbiAgICAvLyAtIE1vbml0b3IgY29udmVyc2lvbiByYXRlcyBhbmQgYWRqdXN0IHRocmVzaG9sZHMgZm9yIG9wdGltYWwgUk9JXG4gICAgLy8gLSBIb3QgdGhyZXNob2xkIHRvbyBsb3cgPSBvdmVyd2hlbG1lZCBzYWxlcyB0ZWFtXG4gICAgLy8gLSBIb3QgdGhyZXNob2xkIHRvbyBoaWdoID0gbWlzc2VkIG9wcG9ydHVuaXRpZXNcbiAgICAvLyBcbiAgICAvLyBGVVRVUkUgRU5IQU5DRU1FTlRTOlxuICAgIC8vIC0gRHluYW1pYyB0aHJlc2hvbGRzIGJhc2VkIG9uIHNhbGVzIHRlYW0gY2FwYWNpdHlcbiAgICAvLyAtIEluZHVzdHJ5LXNwZWNpZmljIHRocmVzaG9sZHMgKGhlYWx0aGNhcmUgdnMgb2ZmaWNlIGNsZWFuaW5nKVxuICAgIC8vIC0gU2Vhc29uYWwgYWRqdXN0bWVudHMgKGhpZ2hlciBhY3Rpdml0eSBpbiBmYWxsL3dpbnRlcilcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbmZpZzsiXSwibmFtZXMiOlsiY29uZmlnIiwiZ2VvUHJpb3JpdHkiLCJzdGVybGluZyIsImxvZ2FuIiwiZ3JlZWxleSIsImV2YW5zIiwid2VsZCIsImxvdmVsYW5kIiwid2luZHNvciIsImxvbmdtb250IiwiYm91bGRlciIsImRlbnZlciIsImFydmFkYSIsIndlc3RtaW5zdGVyIiwidGhvcm50b24iLCJzZXJ2aWNlV2VpZ2h0cyIsImphbml0b3JpYWwiLCJjYXJwZXQiLCJmbG9vcmNhcmUiLCJkaXNpbmZlY3Rpb24iLCJ3aW5kb3ciLCJzb3VyY2VXZWlnaHRzIiwiTFNBIiwiUkZQIiwiU1lTVEVNIiwiTUFOVUFMIiwiRU1QTE9ZRUVfUkVGRVJSQUwiLCJsZWFkVHlwZU1vZGlmaWVycyIsImhvdCIsIndhcm0iLCJjb2xkIiwidGhyZXNob2xkcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/config/leadScoringConfig.ts\n");

/***/ }),

/***/ "(api-node)/./src/lib/leadScoring.ts":
/*!********************************!*\
  !*** ./src/lib/leadScoring.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isSystemGenerated: () => (/* binding */ isSystemGenerated),\n/* harmony export */   scoreLead: () => (/* binding */ scoreLead)\n/* harmony export */ });\n/* harmony import */ var _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/config/leadScoringConfig */ \"(api-node)/./src/config/leadScoringConfig.ts\");\n// src/lib/leadScoring.ts\n// Lead Scoring Engine - Northern Colorado Cleaning Business\n// Lead scoring utilities. Scoring is driven by a configuration file (see\n// src/config/leadScoringConfig.ts). Each lead is assigned a baseline score\n// which is adjusted based on geography, service keywords and the lead’s source\n// type. A list of reasons is returned alongside the numeric score.\n\n/**\n * Compute a lead score based on the lead’s attributes and the current scoring\n * configuration. Scores are clamped between 1 and 99. Reasons describe\n * which factors contributed to the score.\n */ function scoreLead(lead) {\n    let score = 50; // Baseline score - average lead with no special factors\n    const reasons = []; // Track scoring factors for transparency\n    const city = (lead.city || \"\").trim().toLowerCase();\n    const state = (lead.state || \"\").trim().toUpperCase();\n    const zip = (lead.zip || \"\").trim();\n    const svc = (lead.serviceCode || \"\").trim().toLowerCase();\n    const srcType = (lead.sourceType || \"\").trim().toUpperCase();\n    const detail = (lead.sourceDetail || \"\").trim().toLowerCase();\n    // Geographic weighting: state and priority cities/counties\n    if (state === \"CO\") {\n        score += 10;\n        reasons.push(\"Colorado service area\");\n    }\n    if (city && _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].geoPriority[city]) {\n        score += _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].geoPriority[city];\n        reasons.push(`Priority city: ${city}`);\n    }\n    // Recognize Logan/Weld county prefixes (806xx, 807xx) in ZIP\n    if (/^806|^807/.test(zip)) {\n        score += 8;\n        reasons.push(`ZIP in target bands (${zip.slice(0, 3)}xx)`);\n    }\n    // Service weighting: match substring within service code/description\n    for (const key of Object.keys(_config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].serviceWeights)){\n        if (svc.includes(key)) {\n            const pts = _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].serviceWeights[key];\n            score += pts;\n            reasons.push(`Service match: ${key}`);\n            break;\n        }\n    }\n    // Source weighting: use sourceType; fallback to heuristics based on detail\n    if (srcType) {\n        const pts = _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].sourceWeights[srcType];\n        if (typeof pts === \"number\") {\n            score += pts;\n            reasons.push(`Source type: ${srcType}`);\n        }\n    }\n    // Additional boost if SAM/RFP keywords appear in detail\n    if (detail.includes(\"sam.gov\") || detail.includes(\"rfp\")) {\n        score += _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].sourceWeights.RFP ?? 12;\n        reasons.push(\"Government RFP (SAM.gov)\");\n    }\n    // Service description keyword matching\n    const serviceDesc = (lead.serviceDescription || lead.title || \"\").toLowerCase();\n    for (const key of Object.keys(_config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].serviceWeights)){\n        if (serviceDesc.includes(key)) {\n            const pts = Math.floor(_config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].serviceWeights[key] * 0.5); // Half points for description match\n            score += pts;\n            reasons.push(`Service description match: ${key}`);\n            break;\n        }\n    }\n    // Apply lead type modifier (hot/warm/cold)\n    const leadType = lead.leadType?.toLowerCase();\n    if (leadType && _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].leadTypeModifiers[leadType]) {\n        const modifier = _config_leadScoringConfig__WEBPACK_IMPORTED_MODULE_0__[\"default\"].leadTypeModifiers[leadType];\n        const originalScore = score;\n        score = Math.round(score * modifier);\n        reasons.push(`${leadType.toUpperCase()} lead modifier: ${modifier}x (${originalScore} → ${score})`);\n    }\n    // Clamp between 1 and 99\n    score = Math.max(1, Math.min(99, Math.round(score)));\n    return {\n        score,\n        reasons\n    };\n}\n/**\n * Determine if a lead appears to be system-generated. This helper remains for\n * backwards compatibility. It checks the sourceDetail string for common\n * indicators. New code should prefer the systemGenerated flag on Lead.\n */ function isSystemGenerated(sourceDetail) {\n    const d = (sourceDetail || \"\").toLowerCase();\n    return d.includes(\"sam.gov\") || d.includes(\"rfp\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDaEQ7UUFDRjtJQUNGO0lBRUEsMkNBQTJDO0lBQzNDLE1BQU1hLFdBQVdoQyxLQUFLZ0MsUUFBUSxFQUFFM0I7SUFDaEMsSUFBSTJCLFlBQVlsQyxtRkFBd0IsQ0FBQ2tDLFNBQVMsRUFBRTtRQUNsRCxNQUFNRSxXQUFXcEMsbUZBQXdCLENBQUNrQyxTQUFTO1FBQ25ELE1BQU1HLGdCQUFnQmxDO1FBQ3RCQSxRQUFRNkIsS0FBS00sS0FBSyxDQUFDbkMsUUFBUWlDO1FBQzNCaEMsUUFBUWEsSUFBSSxDQUFDLEdBQUdpQixTQUFTekIsV0FBVyxHQUFHLGdCQUFnQixFQUFFMkIsU0FBUyxHQUFHLEVBQUVDLGNBQWMsR0FBRyxFQUFFbEMsTUFBTSxDQUFDLENBQUM7SUFDcEc7SUFFQSx5QkFBeUI7SUFDekJBLFFBQVE2QixLQUFLTyxHQUFHLENBQUMsR0FBR1AsS0FBS1EsR0FBRyxDQUFDLElBQUlSLEtBQUtNLEtBQUssQ0FBQ25DO0lBQzVDLE9BQU87UUFBRUE7UUFBT0M7SUFBUTtBQUMxQjtBQUVBOzs7O0NBSUMsR0FDTSxTQUFTcUMsa0JBQWtCekIsWUFBNEI7SUFDNUQsTUFBTTBCLElBQUksQ0FBQzFCLGdCQUFnQixFQUFDLEVBQUdULFdBQVc7SUFDMUMsT0FBT21DLEVBQUVqQixRQUFRLENBQUMsY0FBY2lCLEVBQUVqQixRQUFRLENBQUM7QUFDN0MiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL2xpYi9sZWFkU2NvcmluZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL2xlYWRTY29yaW5nLnRzXG4vLyBMZWFkIFNjb3JpbmcgRW5naW5lIC0gTm9ydGhlcm4gQ29sb3JhZG8gQ2xlYW5pbmcgQnVzaW5lc3Ncbi8vIExlYWQgc2NvcmluZyB1dGlsaXRpZXMuIFNjb3JpbmcgaXMgZHJpdmVuIGJ5IGEgY29uZmlndXJhdGlvbiBmaWxlIChzZWVcbi8vIHNyYy9jb25maWcvbGVhZFNjb3JpbmdDb25maWcudHMpLiBFYWNoIGxlYWQgaXMgYXNzaWduZWQgYSBiYXNlbGluZSBzY29yZVxuLy8gd2hpY2ggaXMgYWRqdXN0ZWQgYmFzZWQgb24gZ2VvZ3JhcGh5LCBzZXJ2aWNlIGtleXdvcmRzIGFuZCB0aGUgbGVhZOKAmXMgc291cmNlXG4vLyB0eXBlLiBBIGxpc3Qgb2YgcmVhc29ucyBpcyByZXR1cm5lZCBhbG9uZ3NpZGUgdGhlIG51bWVyaWMgc2NvcmUuXG5cbmltcG9ydCBjb25maWcgZnJvbSBcIkAvY29uZmlnL2xlYWRTY29yaW5nQ29uZmlnXCI7XG5cbi8vIExlYWQgZGF0YSBzdHJ1Y3R1cmUgZm9yIHNjb3JpbmcgaW5wdXRcbi8vIEZsZXhpYmxlIGludGVyZmFjZSBhY2NlcHRzIGxlYWRzIGZyb20gdmFyaW91cyBzb3VyY2VzIChTQU0uZ292LCBwZXJtaXRzLCBtYW51YWwgZW50cnkpXG5leHBvcnQgdHlwZSBMZWFkTGlrZSA9IHtcbiAgLy8gR0VPR1JBUEhJQyBUQVJHRVRJTkcgKGRyaXZlcyBwcm94aW1pdHkgc2NvcmluZylcbiAgY2l0eT86IHN0cmluZyB8IG51bGw7ICAgICAgICAgIC8vIFByaW1hcnkgY2l0eSBmb3Igc2VydmljZSBkZWxpdmVyeVxuICBzdGF0ZT86IHN0cmluZyB8IG51bGw7ICAgICAgICAgLy8gU3RhdGUgKENvbG9yYWRvIGdldHMgKzEwIGJvbnVzKVxuICB6aXA/OiBzdHJpbmcgfCBudWxsOyAgICAgICAgICAgLy8gWklQIGNvZGUgKDgwNnh4LzgwN3h4IGdldCBjb3VudHkgYm9udXMpXG4gIFxuICAvLyBTRVJWSUNFIENMQVNTSUZJQ0FUSU9OIChkcml2ZXMgc2VydmljZSB0eXBlIHNjb3JpbmcpXG4gIHNlcnZpY2VDb2RlPzogc3RyaW5nIHwgbnVsbDsgICAgICAvLyBQcmltYXJ5IHNlcnZpY2UgdHlwZSBjb2RlXG4gIHNvdXJjZVR5cGU/OiBzdHJpbmcgfCBudWxsOyAgICAgIC8vIE1hcHMgdG8gTGVhZFNvdXJjZSBlbnVtIChSRlAsIFNZU1RFTSwgZXRjKVxuICBzb3VyY2VEZXRhaWw/OiBzdHJpbmcgfCBudWxsOyAgICAvLyBBZGRpdGlvbmFsIHNvdXJjZSBjb250ZXh0XG4gIGxlYWRUeXBlPzogJ2hvdCcgfCAnd2FybScgfCAnY29sZCcgfCBudWxsOyAvLyBQdXJjaGFzZSBpbnRlbnQgbGV2ZWxcbiAgc2VydmljZURlc2NyaXB0aW9uPzogc3RyaW5nIHwgbnVsbDsgLy8gRnVsbCBzZXJ2aWNlIGRlc2NyaXB0aW9uXG4gIHRpdGxlPzogc3RyaW5nIHwgbnVsbDsgICAgICAgICAgIC8vIExlYWQgdGl0bGVcbiAgXG4gIC8vIEdPVkVSTk1FTlQgQ09OVFJBQ1QgRklFTERTIChmb3IgU0FNLmdvdiBSRlBzKVxuICBhZ2VuY3k/OiBzdHJpbmcgfCBudWxsOyAgICAgICAgICAvLyBHb3Zlcm5tZW50IGFnZW5jeSBuYW1lXG4gIG5haWNzPzogc3RyaW5nIHwgbnVsbDsgICAgICAgICAgIC8vIE5BSUNTIGluZHVzdHJ5IGNvZGVcbiAgcHNjPzogc3RyaW5nIHwgbnVsbDsgICAgICAgICAgICAgLy8gUHJvZHVjdCBTZXJ2aWNlIENvZGVcbn07XG5cbi8vIFNjb3JpbmcgcmVzdWx0IHdpdGggZGV0YWlsZWQgcmVhc29uaW5nIGZvciB0cmFuc3BhcmVuY3lcbmV4cG9ydCB0eXBlIFNjb3JlUmVzdWx0ID0geyBcbiAgc2NvcmU6IG51bWJlcjsgICAgICAvLyBGaW5hbCBzY29yZSAoMS05OSwgaGlnaGVyID0gaGlnaGVyIHByaW9yaXR5KVxuICByZWFzb25zOiBzdHJpbmdbXTsgIC8vIEh1bWFuLXJlYWRhYmxlIGV4cGxhbmF0aW9ucyBmb3Igc2FsZXMgdGVhbVxufTtcblxuLyoqXG4gKiBDb21wdXRlIGEgbGVhZCBzY29yZSBiYXNlZCBvbiB0aGUgbGVhZOKAmXMgYXR0cmlidXRlcyBhbmQgdGhlIGN1cnJlbnQgc2NvcmluZ1xuICogY29uZmlndXJhdGlvbi4gU2NvcmVzIGFyZSBjbGFtcGVkIGJldHdlZW4gMSBhbmQgOTkuIFJlYXNvbnMgZGVzY3JpYmVcbiAqIHdoaWNoIGZhY3RvcnMgY29udHJpYnV0ZWQgdG8gdGhlIHNjb3JlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NvcmVMZWFkKGxlYWQ6IExlYWRMaWtlKTogU2NvcmVSZXN1bHQge1xuICBsZXQgc2NvcmUgPSA1MDsgLy8gQmFzZWxpbmUgc2NvcmUgLSBhdmVyYWdlIGxlYWQgd2l0aCBubyBzcGVjaWFsIGZhY3RvcnNcbiAgY29uc3QgcmVhc29uczogc3RyaW5nW10gPSBbXTsgLy8gVHJhY2sgc2NvcmluZyBmYWN0b3JzIGZvciB0cmFuc3BhcmVuY3lcblxuICBjb25zdCBjaXR5ID0gKGxlYWQuY2l0eSB8fCBcIlwiKS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgY29uc3Qgc3RhdGUgPSAobGVhZC5zdGF0ZSB8fCBcIlwiKS50cmltKCkudG9VcHBlckNhc2UoKTtcbiAgY29uc3QgemlwID0gKGxlYWQuemlwIHx8IFwiXCIpLnRyaW0oKTtcbiAgY29uc3Qgc3ZjID0gKGxlYWQuc2VydmljZUNvZGUgfHwgXCJcIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHNyY1R5cGUgPSAobGVhZC5zb3VyY2VUeXBlIHx8IFwiXCIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpO1xuICBjb25zdCBkZXRhaWwgPSAobGVhZC5zb3VyY2VEZXRhaWwgfHwgXCJcIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gR2VvZ3JhcGhpYyB3ZWlnaHRpbmc6IHN0YXRlIGFuZCBwcmlvcml0eSBjaXRpZXMvY291bnRpZXNcbiAgaWYgKHN0YXRlID09PSBcIkNPXCIpIHtcbiAgICBzY29yZSArPSAxMDtcbiAgICByZWFzb25zLnB1c2goXCJDb2xvcmFkbyBzZXJ2aWNlIGFyZWFcIik7XG4gIH1cbiAgaWYgKGNpdHkgJiYgY29uZmlnLmdlb1ByaW9yaXR5W2NpdHldKSB7XG4gICAgc2NvcmUgKz0gY29uZmlnLmdlb1ByaW9yaXR5W2NpdHldO1xuICAgIHJlYXNvbnMucHVzaChgUHJpb3JpdHkgY2l0eTogJHtjaXR5fWApO1xuICB9XG4gIC8vIFJlY29nbml6ZSBMb2dhbi9XZWxkIGNvdW50eSBwcmVmaXhlcyAoODA2eHgsIDgwN3h4KSBpbiBaSVBcbiAgaWYgKC9eODA2fF44MDcvLnRlc3QoemlwKSkge1xuICAgIHNjb3JlICs9IDg7XG4gICAgcmVhc29ucy5wdXNoKGBaSVAgaW4gdGFyZ2V0IGJhbmRzICgke3ppcC5zbGljZSgwLCAzKX14eClgKTtcbiAgfVxuXG4gIC8vIFNlcnZpY2Ugd2VpZ2h0aW5nOiBtYXRjaCBzdWJzdHJpbmcgd2l0aGluIHNlcnZpY2UgY29kZS9kZXNjcmlwdGlvblxuICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhjb25maWcuc2VydmljZVdlaWdodHMpKSB7XG4gICAgaWYgKHN2Yy5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICBjb25zdCBwdHMgPSBjb25maWcuc2VydmljZVdlaWdodHNba2V5XTtcbiAgICAgIHNjb3JlICs9IHB0cztcbiAgICAgIHJlYXNvbnMucHVzaChgU2VydmljZSBtYXRjaDogJHtrZXl9YCk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBTb3VyY2Ugd2VpZ2h0aW5nOiB1c2Ugc291cmNlVHlwZTsgZmFsbGJhY2sgdG8gaGV1cmlzdGljcyBiYXNlZCBvbiBkZXRhaWxcbiAgaWYgKHNyY1R5cGUpIHtcbiAgICBjb25zdCBwdHMgPSBjb25maWcuc291cmNlV2VpZ2h0c1tzcmNUeXBlIGFzIGtleW9mIHR5cGVvZiBjb25maWcuc291cmNlV2VpZ2h0c107XG4gICAgaWYgKHR5cGVvZiBwdHMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHNjb3JlICs9IHB0cztcbiAgICAgIHJlYXNvbnMucHVzaChgU291cmNlIHR5cGU6ICR7c3JjVHlwZX1gKTtcbiAgICB9XG4gIH1cbiAgLy8gQWRkaXRpb25hbCBib29zdCBpZiBTQU0vUkZQIGtleXdvcmRzIGFwcGVhciBpbiBkZXRhaWxcbiAgaWYgKGRldGFpbC5pbmNsdWRlcyhcInNhbS5nb3ZcIikgfHwgZGV0YWlsLmluY2x1ZGVzKFwicmZwXCIpKSB7XG4gICAgc2NvcmUgKz0gY29uZmlnLnNvdXJjZVdlaWdodHMuUkZQID8/IDEyO1xuICAgIHJlYXNvbnMucHVzaChcIkdvdmVybm1lbnQgUkZQIChTQU0uZ292KVwiKTtcbiAgfVxuXG4gIC8vIFNlcnZpY2UgZGVzY3JpcHRpb24ga2V5d29yZCBtYXRjaGluZ1xuICBjb25zdCBzZXJ2aWNlRGVzYyA9IChsZWFkLnNlcnZpY2VEZXNjcmlwdGlvbiB8fCBsZWFkLnRpdGxlIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGNvbmZpZy5zZXJ2aWNlV2VpZ2h0cykpIHtcbiAgICBpZiAoc2VydmljZURlc2MuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgY29uc3QgcHRzID0gTWF0aC5mbG9vcihjb25maWcuc2VydmljZVdlaWdodHNba2V5XSAqIDAuNSk7IC8vIEhhbGYgcG9pbnRzIGZvciBkZXNjcmlwdGlvbiBtYXRjaFxuICAgICAgc2NvcmUgKz0gcHRzO1xuICAgICAgcmVhc29ucy5wdXNoKGBTZXJ2aWNlIGRlc2NyaXB0aW9uIG1hdGNoOiAke2tleX1gKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFwcGx5IGxlYWQgdHlwZSBtb2RpZmllciAoaG90L3dhcm0vY29sZClcbiAgY29uc3QgbGVhZFR5cGUgPSBsZWFkLmxlYWRUeXBlPy50b0xvd2VyQ2FzZSgpIGFzIGtleW9mIHR5cGVvZiBjb25maWcubGVhZFR5cGVNb2RpZmllcnM7XG4gIGlmIChsZWFkVHlwZSAmJiBjb25maWcubGVhZFR5cGVNb2RpZmllcnNbbGVhZFR5cGVdKSB7XG4gICAgY29uc3QgbW9kaWZpZXIgPSBjb25maWcubGVhZFR5cGVNb2RpZmllcnNbbGVhZFR5cGVdO1xuICAgIGNvbnN0IG9yaWdpbmFsU2NvcmUgPSBzY29yZTtcbiAgICBzY29yZSA9IE1hdGgucm91bmQoc2NvcmUgKiBtb2RpZmllcik7XG4gICAgcmVhc29ucy5wdXNoKGAke2xlYWRUeXBlLnRvVXBwZXJDYXNlKCl9IGxlYWQgbW9kaWZpZXI6ICR7bW9kaWZpZXJ9eCAoJHtvcmlnaW5hbFNjb3JlfSDihpIgJHtzY29yZX0pYCk7XG4gIH1cblxuICAvLyBDbGFtcCBiZXR3ZWVuIDEgYW5kIDk5XG4gIHNjb3JlID0gTWF0aC5tYXgoMSwgTWF0aC5taW4oOTksIE1hdGgucm91bmQoc2NvcmUpKSk7XG4gIHJldHVybiB7IHNjb3JlLCByZWFzb25zIH07XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgbGVhZCBhcHBlYXJzIHRvIGJlIHN5c3RlbS1nZW5lcmF0ZWQuIFRoaXMgaGVscGVyIHJlbWFpbnMgZm9yXG4gKiBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4gSXQgY2hlY2tzIHRoZSBzb3VyY2VEZXRhaWwgc3RyaW5nIGZvciBjb21tb25cbiAqIGluZGljYXRvcnMuIE5ldyBjb2RlIHNob3VsZCBwcmVmZXIgdGhlIHN5c3RlbUdlbmVyYXRlZCBmbGFnIG9uIExlYWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1N5c3RlbUdlbmVyYXRlZChzb3VyY2VEZXRhaWw/OiBzdHJpbmcgfCBudWxsKTogYm9vbGVhbiB7XG4gIGNvbnN0IGQgPSAoc291cmNlRGV0YWlsIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiBkLmluY2x1ZGVzKFwic2FtLmdvdlwiKSB8fCBkLmluY2x1ZGVzKFwicmZwXCIpO1xufSJdLCJuYW1lcyI6WyJjb25maWciLCJzY29yZUxlYWQiLCJsZWFkIiwic2NvcmUiLCJyZWFzb25zIiwiY2l0eSIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInN0YXRlIiwidG9VcHBlckNhc2UiLCJ6aXAiLCJzdmMiLCJzZXJ2aWNlQ29kZSIsInNyY1R5cGUiLCJzb3VyY2VUeXBlIiwiZGV0YWlsIiwic291cmNlRGV0YWlsIiwicHVzaCIsImdlb1ByaW9yaXR5IiwidGVzdCIsInNsaWNlIiwia2V5IiwiT2JqZWN0Iiwia2V5cyIsInNlcnZpY2VXZWlnaHRzIiwiaW5jbHVkZXMiLCJwdHMiLCJzb3VyY2VXZWlnaHRzIiwiUkZQIiwic2VydmljZURlc2MiLCJzZXJ2aWNlRGVzY3JpcHRpb24iLCJ0aXRsZSIsIk1hdGgiLCJmbG9vciIsImxlYWRUeXBlIiwibGVhZFR5cGVNb2RpZmllcnMiLCJtb2RpZmllciIsIm9yaWdpbmFsU2NvcmUiLCJyb3VuZCIsIm1heCIsIm1pbiIsImlzU3lzdGVtR2VuZXJhdGVkIiwiZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/leadScoring.ts\n");

/***/ }),

/***/ "(api-node)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n// src/lib/prisma.ts\n\nconst prisma = global.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) global.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLG9CQUFvQjtBQUMwQjtBQVF2QyxNQUFNQyxTQUNYQyxPQUFPRCxNQUFNLElBQ2IsSUFBSUQsd0RBQVlBLENBQUM7SUFDZkcsS0FBS0MsS0FBc0MsR0FBRztRQUFDO1FBQVM7UUFBUztLQUFPLEdBQUcsQ0FBUztBQUN0RixHQUFHO0FBRUwsSUFBSUEsSUFBcUMsRUFBRUYsT0FBT0QsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zcmMvbGliL3ByaXNtYS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL3ByaXNtYS50c1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gQWxsb3cgZ2xvYmFsIGB2YXJgIHJlZGVjbGFyYXRpb24gaW4gZGV2XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsLnByaXNtYSA/P1xuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBbXCJxdWVyeVwiLCBcImVycm9yXCIsIFwid2FyblwiXSA6IFtcImVycm9yXCJdLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikgZ2xvYmFsLnByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJnbG9iYWwiLCJsb2ciLCJwcm9jZXNzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(api-node)/./src/lib/rbac.ts":
/*!*************************!*\
  !*** ./src/lib/rbac.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PERMS: () => (/* binding */ PERMS),\n/* harmony export */   assertPermission: () => (/* binding */ assertPermission),\n/* harmony export */   getEmailFromReq: () => (/* binding */ getEmailFromReq),\n/* harmony export */   getOrgIdFromReq: () => (/* binding */ getOrgIdFromReq)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(api-node)/./src/lib/prisma.ts\");\n// src/lib/rbac.ts\n\n/**\n * Enterprise-Grade Permission Catalog\n * Granular read/write permissions for all business modules\n * Keep codes in sync with seed.\n */ const PERMS = {\n    // Dashboard & Analytics\n    DASHBOARD_VIEW: \"dashboard:view\",\n    ANALYTICS_READ: \"analytics:read\",\n    REPORTS_READ: \"reports:read\",\n    REPORTS_CREATE: \"reports:create\",\n    REPORTS_EXPORT: \"reports:export\",\n    // Lead Management\n    LEAD_READ: \"lead:read\",\n    LEAD_CREATE: \"lead:create\",\n    LEAD_UPDATE: \"lead:update\",\n    LEAD_DELETE: \"lead:delete\",\n    LEAD_EXPORT: \"lead:export\",\n    LEAD_ASSIGN: \"lead:assign\",\n    LEAD_CONVERT: \"lead:convert\",\n    // Job Management\n    JOB_READ: \"job:read\",\n    JOB_CREATE: \"job:create\",\n    JOB_UPDATE: \"job:update\",\n    JOB_DELETE: \"job:delete\",\n    JOB_ASSIGN: \"job:assign\",\n    JOB_SCHEDULE: \"job:schedule\",\n    JOB_COMPLETE: \"job:complete\",\n    // Workforce Management\n    EMPLOYEE_READ: \"employee:read\",\n    EMPLOYEE_CREATE: \"employee:create\",\n    EMPLOYEE_UPDATE: \"employee:update\",\n    EMPLOYEE_DELETE: \"employee:delete\",\n    EMPLOYEE_SCHEDULE: \"employee:schedule\",\n    PAYROLL_READ: \"payroll:read\",\n    PAYROLL_MANAGE: \"payroll:manage\",\n    TIMECLOCK_READ: \"timeclock:read\",\n    TIMECLOCK_MANAGE: \"timeclock:manage\",\n    // HR Management\n    HR_READ: \"hr:read\",\n    HR_MANAGE: \"hr:manage\",\n    HR_HIRE: \"hr:hire\",\n    HR_TERMINATE: \"hr:terminate\",\n    TRAINING_READ: \"training:read\",\n    TRAINING_MANAGE: \"training:manage\",\n    TRAINING_ASSIGN: \"training:assign\",\n    // Client & Customer Management\n    CLIENT_READ: \"client:read\",\n    CLIENT_CREATE: \"client:create\",\n    CLIENT_UPDATE: \"client:update\",\n    CLIENT_DELETE: \"client:delete\",\n    CLIENT_COMMUNICATE: \"client:communicate\",\n    // Financial Management\n    BILLING_READ: \"billing:read\",\n    BILLING_MANAGE: \"billing:manage\",\n    INVOICE_READ: \"invoice:read\",\n    INVOICE_CREATE: \"invoice:create\",\n    INVOICE_UPDATE: \"invoice:update\",\n    INVOICE_DELETE: \"invoice:delete\",\n    PAYMENT_READ: \"payment:read\",\n    PAYMENT_PROCESS: \"payment:process\",\n    REVENUE_READ: \"revenue:read\",\n    REVENUE_MANAGE: \"revenue:manage\",\n    // Operations & Scheduling\n    SCHEDULE_READ: \"schedule:read\",\n    SCHEDULE_MANAGE: \"schedule:manage\",\n    OPERATIONS_READ: \"operations:read\",\n    OPERATIONS_MANAGE: \"operations:manage\",\n    INVENTORY_READ: \"inventory:read\",\n    INVENTORY_MANAGE: \"inventory:manage\",\n    // System Administration\n    USER_READ: \"user:read\",\n    USER_CREATE: \"user:create\",\n    USER_UPDATE: \"user:update\",\n    USER_DELETE: \"user:delete\",\n    USER_IMPERSONATE: \"user:impersonate\",\n    PASSWORD_RESET: \"password:reset\",\n    ROLES_READ: \"roles:read\",\n    ROLES_MANAGE: \"roles:manage\",\n    SYSTEM_SETTINGS: \"system:settings\",\n    SYSTEM_BACKUP: \"system:backup\",\n    AUDIT_READ: \"audit:read\",\n    // Provider Portal (White-label)\n    PROVIDER_DASHBOARD: \"provider:dashboard\",\n    PROVIDER_BILLING: \"provider:billing\",\n    PROVIDER_ANALYTICS: \"provider:analytics\",\n    PROVIDER_SETTINGS: \"provider:settings\",\n    PROVIDER_CLIENTS: \"provider:clients\",\n    // Document & Asset Management\n    DOCUMENT_READ: \"document:read\",\n    DOCUMENT_CREATE: \"document:create\",\n    DOCUMENT_UPDATE: \"document:update\",\n    DOCUMENT_DELETE: \"document:delete\",\n    MEDIA_READ: \"media:read\",\n    MEDIA_UPLOAD: \"media:upload\",\n    MEDIA_DELETE: \"media:delete\"\n};\n/**\n * Email that should bypass RBAC permission checks entirely.\n * If DEV_USER_EMAIL is set in the environment, any request from that\n * email address will be treated as having all permissions. This is\n * useful for development and automated testing. In production you\n * should leave DEV_USER_EMAIL unset.\n */ const DEV_USER_EMAIL = process.env.DEV_USER_EMAIL?.toLowerCase() || null;\n/**\n * Extract current user's email from cookie or header.\n * - Cookie: mv_user=<email>\n * - Header: x-mv-user: <email>  (useful for scripts/tests)\n */ function getEmailFromReq(req) {\n    const fromCookie = req.cookies?.mv_user;\n    const fromHeader = req.headers[\"x-mv-user\"] || req.headers[\"x-mvuser\"];\n    const raw = (Array.isArray(fromCookie) ? fromCookie[0] : fromCookie) ?? fromHeader ?? \"\";\n    const email = raw?.toString().trim().toLowerCase();\n    return email || null;\n}\n/** Look up orgId for current user (used to scope queries). */ async function getOrgIdFromReq(req) {\n    const email = getEmailFromReq(req);\n    if (!email) return null;\n    // Development bypass: if this is the dev user, return a fixed orgId\n    // if provided via DEV_ORG_ID, otherwise fall through to DB lookup.\n    if (DEV_USER_EMAIL && email === DEV_USER_EMAIL) {\n        // Use DEV_ORG_ID if provided, else null to indicate no org\n        const devOrg = process.env.DEV_ORG_ID;\n        if (devOrg) return devOrg;\n        // As a fallback, attempt to fetch the first org from the database\n        try {\n            const firstOrg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.org.findFirst({\n                select: {\n                    id: true\n                }\n            });\n            return firstOrg?.id ?? null;\n        } catch  {\n            return null;\n        }\n    }\n    const u = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email\n        },\n        select: {\n            orgId: true\n        }\n    });\n    return u?.orgId ?? null;\n}\n/**\n * Fetch user's effective permissions from RBAC tables.\n * Falls back to legacy User.role for OWNER/MANAGER/STAFF convenience.\n */ async function getUserPermCodes(userId, legacyRole) {\n    const roleLinks = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.rbacUserRole.findMany({\n        where: {\n            userId\n        },\n        select: {\n            roleId: true\n        }\n    });\n    const roleIds = roleLinks.map((r)=>r.roleId);\n    const perms = roleIds.length ? await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.rbacRolePermission.findMany({\n        where: {\n            roleId: {\n                in: roleIds\n            }\n        },\n        include: {\n            permission: true\n        }\n    }) : [];\n    const codes = new Set(perms.map((rp)=>rp.permission.code));\n    // Legacy role convenience (non-blocking): give sensible defaults based on enterprise role hierarchy\n    switch((legacyRole || \"\").toUpperCase()){\n        case \"OWNER\":\n            // Owners get full system access - all permissions\n            Object.values(PERMS).forEach((c)=>codes.add(c));\n            break;\n        case \"MANAGER\":\n            // Managers get operational control but limited system administration\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.ANALYTICS_READ,\n                PERMS.REPORTS_READ,\n                PERMS.REPORTS_CREATE,\n                PERMS.REPORTS_EXPORT,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE,\n                PERMS.LEAD_DELETE,\n                PERMS.LEAD_EXPORT,\n                PERMS.LEAD_ASSIGN,\n                PERMS.LEAD_CONVERT,\n                PERMS.JOB_READ,\n                PERMS.JOB_CREATE,\n                PERMS.JOB_UPDATE,\n                PERMS.JOB_DELETE,\n                PERMS.JOB_ASSIGN,\n                PERMS.JOB_SCHEDULE,\n                PERMS.JOB_COMPLETE,\n                PERMS.EMPLOYEE_READ,\n                PERMS.EMPLOYEE_UPDATE,\n                PERMS.EMPLOYEE_SCHEDULE,\n                PERMS.PAYROLL_READ,\n                PERMS.TIMECLOCK_READ,\n                PERMS.TIMECLOCK_MANAGE,\n                PERMS.TRAINING_READ,\n                PERMS.TRAINING_ASSIGN,\n                PERMS.CLIENT_READ,\n                PERMS.CLIENT_CREATE,\n                PERMS.CLIENT_UPDATE,\n                PERMS.CLIENT_COMMUNICATE,\n                PERMS.BILLING_READ,\n                PERMS.INVOICE_READ,\n                PERMS.INVOICE_CREATE,\n                PERMS.INVOICE_UPDATE,\n                PERMS.PAYMENT_READ,\n                PERMS.REVENUE_READ,\n                PERMS.SCHEDULE_READ,\n                PERMS.SCHEDULE_MANAGE,\n                PERMS.OPERATIONS_READ,\n                PERMS.OPERATIONS_MANAGE,\n                PERMS.INVENTORY_READ,\n                PERMS.INVENTORY_MANAGE,\n                PERMS.DOCUMENT_READ,\n                PERMS.DOCUMENT_CREATE,\n                PERMS.DOCUMENT_UPDATE,\n                PERMS.MEDIA_READ,\n                PERMS.MEDIA_UPLOAD\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"STAFF\":\n            // Staff get basic operational access - mostly read with limited write\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE,\n                PERMS.JOB_READ,\n                PERMS.JOB_UPDATE,\n                PERMS.TIMECLOCK_READ,\n                PERMS.TRAINING_READ,\n                PERMS.CLIENT_READ,\n                PERMS.SCHEDULE_READ,\n                PERMS.OPERATIONS_READ,\n                PERMS.INVENTORY_READ,\n                PERMS.DOCUMENT_READ,\n                PERMS.MEDIA_READ\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"ACCOUNTANT\":\n            // Accountants get financial and HR management access\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.ANALYTICS_READ,\n                PERMS.REPORTS_READ,\n                PERMS.REPORTS_CREATE,\n                PERMS.REPORTS_EXPORT,\n                PERMS.EMPLOYEE_READ,\n                PERMS.PAYROLL_READ,\n                PERMS.PAYROLL_MANAGE,\n                PERMS.TIMECLOCK_READ,\n                PERMS.HR_READ,\n                PERMS.BILLING_READ,\n                PERMS.BILLING_MANAGE,\n                PERMS.INVOICE_READ,\n                PERMS.INVOICE_CREATE,\n                PERMS.INVOICE_UPDATE,\n                PERMS.INVOICE_DELETE,\n                PERMS.PAYMENT_READ,\n                PERMS.PAYMENT_PROCESS,\n                PERMS.REVENUE_READ,\n                PERMS.REVENUE_MANAGE,\n                PERMS.DOCUMENT_READ,\n                PERMS.DOCUMENT_CREATE,\n                PERMS.AUDIT_READ\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"PROVIDER\":\n            // Provider gets provider portal access and client management\n            [\n                PERMS.PROVIDER_DASHBOARD,\n                PERMS.PROVIDER_BILLING,\n                PERMS.PROVIDER_ANALYTICS,\n                PERMS.PROVIDER_SETTINGS,\n                PERMS.PROVIDER_CLIENTS,\n                PERMS.ANALYTICS_READ,\n                PERMS.REPORTS_READ,\n                PERMS.BILLING_READ,\n                PERMS.REVENUE_READ\n            ].forEach((c)=>codes.add(c));\n            break;\n    }\n    return codes;\n}\n/**\n * Assert that current request is from an authenticated user with a given permission.\n * Writes 401/403 to res if not allowed. Returns true if allowed, false otherwise.\n */ async function assertPermission(req, res, required) {\n    try {\n        const email = getEmailFromReq(req);\n        if (!email) {\n            res.status(401).json({\n                ok: false,\n                error: \"Unauthorized\"\n            });\n            return false;\n        }\n        // Development bypass: if the incoming email matches the DEV_USER_EMAIL\n        // then skip any database lookups and allow the request. This permits\n        // automated tests and development sessions to exercise any API\n        // regardless of the user's persisted role or permissions. If no\n        // DEV_USER_EMAIL is configured, this block has no effect.\n        if (DEV_USER_EMAIL && email === DEV_USER_EMAIL) {\n            return true;\n        }\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                email\n            },\n            select: {\n                id: true,\n                role: true\n            }\n        });\n        if (!user) {\n            res.status(401).json({\n                ok: false,\n                error: \"Unauthorized\"\n            });\n            return false;\n        }\n        const codes = await getUserPermCodes(user.id, user.role);\n        if (!codes.has(required)) {\n            res.status(403).json({\n                ok: false,\n                error: \"Forbidden\"\n            });\n            return false;\n        }\n        return true;\n    } catch (e) {\n        console.error(\"assertPermission error:\", e);\n        res.status(500).json({\n            ok: false,\n            error: \"Internal Server Error\"\n        });\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TTtZQUNmUyxRQUFRO2dCQUFFQyxJQUFJO2dCQUFNdUMsTUFBTTtZQUFLO1FBQ2pDO1FBRUEsSUFBSSxDQUFDckMsTUFBTTtZQUNUK0IsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsSUFBSTtnQkFBT0MsT0FBTztZQUFlO1lBQ3hELE9BQU87UUFDVDtRQUVBLE1BQU1oQixRQUFRLE1BQU1oQixpQkFBaUJKLEtBQUtGLEVBQUUsRUFBRUUsS0FBS3FDLElBQUk7UUFDdkQsSUFBSSxDQUFDakIsTUFBTWtCLEdBQUcsQ0FBQ04sV0FBVztZQUN4QkQsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsSUFBSTtnQkFBT0MsT0FBTztZQUFZO1lBQ3JELE9BQU87UUFDVDtRQUNBLE9BQU87SUFDVCxFQUFFLE9BQU9HLEdBQVk7UUFDbkJDLFFBQVFKLEtBQUssQ0FBQywyQkFBMkJHO1FBQ3pDUixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBT0MsT0FBTztRQUF3QjtRQUNqRSxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zcmMvbGliL3JiYWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2xpYi9yYmFjLnRzXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IHsgcHJpc21hIGFzIGRiIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuXG4vKipcbiAqIEVudGVycHJpc2UtR3JhZGUgUGVybWlzc2lvbiBDYXRhbG9nXG4gKiBHcmFudWxhciByZWFkL3dyaXRlIHBlcm1pc3Npb25zIGZvciBhbGwgYnVzaW5lc3MgbW9kdWxlc1xuICogS2VlcCBjb2RlcyBpbiBzeW5jIHdpdGggc2VlZC5cbiAqL1xuZXhwb3J0IGNvbnN0IFBFUk1TID0ge1xuICAvLyBEYXNoYm9hcmQgJiBBbmFseXRpY3NcbiAgREFTSEJPQVJEX1ZJRVc6IFwiZGFzaGJvYXJkOnZpZXdcIixcbiAgQU5BTFlUSUNTX1JFQUQ6IFwiYW5hbHl0aWNzOnJlYWRcIixcbiAgUkVQT1JUU19SRUFEOiBcInJlcG9ydHM6cmVhZFwiLFxuICBSRVBPUlRTX0NSRUFURTogXCJyZXBvcnRzOmNyZWF0ZVwiLFxuICBSRVBPUlRTX0VYUE9SVDogXCJyZXBvcnRzOmV4cG9ydFwiLFxuXG4gIC8vIExlYWQgTWFuYWdlbWVudFxuICBMRUFEX1JFQUQ6IFwibGVhZDpyZWFkXCIsXG4gIExFQURfQ1JFQVRFOiBcImxlYWQ6Y3JlYXRlXCIsXG4gIExFQURfVVBEQVRFOiBcImxlYWQ6dXBkYXRlXCIsXG4gIExFQURfREVMRVRFOiBcImxlYWQ6ZGVsZXRlXCIsXG4gIExFQURfRVhQT1JUOiBcImxlYWQ6ZXhwb3J0XCIsXG4gIExFQURfQVNTSUdOOiBcImxlYWQ6YXNzaWduXCIsXG4gIExFQURfQ09OVkVSVDogXCJsZWFkOmNvbnZlcnRcIixcblxuICAvLyBKb2IgTWFuYWdlbWVudFxuICBKT0JfUkVBRDogXCJqb2I6cmVhZFwiLFxuICBKT0JfQ1JFQVRFOiBcImpvYjpjcmVhdGVcIixcbiAgSk9CX1VQREFURTogXCJqb2I6dXBkYXRlXCIsXG4gIEpPQl9ERUxFVEU6IFwiam9iOmRlbGV0ZVwiLFxuICBKT0JfQVNTSUdOOiBcImpvYjphc3NpZ25cIixcbiAgSk9CX1NDSEVEVUxFOiBcImpvYjpzY2hlZHVsZVwiLFxuICBKT0JfQ09NUExFVEU6IFwiam9iOmNvbXBsZXRlXCIsXG5cbiAgLy8gV29ya2ZvcmNlIE1hbmFnZW1lbnRcbiAgRU1QTE9ZRUVfUkVBRDogXCJlbXBsb3llZTpyZWFkXCIsXG4gIEVNUExPWUVFX0NSRUFURTogXCJlbXBsb3llZTpjcmVhdGVcIixcbiAgRU1QTE9ZRUVfVVBEQVRFOiBcImVtcGxveWVlOnVwZGF0ZVwiLFxuICBFTVBMT1lFRV9ERUxFVEU6IFwiZW1wbG95ZWU6ZGVsZXRlXCIsXG4gIEVNUExPWUVFX1NDSEVEVUxFOiBcImVtcGxveWVlOnNjaGVkdWxlXCIsXG4gIFBBWVJPTExfUkVBRDogXCJwYXlyb2xsOnJlYWRcIixcbiAgUEFZUk9MTF9NQU5BR0U6IFwicGF5cm9sbDptYW5hZ2VcIixcbiAgVElNRUNMT0NLX1JFQUQ6IFwidGltZWNsb2NrOnJlYWRcIixcbiAgVElNRUNMT0NLX01BTkFHRTogXCJ0aW1lY2xvY2s6bWFuYWdlXCIsXG5cbiAgLy8gSFIgTWFuYWdlbWVudFxuICBIUl9SRUFEOiBcImhyOnJlYWRcIixcbiAgSFJfTUFOQUdFOiBcImhyOm1hbmFnZVwiLFxuICBIUl9ISVJFOiBcImhyOmhpcmVcIixcbiAgSFJfVEVSTUlOQVRFOiBcImhyOnRlcm1pbmF0ZVwiLFxuICBUUkFJTklOR19SRUFEOiBcInRyYWluaW5nOnJlYWRcIixcbiAgVFJBSU5JTkdfTUFOQUdFOiBcInRyYWluaW5nOm1hbmFnZVwiLFxuICBUUkFJTklOR19BU1NJR046IFwidHJhaW5pbmc6YXNzaWduXCIsXG5cbiAgLy8gQ2xpZW50ICYgQ3VzdG9tZXIgTWFuYWdlbWVudFxuICBDTElFTlRfUkVBRDogXCJjbGllbnQ6cmVhZFwiLFxuICBDTElFTlRfQ1JFQVRFOiBcImNsaWVudDpjcmVhdGVcIixcbiAgQ0xJRU5UX1VQREFURTogXCJjbGllbnQ6dXBkYXRlXCIsXG4gIENMSUVOVF9ERUxFVEU6IFwiY2xpZW50OmRlbGV0ZVwiLFxuICBDTElFTlRfQ09NTVVOSUNBVEU6IFwiY2xpZW50OmNvbW11bmljYXRlXCIsXG5cbiAgLy8gRmluYW5jaWFsIE1hbmFnZW1lbnRcbiAgQklMTElOR19SRUFEOiBcImJpbGxpbmc6cmVhZFwiLFxuICBCSUxMSU5HX01BTkFHRTogXCJiaWxsaW5nOm1hbmFnZVwiLFxuICBJTlZPSUNFX1JFQUQ6IFwiaW52b2ljZTpyZWFkXCIsXG4gIElOVk9JQ0VfQ1JFQVRFOiBcImludm9pY2U6Y3JlYXRlXCIsXG4gIElOVk9JQ0VfVVBEQVRFOiBcImludm9pY2U6dXBkYXRlXCIsXG4gIElOVk9JQ0VfREVMRVRFOiBcImludm9pY2U6ZGVsZXRlXCIsXG4gIFBBWU1FTlRfUkVBRDogXCJwYXltZW50OnJlYWRcIixcbiAgUEFZTUVOVF9QUk9DRVNTOiBcInBheW1lbnQ6cHJvY2Vzc1wiLFxuICBSRVZFTlVFX1JFQUQ6IFwicmV2ZW51ZTpyZWFkXCIsXG4gIFJFVkVOVUVfTUFOQUdFOiBcInJldmVudWU6bWFuYWdlXCIsXG5cbiAgLy8gT3BlcmF0aW9ucyAmIFNjaGVkdWxpbmdcbiAgU0NIRURVTEVfUkVBRDogXCJzY2hlZHVsZTpyZWFkXCIsXG4gIFNDSEVEVUxFX01BTkFHRTogXCJzY2hlZHVsZTptYW5hZ2VcIixcbiAgT1BFUkFUSU9OU19SRUFEOiBcIm9wZXJhdGlvbnM6cmVhZFwiLFxuICBPUEVSQVRJT05TX01BTkFHRTogXCJvcGVyYXRpb25zOm1hbmFnZVwiLFxuICBJTlZFTlRPUllfUkVBRDogXCJpbnZlbnRvcnk6cmVhZFwiLFxuICBJTlZFTlRPUllfTUFOQUdFOiBcImludmVudG9yeTptYW5hZ2VcIixcblxuICAvLyBTeXN0ZW0gQWRtaW5pc3RyYXRpb25cbiAgVVNFUl9SRUFEOiBcInVzZXI6cmVhZFwiLFxuICBVU0VSX0NSRUFURTogXCJ1c2VyOmNyZWF0ZVwiLFxuICBVU0VSX1VQREFURTogXCJ1c2VyOnVwZGF0ZVwiLFxuICBVU0VSX0RFTEVURTogXCJ1c2VyOmRlbGV0ZVwiLFxuICBVU0VSX0lNUEVSU09OQVRFOiBcInVzZXI6aW1wZXJzb25hdGVcIixcbiAgUEFTU1dPUkRfUkVTRVQ6IFwicGFzc3dvcmQ6cmVzZXRcIixcbiAgUk9MRVNfUkVBRDogXCJyb2xlczpyZWFkXCIsXG4gIFJPTEVTX01BTkFHRTogXCJyb2xlczptYW5hZ2VcIixcbiAgU1lTVEVNX1NFVFRJTkdTOiBcInN5c3RlbTpzZXR0aW5nc1wiLFxuICBTWVNURU1fQkFDS1VQOiBcInN5c3RlbTpiYWNrdXBcIixcbiAgQVVESVRfUkVBRDogXCJhdWRpdDpyZWFkXCIsXG5cbiAgLy8gUHJvdmlkZXIgUG9ydGFsIChXaGl0ZS1sYWJlbClcbiAgUFJPVklERVJfREFTSEJPQVJEOiBcInByb3ZpZGVyOmRhc2hib2FyZFwiLFxuICBQUk9WSURFUl9CSUxMSU5HOiBcInByb3ZpZGVyOmJpbGxpbmdcIixcbiAgUFJPVklERVJfQU5BTFlUSUNTOiBcInByb3ZpZGVyOmFuYWx5dGljc1wiLFxuICBQUk9WSURFUl9TRVRUSU5HUzogXCJwcm92aWRlcjpzZXR0aW5nc1wiLFxuICBQUk9WSURFUl9DTElFTlRTOiBcInByb3ZpZGVyOmNsaWVudHNcIixcblxuICAvLyBEb2N1bWVudCAmIEFzc2V0IE1hbmFnZW1lbnRcbiAgRE9DVU1FTlRfUkVBRDogXCJkb2N1bWVudDpyZWFkXCIsXG4gIERPQ1VNRU5UX0NSRUFURTogXCJkb2N1bWVudDpjcmVhdGVcIixcbiAgRE9DVU1FTlRfVVBEQVRFOiBcImRvY3VtZW50OnVwZGF0ZVwiLFxuICBET0NVTUVOVF9ERUxFVEU6IFwiZG9jdW1lbnQ6ZGVsZXRlXCIsXG4gIE1FRElBX1JFQUQ6IFwibWVkaWE6cmVhZFwiLFxuICBNRURJQV9VUExPQUQ6IFwibWVkaWE6dXBsb2FkXCIsXG4gIE1FRElBX0RFTEVURTogXCJtZWRpYTpkZWxldGVcIixcbn0gYXMgY29uc3Q7XG5leHBvcnQgdHlwZSBQZXJtQ29kZSA9ICh0eXBlb2YgUEVSTVMpW2tleW9mIHR5cGVvZiBQRVJNU107XG5cbi8qKlxuICogRW1haWwgdGhhdCBzaG91bGQgYnlwYXNzIFJCQUMgcGVybWlzc2lvbiBjaGVja3MgZW50aXJlbHkuXG4gKiBJZiBERVZfVVNFUl9FTUFJTCBpcyBzZXQgaW4gdGhlIGVudmlyb25tZW50LCBhbnkgcmVxdWVzdCBmcm9tIHRoYXRcbiAqIGVtYWlsIGFkZHJlc3Mgd2lsbCBiZSB0cmVhdGVkIGFzIGhhdmluZyBhbGwgcGVybWlzc2lvbnMuIFRoaXMgaXNcbiAqIHVzZWZ1bCBmb3IgZGV2ZWxvcG1lbnQgYW5kIGF1dG9tYXRlZCB0ZXN0aW5nLiBJbiBwcm9kdWN0aW9uIHlvdVxuICogc2hvdWxkIGxlYXZlIERFVl9VU0VSX0VNQUlMIHVuc2V0LlxuICovXG5jb25zdCBERVZfVVNFUl9FTUFJTCA9IHByb2Nlc3MuZW52LkRFVl9VU0VSX0VNQUlMPy50b0xvd2VyQ2FzZSgpIHx8IG51bGw7XG5cbi8qKlxuICogRXh0cmFjdCBjdXJyZW50IHVzZXIncyBlbWFpbCBmcm9tIGNvb2tpZSBvciBoZWFkZXIuXG4gKiAtIENvb2tpZTogbXZfdXNlcj08ZW1haWw+XG4gKiAtIEhlYWRlcjogeC1tdi11c2VyOiA8ZW1haWw+ICAodXNlZnVsIGZvciBzY3JpcHRzL3Rlc3RzKVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RW1haWxGcm9tUmVxKHJlcTogTmV4dEFwaVJlcXVlc3QpOiBzdHJpbmcgfCBudWxsIHtcbiAgY29uc3QgZnJvbUNvb2tpZSA9IHJlcS5jb29raWVzPy5tdl91c2VyO1xuICBjb25zdCBmcm9tSGVhZGVyID0gKHJlcS5oZWFkZXJzW1wieC1tdi11c2VyXCJdIHx8IHJlcS5oZWFkZXJzW1wieC1tdnVzZXJcIl0pIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgY29uc3QgcmF3ID0gKEFycmF5LmlzQXJyYXkoZnJvbUNvb2tpZSkgPyBmcm9tQ29va2llWzBdIDogZnJvbUNvb2tpZSkgPz8gZnJvbUhlYWRlciA/PyBcIlwiO1xuICBjb25zdCBlbWFpbCA9IHJhdz8udG9TdHJpbmcoKS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIGVtYWlsIHx8IG51bGw7XG59XG5cbi8qKiBMb29rIHVwIG9yZ0lkIGZvciBjdXJyZW50IHVzZXIgKHVzZWQgdG8gc2NvcGUgcXVlcmllcykuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3JnSWRGcm9tUmVxKHJlcTogTmV4dEFwaVJlcXVlc3QpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgY29uc3QgZW1haWwgPSBnZXRFbWFpbEZyb21SZXEocmVxKTtcbiAgaWYgKCFlbWFpbCkgcmV0dXJuIG51bGw7XG5cbiAgLy8gRGV2ZWxvcG1lbnQgYnlwYXNzOiBpZiB0aGlzIGlzIHRoZSBkZXYgdXNlciwgcmV0dXJuIGEgZml4ZWQgb3JnSWRcbiAgLy8gaWYgcHJvdmlkZWQgdmlhIERFVl9PUkdfSUQsIG90aGVyd2lzZSBmYWxsIHRocm91Z2ggdG8gREIgbG9va3VwLlxuICBpZiAoREVWX1VTRVJfRU1BSUwgJiYgZW1haWwgPT09IERFVl9VU0VSX0VNQUlMKSB7XG4gICAgLy8gVXNlIERFVl9PUkdfSUQgaWYgcHJvdmlkZWQsIGVsc2UgbnVsbCB0byBpbmRpY2F0ZSBubyBvcmdcbiAgICBjb25zdCBkZXZPcmcgPSBwcm9jZXNzLmVudi5ERVZfT1JHX0lEO1xuICAgIGlmIChkZXZPcmcpIHJldHVybiBkZXZPcmc7XG4gICAgLy8gQXMgYSBmYWxsYmFjaywgYXR0ZW1wdCB0byBmZXRjaCB0aGUgZmlyc3Qgb3JnIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpcnN0T3JnID0gYXdhaXQgZGIub3JnLmZpbmRGaXJzdCh7IHNlbGVjdDogeyBpZDogdHJ1ZSB9IH0pO1xuICAgICAgcmV0dXJuIGZpcnN0T3JnPy5pZCA/PyBudWxsO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG4gIGNvbnN0IHUgPSBhd2FpdCBkYi51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbCB9LCBzZWxlY3Q6IHsgb3JnSWQ6IHRydWUgfSB9KTtcbiAgcmV0dXJuIHU/Lm9yZ0lkID8/IG51bGw7XG59XG5cbi8qKlxuICogRmV0Y2ggdXNlcidzIGVmZmVjdGl2ZSBwZXJtaXNzaW9ucyBmcm9tIFJCQUMgdGFibGVzLlxuICogRmFsbHMgYmFjayB0byBsZWdhY3kgVXNlci5yb2xlIGZvciBPV05FUi9NQU5BR0VSL1NUQUZGIGNvbnZlbmllbmNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRVc2VyUGVybUNvZGVzKHVzZXJJZDogc3RyaW5nLCBsZWdhY3lSb2xlPzogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8U2V0PHN0cmluZz4+IHtcbiAgY29uc3Qgcm9sZUxpbmtzID0gYXdhaXQgZGIucmJhY1VzZXJSb2xlLmZpbmRNYW55KHtcbiAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICBzZWxlY3Q6IHsgcm9sZUlkOiB0cnVlIH0sXG4gIH0pO1xuXG4gIGNvbnN0IHJvbGVJZHMgPSByb2xlTGlua3MubWFwKChyKSA9PiByLnJvbGVJZCk7XG4gIGNvbnN0IHBlcm1zID0gcm9sZUlkcy5sZW5ndGhcbiAgICA/IGF3YWl0IGRiLnJiYWNSb2xlUGVybWlzc2lvbi5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHJvbGVJZDogeyBpbjogcm9sZUlkcyB9IH0sXG4gICAgICAgIGluY2x1ZGU6IHsgcGVybWlzc2lvbjogdHJ1ZSB9LFxuICAgICAgfSlcbiAgICA6IFtdO1xuXG4gIGNvbnN0IGNvZGVzID0gbmV3IFNldDxzdHJpbmc+KHBlcm1zLm1hcCgocnApID0+IHJwLnBlcm1pc3Npb24uY29kZSkpO1xuXG4gIC8vIExlZ2FjeSByb2xlIGNvbnZlbmllbmNlIChub24tYmxvY2tpbmcpOiBnaXZlIHNlbnNpYmxlIGRlZmF1bHRzIGJhc2VkIG9uIGVudGVycHJpc2Ugcm9sZSBoaWVyYXJjaHlcbiAgc3dpdGNoICgobGVnYWN5Um9sZSB8fCBcIlwiKS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgY2FzZSBcIk9XTkVSXCI6XG4gICAgICAvLyBPd25lcnMgZ2V0IGZ1bGwgc3lzdGVtIGFjY2VzcyAtIGFsbCBwZXJtaXNzaW9uc1xuICAgICAgT2JqZWN0LnZhbHVlcyhQRVJNUykuZm9yRWFjaChjID0+IGNvZGVzLmFkZChjKSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiTUFOQUdFUlwiOlxuICAgICAgLy8gTWFuYWdlcnMgZ2V0IG9wZXJhdGlvbmFsIGNvbnRyb2wgYnV0IGxpbWl0ZWQgc3lzdGVtIGFkbWluaXN0cmF0aW9uXG4gICAgICBbXG4gICAgICAgIFBFUk1TLkRBU0hCT0FSRF9WSUVXLCBQRVJNUy5BTkFMWVRJQ1NfUkVBRCwgUEVSTVMuUkVQT1JUU19SRUFELCBQRVJNUy5SRVBPUlRTX0NSRUFURSwgUEVSTVMuUkVQT1JUU19FWFBPUlQsXG4gICAgICAgIFBFUk1TLkxFQURfUkVBRCwgUEVSTVMuTEVBRF9DUkVBVEUsIFBFUk1TLkxFQURfVVBEQVRFLCBQRVJNUy5MRUFEX0RFTEVURSwgUEVSTVMuTEVBRF9FWFBPUlQsIFBFUk1TLkxFQURfQVNTSUdOLCBQRVJNUy5MRUFEX0NPTlZFUlQsXG4gICAgICAgIFBFUk1TLkpPQl9SRUFELCBQRVJNUy5KT0JfQ1JFQVRFLCBQRVJNUy5KT0JfVVBEQVRFLCBQRVJNUy5KT0JfREVMRVRFLCBQRVJNUy5KT0JfQVNTSUdOLCBQRVJNUy5KT0JfU0NIRURVTEUsIFBFUk1TLkpPQl9DT01QTEVURSxcbiAgICAgICAgUEVSTVMuRU1QTE9ZRUVfUkVBRCwgUEVSTVMuRU1QTE9ZRUVfVVBEQVRFLCBQRVJNUy5FTVBMT1lFRV9TQ0hFRFVMRSwgUEVSTVMuUEFZUk9MTF9SRUFELCBQRVJNUy5USU1FQ0xPQ0tfUkVBRCwgUEVSTVMuVElNRUNMT0NLX01BTkFHRSxcbiAgICAgICAgUEVSTVMuVFJBSU5JTkdfUkVBRCwgUEVSTVMuVFJBSU5JTkdfQVNTSUdOLCBQRVJNUy5DTElFTlRfUkVBRCwgUEVSTVMuQ0xJRU5UX0NSRUFURSwgUEVSTVMuQ0xJRU5UX1VQREFURSwgUEVSTVMuQ0xJRU5UX0NPTU1VTklDQVRFLFxuICAgICAgICBQRVJNUy5CSUxMSU5HX1JFQUQsIFBFUk1TLklOVk9JQ0VfUkVBRCwgUEVSTVMuSU5WT0lDRV9DUkVBVEUsIFBFUk1TLklOVk9JQ0VfVVBEQVRFLCBQRVJNUy5QQVlNRU5UX1JFQUQsIFBFUk1TLlJFVkVOVUVfUkVBRCxcbiAgICAgICAgUEVSTVMuU0NIRURVTEVfUkVBRCwgUEVSTVMuU0NIRURVTEVfTUFOQUdFLCBQRVJNUy5PUEVSQVRJT05TX1JFQUQsIFBFUk1TLk9QRVJBVElPTlNfTUFOQUdFLCBQRVJNUy5JTlZFTlRPUllfUkVBRCwgUEVSTVMuSU5WRU5UT1JZX01BTkFHRSxcbiAgICAgICAgUEVSTVMuRE9DVU1FTlRfUkVBRCwgUEVSTVMuRE9DVU1FTlRfQ1JFQVRFLCBQRVJNUy5ET0NVTUVOVF9VUERBVEUsIFBFUk1TLk1FRElBX1JFQUQsIFBFUk1TLk1FRElBX1VQTE9BRFxuICAgICAgXS5mb3JFYWNoKGMgPT4gY29kZXMuYWRkKGMpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJTVEFGRlwiOlxuICAgICAgLy8gU3RhZmYgZ2V0IGJhc2ljIG9wZXJhdGlvbmFsIGFjY2VzcyAtIG1vc3RseSByZWFkIHdpdGggbGltaXRlZCB3cml0ZVxuICAgICAgW1xuICAgICAgICBQRVJNUy5EQVNIQk9BUkRfVklFVywgUEVSTVMuTEVBRF9SRUFELCBQRVJNUy5MRUFEX0NSRUFURSwgUEVSTVMuTEVBRF9VUERBVEUsXG4gICAgICAgIFBFUk1TLkpPQl9SRUFELCBQRVJNUy5KT0JfVVBEQVRFLCBQRVJNUy5USU1FQ0xPQ0tfUkVBRCwgUEVSTVMuVFJBSU5JTkdfUkVBRCxcbiAgICAgICAgUEVSTVMuQ0xJRU5UX1JFQUQsIFBFUk1TLlNDSEVEVUxFX1JFQUQsIFBFUk1TLk9QRVJBVElPTlNfUkVBRCwgUEVSTVMuSU5WRU5UT1JZX1JFQUQsXG4gICAgICAgIFBFUk1TLkRPQ1VNRU5UX1JFQUQsIFBFUk1TLk1FRElBX1JFQURcbiAgICAgIF0uZm9yRWFjaChjID0+IGNvZGVzLmFkZChjKSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiQUNDT1VOVEFOVFwiOlxuICAgICAgLy8gQWNjb3VudGFudHMgZ2V0IGZpbmFuY2lhbCBhbmQgSFIgbWFuYWdlbWVudCBhY2Nlc3NcbiAgICAgIFtcbiAgICAgICAgUEVSTVMuREFTSEJPQVJEX1ZJRVcsIFBFUk1TLkFOQUxZVElDU19SRUFELCBQRVJNUy5SRVBPUlRTX1JFQUQsIFBFUk1TLlJFUE9SVFNfQ1JFQVRFLCBQRVJNUy5SRVBPUlRTX0VYUE9SVCxcbiAgICAgICAgUEVSTVMuRU1QTE9ZRUVfUkVBRCwgUEVSTVMuUEFZUk9MTF9SRUFELCBQRVJNUy5QQVlST0xMX01BTkFHRSwgUEVSTVMuVElNRUNMT0NLX1JFQUQsIFBFUk1TLkhSX1JFQUQsXG4gICAgICAgIFBFUk1TLkJJTExJTkdfUkVBRCwgUEVSTVMuQklMTElOR19NQU5BR0UsIFBFUk1TLklOVk9JQ0VfUkVBRCwgUEVSTVMuSU5WT0lDRV9DUkVBVEUsIFBFUk1TLklOVk9JQ0VfVVBEQVRFLCBQRVJNUy5JTlZPSUNFX0RFTEVURSxcbiAgICAgICAgUEVSTVMuUEFZTUVOVF9SRUFELCBQRVJNUy5QQVlNRU5UX1BST0NFU1MsIFBFUk1TLlJFVkVOVUVfUkVBRCwgUEVSTVMuUkVWRU5VRV9NQU5BR0UsXG4gICAgICAgIFBFUk1TLkRPQ1VNRU5UX1JFQUQsIFBFUk1TLkRPQ1VNRU5UX0NSRUFURSwgUEVSTVMuQVVESVRfUkVBRFxuICAgICAgXS5mb3JFYWNoKGMgPT4gY29kZXMuYWRkKGMpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJQUk9WSURFUlwiOlxuICAgICAgLy8gUHJvdmlkZXIgZ2V0cyBwcm92aWRlciBwb3J0YWwgYWNjZXNzIGFuZCBjbGllbnQgbWFuYWdlbWVudFxuICAgICAgW1xuICAgICAgICBQRVJNUy5QUk9WSURFUl9EQVNIQk9BUkQsIFBFUk1TLlBST1ZJREVSX0JJTExJTkcsIFBFUk1TLlBST1ZJREVSX0FOQUxZVElDUywgUEVSTVMuUFJPVklERVJfU0VUVElOR1MsIFBFUk1TLlBST1ZJREVSX0NMSUVOVFMsXG4gICAgICAgIFBFUk1TLkFOQUxZVElDU19SRUFELCBQRVJNUy5SRVBPUlRTX1JFQUQsIFBFUk1TLkJJTExJTkdfUkVBRCwgUEVSTVMuUkVWRU5VRV9SRUFEXG4gICAgICBdLmZvckVhY2goYyA9PiBjb2Rlcy5hZGQoYykpO1xuICAgICAgYnJlYWs7XG4gIH1cblxuICByZXR1cm4gY29kZXM7XG59XG5cbi8qKlxuICogQXNzZXJ0IHRoYXQgY3VycmVudCByZXF1ZXN0IGlzIGZyb20gYW4gYXV0aGVudGljYXRlZCB1c2VyIHdpdGggYSBnaXZlbiBwZXJtaXNzaW9uLlxuICogV3JpdGVzIDQwMS80MDMgdG8gcmVzIGlmIG5vdCBhbGxvd2VkLiBSZXR1cm5zIHRydWUgaWYgYWxsb3dlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXNzZXJ0UGVybWlzc2lvbihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2UsXG4gIHJlcXVpcmVkOiBQZXJtQ29kZVxuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZW1haWwgPSBnZXRFbWFpbEZyb21SZXEocmVxKTtcbiAgICBpZiAoIWVtYWlsKSB7XG4gICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gRGV2ZWxvcG1lbnQgYnlwYXNzOiBpZiB0aGUgaW5jb21pbmcgZW1haWwgbWF0Y2hlcyB0aGUgREVWX1VTRVJfRU1BSUxcbiAgICAvLyB0aGVuIHNraXAgYW55IGRhdGFiYXNlIGxvb2t1cHMgYW5kIGFsbG93IHRoZSByZXF1ZXN0LiBUaGlzIHBlcm1pdHNcbiAgICAvLyBhdXRvbWF0ZWQgdGVzdHMgYW5kIGRldmVsb3BtZW50IHNlc3Npb25zIHRvIGV4ZXJjaXNlIGFueSBBUElcbiAgICAvLyByZWdhcmRsZXNzIG9mIHRoZSB1c2VyJ3MgcGVyc2lzdGVkIHJvbGUgb3IgcGVybWlzc2lvbnMuIElmIG5vXG4gICAgLy8gREVWX1VTRVJfRU1BSUwgaXMgY29uZmlndXJlZCwgdGhpcyBibG9jayBoYXMgbm8gZWZmZWN0LlxuICAgIGlmIChERVZfVVNFUl9FTUFJTCAmJiBlbWFpbCA9PT0gREVWX1VTRVJfRU1BSUwpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBkYi51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsgZW1haWwgfSxcbiAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgcm9sZTogdHJ1ZSB9LFxuICAgIH0pO1xuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgY29kZXMgPSBhd2FpdCBnZXRVc2VyUGVybUNvZGVzKHVzZXIuaWQsIHVzZXIucm9sZSk7XG4gICAgaWYgKCFjb2Rlcy5oYXMocmVxdWlyZWQpKSB7XG4gICAgICByZXMuc3RhdHVzKDQwMykuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IFwiRm9yYmlkZGVuXCIgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlOiB1bmtub3duKSB7XG4gICAgY29uc29sZS5lcnJvcihcImFzc2VydFBlcm1pc3Npb24gZXJyb3I6XCIsIGUpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3JcIiB9KTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJkYiIsIlBFUk1TIiwiREFTSEJPQVJEX1ZJRVciLCJBTkFMWVRJQ1NfUkVBRCIsIlJFUE9SVFNfUkVBRCIsIlJFUE9SVFNfQ1JFQVRFIiwiUkVQT1JUU19FWFBPUlQiLCJMRUFEX1JFQUQiLCJMRUFEX0NSRUFURSIsIkxFQURfVVBEQVRFIiwiTEVBRF9ERUxFVEUiLCJMRUFEX0VYUE9SVCIsIkxFQURfQVNTSUdOIiwiTEVBRF9DT05WRVJUIiwiSk9CX1JFQUQiLCJKT0JfQ1JFQVRFIiwiSk9CX1VQREFURSIsIkpPQl9ERUxFVEUiLCJKT0JfQVNTSUdOIiwiSk9CX1NDSEVEVUxFIiwiSk9CX0NPTVBMRVRFIiwiRU1QTE9ZRUVfUkVBRCIsIkVNUExPWUVFX0NSRUFURSIsIkVNUExPWUVFX1VQREFURSIsIkVNUExPWUVFX0RFTEVURSIsIkVNUExPWUVFX1NDSEVEVUxFIiwiUEFZUk9MTF9SRUFEIiwiUEFZUk9MTF9NQU5BR0UiLCJUSU1FQ0xPQ0tfUkVBRCIsIlRJTUVDTE9DS19NQU5BR0UiLCJIUl9SRUFEIiwiSFJfTUFOQUdFIiwiSFJfSElSRSIsIkhSX1RFUk1JTkFURSIsIlRSQUlOSU5HX1JFQUQiLCJUUkFJTklOR19NQU5BR0UiLCJUUkFJTklOR19BU1NJR04iLCJDTElFTlRfUkVBRCIsIkNMSUVOVF9DUkVBVEUiLCJDTElFTlRfVVBEQVRFIiwiQ0xJRU5UX0RFTEVURSIsIkNMSUVOVF9DT01NVU5JQ0FURSIsIkJJTExJTkdfUkVBRCIsIkJJTExJTkdfTUFOQUdFIiwiSU5WT0lDRV9SRUFEIiwiSU5WT0lDRV9DUkVBVEUiLCJJTlZPSUNFX1VQREFURSIsIklOVk9JQ0VfREVMRVRFIiwiUEFZTUVOVF9SRUFEIiwiUEFZTUVOVF9QUk9DRVNTIiwiUkVWRU5VRV9SRUFEIiwiUkVWRU5VRV9NQU5BR0UiLCJTQ0hFRFVMRV9SRUFEIiwiU0NIRURVTEVfTUFOQUdFIiwiT1BFUkFUSU9OU19SRUFEIiwiT1BFUkFUSU9OU19NQU5BR0UiLCJJTlZFTlRPUllfUkVBRCIsIklOVkVOVE9SWV9NQU5BR0UiLCJVU0VSX1JFQUQiLCJVU0VSX0NSRUFURSIsIlVTRVJfVVBEQVRFIiwiVVNFUl9ERUxFVEUiLCJVU0VSX0lNUEVSU09OQVRFIiwiUEFTU1dPUkRfUkVTRVQiLCJST0xFU19SRUFEIiwiUk9MRVNfTUFOQUdFIiwiU1lTVEVNX1NFVFRJTkdTIiwiU1lTVEVNX0JBQ0tVUCIsIkFVRElUX1JFQUQiLCJQUk9WSURFUl9EQVNIQk9BUkQiLCJQUk9WSURFUl9CSUxMSU5HIiwiUFJPVklERVJfQU5BTFlUSUNTIiwiUFJPVklERVJfU0VUVElOR1MiLCJQUk9WSURFUl9DTElFTlRTIiwiRE9DVU1FTlRfUkVBRCIsIkRPQ1VNRU5UX0NSRUFURSIsIkRPQ1VNRU5UX1VQREFURSIsIkRPQ1VNRU5UX0RFTEVURSIsIk1FRElBX1JFQUQiLCJNRURJQV9VUExPQUQiLCJNRURJQV9ERUxFVEUiLCJERVZfVVNFUl9FTUFJTCIsInByb2Nlc3MiLCJlbnYiLCJ0b0xvd2VyQ2FzZSIsImdldEVtYWlsRnJvbVJlcSIsInJlcSIsImZyb21Db29raWUiLCJjb29raWVzIiwibXZfdXNlciIsImZyb21IZWFkZXIiLCJoZWFkZXJzIiwicmF3IiwiQXJyYXkiLCJpc0FycmF5IiwiZW1haWwiLCJ0b1N0cmluZyIsInRyaW0iLCJnZXRPcmdJZEZyb21SZXEiLCJkZXZPcmciLCJERVZfT1JHX0lEIiwiZmlyc3RPcmciLCJvcmciLCJmaW5kRmlyc3QiLCJzZWxlY3QiLCJpZCIsInUiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwib3JnSWQiLCJnZXRVc2VyUGVybUNvZGVzIiwidXNlcklkIiwibGVnYWN5Um9sZSIsInJvbGVMaW5rcyIsInJiYWNVc2VyUm9sZSIsImZpbmRNYW55Iiwicm9sZUlkIiwicm9sZUlkcyIsIm1hcCIsInIiLCJwZXJtcyIsImxlbmd0aCIsInJiYWNSb2xlUGVybWlzc2lvbiIsImluIiwiaW5jbHVkZSIsInBlcm1pc3Npb24iLCJjb2RlcyIsIlNldCIsInJwIiwiY29kZSIsInRvVXBwZXJDYXNlIiwiT2JqZWN0IiwidmFsdWVzIiwiZm9yRWFjaCIsImMiLCJhZGQiLCJhc3NlcnRQZXJtaXNzaW9uIiwicmVzIiwicmVxdWlyZWQiLCJzdGF0dXMiLCJqc29uIiwib2siLCJlcnJvciIsInJvbGUiLCJoYXMiLCJlIiwiY29uc29sZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/rbac.ts\n");

/***/ }),

/***/ "(api-node)/./src/lib/reportingWindow.ts":
/*!************************************!*\
  !*** ./src/lib/reportingWindow.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_TZ: () => (/* binding */ DEFAULT_TZ),\n/* harmony export */   arrayFirst: () => (/* binding */ arrayFirst),\n/* harmony export */   computeWindow: () => (/* binding */ computeWindow),\n/* harmony export */   currentMonthRange: () => (/* binding */ currentMonthRange),\n/* harmony export */   currentMonthRangeISO: () => (/* binding */ currentMonthRangeISO),\n/* harmony export */   endOfDayUTC: () => (/* binding */ endOfDayUTC),\n/* harmony export */   parseDateOnly: () => (/* binding */ parseDateOnly),\n/* harmony export */   parseLimit: () => (/* binding */ parseLimit),\n/* harmony export */   readStringFilter: () => (/* binding */ readStringFilter)\n/* harmony export */ });\n// src/lib/reportingWindow.ts\n/** Default business timezone for “This Month” calculations. */ const DEFAULT_TZ = process.env.DEFAULT_TZ || \"America/Denver\";\n/* ----------------------------------------------------------------------------\n * Basic date helpers (existing behavior preserved)\n * ------------------------------------------------------------------------- */ function parseDateOnly(s) {\n    if (!s) return null;\n    const m = /^(\\d{4})-(\\d{2})-(\\d{2})$/.exec(s);\n    if (!m) return null;\n    const d = new Date(Date.UTC(+m[1], +m[2] - 1, +m[3]));\n    return isNaN(d.getTime()) ? null : d;\n}\n/** Inclusive day window: `from` at 00:00 UTC, `to` at the given day 00:00 UTC. */ function computeWindow(q) {\n    const now = new Date();\n    const endQ = arrayFirst(q.end);\n    const startQ = arrayFirst(q.start);\n    const rangeQ = arrayFirst(q.range);\n    // Normalize to a clean UTC day boundary for TODAY\n    const todayUTC = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()));\n    const end = parseDateOnly(endQ) ?? todayUTC;\n    const start = parseDateOnly(startQ);\n    if (start && end) {\n        const from = start <= end ? start : end;\n        const to = end >= start ? end : start;\n        return {\n            from,\n            to,\n            label: \"custom\"\n        };\n    }\n    const map = {\n        d7: 7,\n        d30: 30,\n        d90: 90,\n        all: 365\n    };\n    const days = map[rangeQ || \"d30\"] ?? 30;\n    const from = new Date(end);\n    from.setUTCDate(from.getUTCDate() - days + 1);\n    return {\n        from,\n        to: end,\n        label: rangeQ || \"d30\"\n    };\n}\n/** 23:59:59.999 UTC of the given date */ function endOfDayUTC(d) {\n    return new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate(), 23, 59, 59, 999));\n}\n/** Helper to safely read the first value of a query param (array or string). */ function arrayFirst(v) {\n    return Array.isArray(v) ? v[0] : v;\n}\n/** Parse optional `limit` with sane defaults and a hard cap. */ function parseLimit(q, def = 10000, cap = 100000) {\n    const raw = arrayFirst(q.limit);\n    const n = Math.max(parseInt(raw || String(def), 10) || def, 1);\n    return Math.min(n, cap);\n}\n/** Read optional string filters (e.g., status, sourceType). */ function readStringFilter(q, key) {\n    const raw = q[key];\n    const v = Array.isArray(raw) ? raw[0] : raw;\n    if (v && typeof v === \"string\") {\n        const trimmed = v.trim();\n        return trimmed ? trimmed : undefined;\n    }\n    return undefined;\n}\n/* ----------------------------------------------------------------------------\n * Step 7.1 AUGMENT — Timezone-aware “current month” window (no extra deps)\n *\n * Purpose:\n *   Provide an accurate “This Month” range for dashboards & billing rollups\n *   in a business timezone (default America/Denver), handling DST correctly.\n *\n * What you get:\n *   currentMonthRange(tz) → { from, to }\n *     - `from` = 00:00:00.000 at local time on the 1st of this month, as a UTC Date\n *     - `to`   = 23:59:59.999 at local time on the last day of this month, as a UTC Date\n *\n * Implementation notes:\n *   - Uses Intl APIs to derive local Y/M/D and numeric UTC offset for a given tz.\n *   - Avoids adding date-fns/date-fns-tz dependencies.\n * ------------------------------------------------------------------------- */ /** Extracts Y/M/D for a given Date as seen in a target IANA timezone. */ function getYMDInTZ(d, timeZone) {\n    const f = new Intl.DateTimeFormat(\"en-CA\", {\n        timeZone,\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\"\n    });\n    const parts = f.formatToParts(d);\n    const y = Number(parts.find((p)=>p.type === \"year\")?.value);\n    const m = Number(parts.find((p)=>p.type === \"month\")?.value);\n    const day = Number(parts.find((p)=>p.type === \"day\")?.value);\n    return {\n        y,\n        m,\n        day\n    };\n}\n/** Parses a TZ offset like \"GMT-06:00\" → minutes (-360). */ function parseGmtOffsetToMinutes(label) {\n    // Expect strings like \"GMT-06:00\" / \"GMT+05:30\"\n    const m = /GMT([+-])(\\d{2}):(\\d{2})/.exec(label);\n    if (!m) return null;\n    const sign = m[1] === \"-\" ? -1 : 1;\n    const hh = Number(m[2]);\n    const mm = Number(m[3]);\n    return sign * (hh * 60 + mm);\n}\n/** Gets the numeric offset, in minutes, of `timeZone` at instant `d`. */ function tzOffsetMinutesAt(d, timeZone) {\n    // Use timeZoneName: 'shortOffset' to get labels like \"GMT-06:00\"\n    const fmt = new Intl.DateTimeFormat(\"en-US\", {\n        timeZone,\n        timeZoneName: \"shortOffset\",\n        hour12: false,\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\",\n        hour: \"2-digit\",\n        minute: \"2-digit\"\n    });\n    const parts = fmt.formatToParts(d);\n    const label = parts.find((p)=>p.type === \"timeZoneName\")?.value || \"\";\n    const mins = parseGmtOffsetToMinutes(label);\n    // Fallback: compute offset via wall-clock comparison if parsing fails\n    if (mins == null) {\n        const asLocal = new Date(fmt.format(d).replace(/(\\d{2})\\/(\\d{2})\\/(\\d{4}), (\\d{2}):(\\d{2}).*/, \"$3-$1-$2T$4:$5:00Z\"));\n        const diff = (asLocal.getTime() - d.getTime()) / 60000;\n        return Math.round(diff);\n    }\n    return mins;\n}\n/**\n * Returns the UTC instant corresponding to LOCAL midnight (00:00:00.000) for\n * the given Y/M/D in `timeZone`.\n */ function localMidnightUTC(y, m1, d, timeZone) {\n    // Create an approximate UTC instant for that date\n    const approxUTC = new Date(Date.UTC(y, m1 - 1, d, 0, 0, 0, 0));\n    // Get the correct offset at that local date\n    const offsetMin = tzOffsetMinutesAt(approxUTC, timeZone);\n    // Local midnight = UTC - offset\n    return new Date(approxUTC.getTime() - offsetMin * 60000);\n}\n/**\n * Returns the UTC instant corresponding to LOCAL 23:59:59.999 for the given\n * Y/M/D in `timeZone`.\n */ function localEndOfDayUTC(y, m1, d, timeZone) {\n    const approxUTC = new Date(Date.UTC(y, m1 - 1, d, 23, 59, 59, 999));\n    const offsetMin = tzOffsetMinutesAt(approxUTC, timeZone);\n    return new Date(approxUTC.getTime() - offsetMin * 60000);\n}\n/**\n * Step 7.1: “This Month” range in a target business timezone (default: America/Denver).\n * - from: first day of this month at 00:00 local (as a UTC Date)\n * - to:   last day of this month at 23:59:59.999 local (as a UTC Date)\n */ function currentMonthRange(tz = DEFAULT_TZ) {\n    const now = new Date();\n    const { y, m } = getYMDInTZ(now, tz); // month is 1–12\n    const firstLocalUTC = localMidnightUTC(y, m, 1, tz);\n    // Find number of days in this month (in target TZ) by moving to next month day 0.\n    const nextMonth = m === 12 ? 1 : m + 1;\n    const nextMonthYear = m === 12 ? y + 1 : y;\n    // Last day number = day component of \"the day before the 1st of next month\"\n    const lastOfMonthDate = new Date(Date.UTC(nextMonthYear, nextMonth - 1, 1));\n    lastOfMonthDate.setUTCDate(0); // move to last day of current month\n    const lastDayNum = lastOfMonthDate.getUTCDate();\n    const lastLocalUTC = localEndOfDayUTC(y, m, lastDayNum, tz);\n    return {\n        from: firstLocalUTC,\n        to: lastLocalUTC\n    };\n}\n/**\n * Convenience: Returns ISO strings for UI/debug.\n */ function currentMonthRangeISO(tz = DEFAULT_TZ) {\n    const { from, to } = currentMonthRange(tz);\n    return {\n        from: from.toISOString(),\n        to: to.toISOString()\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvcmVwb3J0aW5nV2luZG93LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLDZCQUE2QjtBQVU3Qiw2REFBNkQsR0FDdEQsTUFBTUEsYUFBYUMsUUFBUUMsR0FBRyxDQUFDRixVQUFVLElBQUksaUJBQWlCO0FBRXJFOzs2RUFFNkUsR0FFdEUsU0FBU0csY0FBY0MsQ0FBVTtJQUN0QyxJQUFJLENBQUNBLEdBQUcsT0FBTztJQUNmLE1BQU1DLElBQUksNEJBQTRCQyxJQUFJLENBQUNGO0lBQzNDLElBQUksQ0FBQ0MsR0FBRyxPQUFPO0lBQ2YsTUFBTUUsSUFBSSxJQUFJQyxLQUFLQSxLQUFLQyxHQUFHLENBQUMsQ0FBQ0osQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDQSxDQUFDLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQ0EsQ0FBQyxDQUFDLEVBQUU7SUFDbkQsT0FBT0ssTUFBTUgsRUFBRUksT0FBTyxNQUFNLE9BQU9KO0FBQ3JDO0FBRUEsZ0ZBQWdGLEdBQ3pFLFNBQVNLLGNBQWNDLENBQTBCO0lBS3RELE1BQU1DLE1BQU0sSUFBSU47SUFDaEIsTUFBTU8sT0FBT0MsV0FBV0gsRUFBRUksR0FBRztJQUM3QixNQUFNQyxTQUFTRixXQUFXSCxFQUFFTSxLQUFLO0lBQ2pDLE1BQU1DLFNBQVNKLFdBQVdILEVBQUVRLEtBQUs7SUFFakMsa0RBQWtEO0lBQ2xELE1BQU1DLFdBQVcsSUFBSWQsS0FDbkJBLEtBQUtDLEdBQUcsQ0FBQ0ssSUFBSVMsY0FBYyxJQUFJVCxJQUFJVSxXQUFXLElBQUlWLElBQUlXLFVBQVU7SUFFbEUsTUFBTVIsTUFBTWQsY0FBY1ksU0FBU087SUFDbkMsTUFBTUgsUUFBUWhCLGNBQWNlO0lBRTVCLElBQUlDLFNBQVNGLEtBQUs7UUFDaEIsTUFBTVMsT0FBT1AsU0FBU0YsTUFBTUUsUUFBUUY7UUFDcEMsTUFBTVUsS0FBS1YsT0FBT0UsUUFBUUYsTUFBTUU7UUFDaEMsT0FBTztZQUFFTztZQUFNQztZQUFJQyxPQUFPO1FBQVM7SUFDckM7SUFFQSxNQUFNQyxNQUFrQztRQUFFQyxJQUFJO1FBQUdDLEtBQUs7UUFBSUMsS0FBSztRQUFJQyxLQUFLO0lBQUk7SUFDNUUsTUFBTUMsT0FBT0wsR0FBRyxDQUFDVCxVQUFVLE1BQU0sSUFBSTtJQUNyQyxNQUFNTSxPQUFPLElBQUlsQixLQUFLUztJQUN0QlMsS0FBS1MsVUFBVSxDQUFDVCxLQUFLRCxVQUFVLEtBQUtTLE9BQU87SUFDM0MsT0FBTztRQUFFUjtRQUFNQyxJQUFJVjtRQUFLVyxPQUFRUixVQUFVO0lBQXFCO0FBQ2pFO0FBRUEsdUNBQXVDLEdBQ2hDLFNBQVNnQixZQUFZN0IsQ0FBTztJQUNqQyxPQUFPLElBQUlDLEtBQ1RBLEtBQUtDLEdBQUcsQ0FDTkYsRUFBRWdCLGNBQWMsSUFDaEJoQixFQUFFaUIsV0FBVyxJQUNiakIsRUFBRWtCLFVBQVUsSUFDWixJQUNBLElBQ0EsSUFDQTtBQUdOO0FBRUEsOEVBQThFLEdBQ3ZFLFNBQVNULFdBQVdxQixDQUFnQztJQUN6RCxPQUFPQyxNQUFNQyxPQUFPLENBQUNGLEtBQUtBLENBQUMsQ0FBQyxFQUFFLEdBQUdBO0FBQ25DO0FBRUEsOERBQThELEdBQ3ZELFNBQVNHLFdBQ2QzQixDQUEwQixFQUMxQjRCLE1BQU0sS0FBSyxFQUNYQyxNQUFNLE1BQU07SUFFWixNQUFNQyxNQUFNM0IsV0FBV0gsRUFBRStCLEtBQUs7SUFDOUIsTUFBTUMsSUFBSUMsS0FBS0MsR0FBRyxDQUFDQyxTQUFTTCxPQUFPTSxPQUFPUixNQUFNLE9BQU9BLEtBQUs7SUFDNUQsT0FBT0ssS0FBS0ksR0FBRyxDQUFDTCxHQUFHSDtBQUNyQjtBQUVBLDZEQUE2RCxHQUN0RCxTQUFTUyxpQkFDZHRDLENBQTBCLEVBQzFCdUMsR0FBVztJQUVYLE1BQU1ULE1BQU05QixDQUFDLENBQUN1QyxJQUFJO0lBQ2xCLE1BQU1mLElBQUlDLE1BQU1DLE9BQU8sQ0FBQ0ksT0FBT0EsR0FBRyxDQUFDLEVBQUUsR0FBR0E7SUFDeEMsSUFBSU4sS0FBSyxPQUFPQSxNQUFNLFVBQVU7UUFDOUIsTUFBTWdCLFVBQVVoQixFQUFFaUIsSUFBSTtRQUN0QixPQUFPRCxVQUFVQSxVQUFVRTtJQUM3QjtJQUNBLE9BQU9BO0FBQ1Q7QUFFQTs7Ozs7Ozs7Ozs7Ozs7OzZFQWU2RSxHQUU3RSx1RUFBdUUsR0FDdkUsU0FBU0MsV0FBV2pELENBQU8sRUFBRWtELFFBQWdCO0lBQzNDLE1BQU1DLElBQUksSUFBSUMsS0FBS0MsY0FBYyxDQUFDLFNBQVM7UUFDekNIO1FBQ0FJLE1BQU07UUFDTkMsT0FBTztRQUNQQyxLQUFLO0lBQ1A7SUFDQSxNQUFNQyxRQUFRTixFQUFFTyxhQUFhLENBQUMxRDtJQUM5QixNQUFNMkQsSUFBSUMsT0FBT0gsTUFBTUksSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxJQUFJLEtBQUssU0FBU0M7SUFDckQsTUFBTWxFLElBQUk4RCxPQUFPSCxNQUFNSSxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLElBQUksS0FBSyxVQUFVQztJQUN0RCxNQUFNUixNQUFNSSxPQUFPSCxNQUFNSSxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLElBQUksS0FBSyxRQUFRQztJQUN0RCxPQUFPO1FBQUVMO1FBQUc3RDtRQUFHMEQ7SUFBSTtBQUNyQjtBQUVBLDBEQUEwRCxHQUMxRCxTQUFTUyx3QkFBd0I1QyxLQUFhO0lBQzVDLGdEQUFnRDtJQUNoRCxNQUFNdkIsSUFBSSwyQkFBMkJDLElBQUksQ0FBQ3NCO0lBQzFDLElBQUksQ0FBQ3ZCLEdBQUcsT0FBTztJQUNmLE1BQU1vRSxPQUFPcEUsQ0FBQyxDQUFDLEVBQUUsS0FBSyxNQUFNLENBQUMsSUFBSTtJQUNqQyxNQUFNcUUsS0FBS1AsT0FBTzlELENBQUMsQ0FBQyxFQUFFO0lBQ3RCLE1BQU1zRSxLQUFLUixPQUFPOUQsQ0FBQyxDQUFDLEVBQUU7SUFDdEIsT0FBT29FLE9BQVFDLENBQUFBLEtBQUssS0FBS0MsRUFBQztBQUM1QjtBQUVBLHVFQUF1RSxHQUN2RSxTQUFTQyxrQkFBa0JyRSxDQUFPLEVBQUVrRCxRQUFnQjtJQUNsRCxpRUFBaUU7SUFDakUsTUFBTW9CLE1BQU0sSUFBSWxCLEtBQUtDLGNBQWMsQ0FBQyxTQUFTO1FBQzNDSDtRQUNBcUIsY0FBYztRQUNkQyxRQUFRO1FBQ1JsQixNQUFNO1FBQ05DLE9BQU87UUFDUEMsS0FBSztRQUNMaUIsTUFBTTtRQUNOQyxRQUFRO0lBQ1Y7SUFDQSxNQUFNakIsUUFBUWEsSUFBSVosYUFBYSxDQUFDMUQ7SUFDaEMsTUFBTXFCLFFBQVFvQyxNQUFNSSxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLElBQUksS0FBSyxpQkFBaUJDLFNBQVM7SUFDbkUsTUFBTVcsT0FBT1Ysd0JBQXdCNUM7SUFDckMsc0VBQXNFO0lBQ3RFLElBQUlzRCxRQUFRLE1BQU07UUFDaEIsTUFBTUMsVUFBVSxJQUFJM0UsS0FDbEJxRSxJQUFJTyxNQUFNLENBQUM3RSxHQUFHOEUsT0FBTyxDQUNuQixnREFDQTtRQUdKLE1BQU1DLE9BQU8sQ0FBQ0gsUUFBUXhFLE9BQU8sS0FBS0osRUFBRUksT0FBTyxFQUFDLElBQUs7UUFDakQsT0FBT21DLEtBQUt5QyxLQUFLLENBQUNEO0lBQ3BCO0lBQ0EsT0FBT0o7QUFDVDtBQUVBOzs7Q0FHQyxHQUNELFNBQVNNLGlCQUFpQnRCLENBQVMsRUFBRXVCLEVBQVUsRUFBRWxGLENBQVMsRUFBRWtELFFBQWdCO0lBQzFFLGtEQUFrRDtJQUNsRCxNQUFNaUMsWUFBWSxJQUFJbEYsS0FBS0EsS0FBS0MsR0FBRyxDQUFDeUQsR0FBR3VCLEtBQUssR0FBR2xGLEdBQUcsR0FBRyxHQUFHLEdBQUc7SUFDM0QsNENBQTRDO0lBQzVDLE1BQU1vRixZQUFZZixrQkFBa0JjLFdBQVdqQztJQUMvQyxnQ0FBZ0M7SUFDaEMsT0FBTyxJQUFJakQsS0FBS2tGLFVBQVUvRSxPQUFPLEtBQUtnRixZQUFZO0FBQ3BEO0FBRUE7OztDQUdDLEdBQ0QsU0FBU0MsaUJBQWlCMUIsQ0FBUyxFQUFFdUIsRUFBVSxFQUFFbEYsQ0FBUyxFQUFFa0QsUUFBZ0I7SUFDMUUsTUFBTWlDLFlBQVksSUFBSWxGLEtBQUtBLEtBQUtDLEdBQUcsQ0FBQ3lELEdBQUd1QixLQUFLLEdBQUdsRixHQUFHLElBQUksSUFBSSxJQUFJO0lBQzlELE1BQU1vRixZQUFZZixrQkFBa0JjLFdBQVdqQztJQUMvQyxPQUFPLElBQUlqRCxLQUFLa0YsVUFBVS9FLE9BQU8sS0FBS2dGLFlBQVk7QUFDcEQ7QUFFQTs7OztDQUlDLEdBQ00sU0FBU0Usa0JBQWtCQyxLQUFhOUYsVUFBVTtJQUN2RCxNQUFNYyxNQUFNLElBQUlOO0lBQ2hCLE1BQU0sRUFBRTBELENBQUMsRUFBRTdELENBQUMsRUFBRSxHQUFHbUQsV0FBVzFDLEtBQUtnRixLQUFLLGdCQUFnQjtJQUN0RCxNQUFNQyxnQkFBZ0JQLGlCQUFpQnRCLEdBQUc3RCxHQUFHLEdBQUd5RjtJQUVoRCxrRkFBa0Y7SUFDbEYsTUFBTUUsWUFBWTNGLE1BQU0sS0FBSyxJQUFJQSxJQUFJO0lBQ3JDLE1BQU00RixnQkFBZ0I1RixNQUFNLEtBQUs2RCxJQUFJLElBQUlBO0lBRXpDLDRFQUE0RTtJQUM1RSxNQUFNZ0Msa0JBQWtCLElBQUkxRixLQUFLQSxLQUFLQyxHQUFHLENBQUN3RixlQUFlRCxZQUFZLEdBQUc7SUFDeEVFLGdCQUFnQi9ELFVBQVUsQ0FBQyxJQUFJLG9DQUFvQztJQUNuRSxNQUFNZ0UsYUFBYUQsZ0JBQWdCekUsVUFBVTtJQUU3QyxNQUFNMkUsZUFBZVIsaUJBQWlCMUIsR0FBRzdELEdBQUc4RixZQUFZTDtJQUN4RCxPQUFPO1FBQUVwRSxNQUFNcUU7UUFBZXBFLElBQUl5RTtJQUFhO0FBQ2pEO0FBRUE7O0NBRUMsR0FDTSxTQUFTQyxxQkFBcUJQLEtBQWE5RixVQUFVO0lBQzFELE1BQU0sRUFBRTBCLElBQUksRUFBRUMsRUFBRSxFQUFFLEdBQUdrRSxrQkFBa0JDO0lBQ3ZDLE9BQU87UUFBRXBFLE1BQU1BLEtBQUs0RSxXQUFXO1FBQUkzRSxJQUFJQSxHQUFHMkUsV0FBVztJQUFHO0FBQzFEIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3NyYy9saWIvcmVwb3J0aW5nV2luZG93LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvcmVwb3J0aW5nV2luZG93LnRzXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0IH0gZnJvbSBcIm5leHRcIjtcblxuLyoqXG4gKiBSYW5nZSBzaG9ydGhhbmRzIHlvdXIgQVBJcyBhY2NlcHQuXG4gKiBOT1RFOiBXZSBrZXB0IHlvdXIgZXhpc3RpbmcgcmFuZ2VzIGludGFjdC4gVXNlIHRoZSBuZXcgYGN1cnJlbnRNb250aFJhbmdlYFxuICogZm9yIHRoZSBkYXNoYm9hcmQgc3VtbWFyeSAoU3RlcCA3LjEpLlxuICovXG5leHBvcnQgdHlwZSBSYW5nZVBhcmFtID0gXCJkN1wiIHwgXCJkMzBcIiB8IFwiZDkwXCIgfCBcImFsbFwiO1xuXG4vKiogRGVmYXVsdCBidXNpbmVzcyB0aW1lem9uZSBmb3Ig4oCcVGhpcyBNb250aOKAnSBjYWxjdWxhdGlvbnMuICovXG5leHBvcnQgY29uc3QgREVGQVVMVF9UWiA9IHByb2Nlc3MuZW52LkRFRkFVTFRfVFogfHwgXCJBbWVyaWNhL0RlbnZlclwiO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBCYXNpYyBkYXRlIGhlbHBlcnMgKGV4aXN0aW5nIGJlaGF2aW9yIHByZXNlcnZlZClcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRGF0ZU9ubHkocz86IHN0cmluZyk6IERhdGUgfCBudWxsIHtcbiAgaWYgKCFzKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgbSA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSkkLy5leGVjKHMpO1xuICBpZiAoIW0pIHJldHVybiBudWxsO1xuICBjb25zdCBkID0gbmV3IERhdGUoRGF0ZS5VVEMoK21bMV0sICttWzJdIC0gMSwgK21bM10pKTtcbiAgcmV0dXJuIGlzTmFOKGQuZ2V0VGltZSgpKSA/IG51bGwgOiBkO1xufVxuXG4vKiogSW5jbHVzaXZlIGRheSB3aW5kb3c6IGBmcm9tYCBhdCAwMDowMCBVVEMsIGB0b2AgYXQgdGhlIGdpdmVuIGRheSAwMDowMCBVVEMuICovXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVdpbmRvdyhxOiBOZXh0QXBpUmVxdWVzdFtcInF1ZXJ5XCJdKToge1xuICBmcm9tOiBEYXRlO1xuICB0bzogRGF0ZTtcbiAgbGFiZWw6IFJhbmdlUGFyYW0gfCBcImN1c3RvbVwiO1xufSB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIGNvbnN0IGVuZFEgPSBhcnJheUZpcnN0KHEuZW5kKTtcbiAgY29uc3Qgc3RhcnRRID0gYXJyYXlGaXJzdChxLnN0YXJ0KTtcbiAgY29uc3QgcmFuZ2VRID0gYXJyYXlGaXJzdChxLnJhbmdlKSBhcyBSYW5nZVBhcmFtIHwgdW5kZWZpbmVkO1xuXG4gIC8vIE5vcm1hbGl6ZSB0byBhIGNsZWFuIFVUQyBkYXkgYm91bmRhcnkgZm9yIFRPREFZXG4gIGNvbnN0IHRvZGF5VVRDID0gbmV3IERhdGUoXG4gICAgRGF0ZS5VVEMobm93LmdldFVUQ0Z1bGxZZWFyKCksIG5vdy5nZXRVVENNb250aCgpLCBub3cuZ2V0VVRDRGF0ZSgpKVxuICApO1xuICBjb25zdCBlbmQgPSBwYXJzZURhdGVPbmx5KGVuZFEpID8/IHRvZGF5VVRDO1xuICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZU9ubHkoc3RhcnRRKTtcblxuICBpZiAoc3RhcnQgJiYgZW5kKSB7XG4gICAgY29uc3QgZnJvbSA9IHN0YXJ0IDw9IGVuZCA/IHN0YXJ0IDogZW5kO1xuICAgIGNvbnN0IHRvID0gZW5kID49IHN0YXJ0ID8gZW5kIDogc3RhcnQ7XG4gICAgcmV0dXJuIHsgZnJvbSwgdG8sIGxhYmVsOiBcImN1c3RvbVwiIH07XG4gIH1cblxuICBjb25zdCBtYXA6IFJlY29yZDxSYW5nZVBhcmFtLCBudW1iZXI+ID0geyBkNzogNywgZDMwOiAzMCwgZDkwOiA5MCwgYWxsOiAzNjUgfTtcbiAgY29uc3QgZGF5cyA9IG1hcFtyYW5nZVEgfHwgXCJkMzBcIl0gPz8gMzA7XG4gIGNvbnN0IGZyb20gPSBuZXcgRGF0ZShlbmQpO1xuICBmcm9tLnNldFVUQ0RhdGUoZnJvbS5nZXRVVENEYXRlKCkgLSBkYXlzICsgMSk7XG4gIHJldHVybiB7IGZyb20sIHRvOiBlbmQsIGxhYmVsOiAocmFuZ2VRIHx8IFwiZDMwXCIpIGFzIFJhbmdlUGFyYW0gfTtcbn1cblxuLyoqIDIzOjU5OjU5Ljk5OSBVVEMgb2YgdGhlIGdpdmVuIGRhdGUgKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmRPZkRheVVUQyhkOiBEYXRlKTogRGF0ZSB7XG4gIHJldHVybiBuZXcgRGF0ZShcbiAgICBEYXRlLlVUQyhcbiAgICAgIGQuZ2V0VVRDRnVsbFllYXIoKSxcbiAgICAgIGQuZ2V0VVRDTW9udGgoKSxcbiAgICAgIGQuZ2V0VVRDRGF0ZSgpLFxuICAgICAgMjMsXG4gICAgICA1OSxcbiAgICAgIDU5LFxuICAgICAgOTk5XG4gICAgKVxuICApO1xufVxuXG4vKiogSGVscGVyIHRvIHNhZmVseSByZWFkIHRoZSBmaXJzdCB2YWx1ZSBvZiBhIHF1ZXJ5IHBhcmFtIChhcnJheSBvciBzdHJpbmcpLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFycmF5Rmlyc3Qodjogc3RyaW5nIHwgc3RyaW5nW10gfCB1bmRlZmluZWQpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2KSA/IHZbMF0gOiB2O1xufVxuXG4vKiogUGFyc2Ugb3B0aW9uYWwgYGxpbWl0YCB3aXRoIHNhbmUgZGVmYXVsdHMgYW5kIGEgaGFyZCBjYXAuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VMaW1pdChcbiAgcTogTmV4dEFwaVJlcXVlc3RbXCJxdWVyeVwiXSxcbiAgZGVmID0gMTAwMDAsXG4gIGNhcCA9IDEwMDAwMFxuKTogbnVtYmVyIHtcbiAgY29uc3QgcmF3ID0gYXJyYXlGaXJzdChxLmxpbWl0KTtcbiAgY29uc3QgbiA9IE1hdGgubWF4KHBhcnNlSW50KHJhdyB8fCBTdHJpbmcoZGVmKSwgMTApIHx8IGRlZiwgMSk7XG4gIHJldHVybiBNYXRoLm1pbihuLCBjYXApO1xufVxuXG4vKiogUmVhZCBvcHRpb25hbCBzdHJpbmcgZmlsdGVycyAoZS5nLiwgc3RhdHVzLCBzb3VyY2VUeXBlKS4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWFkU3RyaW5nRmlsdGVyKFxuICBxOiBOZXh0QXBpUmVxdWVzdFtcInF1ZXJ5XCJdLFxuICBrZXk6IHN0cmluZ1xuKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgcmF3ID0gcVtrZXldO1xuICBjb25zdCB2ID0gQXJyYXkuaXNBcnJheShyYXcpID8gcmF3WzBdIDogcmF3O1xuICBpZiAodiAmJiB0eXBlb2YgdiA9PT0gXCJzdHJpbmdcIikge1xuICAgIGNvbnN0IHRyaW1tZWQgPSB2LnRyaW0oKTtcbiAgICByZXR1cm4gdHJpbW1lZCA/IHRyaW1tZWQgOiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogU3RlcCA3LjEgQVVHTUVOVCDigJQgVGltZXpvbmUtYXdhcmUg4oCcY3VycmVudCBtb250aOKAnSB3aW5kb3cgKG5vIGV4dHJhIGRlcHMpXG4gKlxuICogUHVycG9zZTpcbiAqICAgUHJvdmlkZSBhbiBhY2N1cmF0ZSDigJxUaGlzIE1vbnRo4oCdIHJhbmdlIGZvciBkYXNoYm9hcmRzICYgYmlsbGluZyByb2xsdXBzXG4gKiAgIGluIGEgYnVzaW5lc3MgdGltZXpvbmUgKGRlZmF1bHQgQW1lcmljYS9EZW52ZXIpLCBoYW5kbGluZyBEU1QgY29ycmVjdGx5LlxuICpcbiAqIFdoYXQgeW91IGdldDpcbiAqICAgY3VycmVudE1vbnRoUmFuZ2UodHopIOKGkiB7IGZyb20sIHRvIH1cbiAqICAgICAtIGBmcm9tYCA9IDAwOjAwOjAwLjAwMCBhdCBsb2NhbCB0aW1lIG9uIHRoZSAxc3Qgb2YgdGhpcyBtb250aCwgYXMgYSBVVEMgRGF0ZVxuICogICAgIC0gYHRvYCAgID0gMjM6NTk6NTkuOTk5IGF0IGxvY2FsIHRpbWUgb24gdGhlIGxhc3QgZGF5IG9mIHRoaXMgbW9udGgsIGFzIGEgVVRDIERhdGVcbiAqXG4gKiBJbXBsZW1lbnRhdGlvbiBub3RlczpcbiAqICAgLSBVc2VzIEludGwgQVBJcyB0byBkZXJpdmUgbG9jYWwgWS9NL0QgYW5kIG51bWVyaWMgVVRDIG9mZnNldCBmb3IgYSBnaXZlbiB0ei5cbiAqICAgLSBBdm9pZHMgYWRkaW5nIGRhdGUtZm5zL2RhdGUtZm5zLXR6IGRlcGVuZGVuY2llcy5cbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEV4dHJhY3RzIFkvTS9EIGZvciBhIGdpdmVuIERhdGUgYXMgc2VlbiBpbiBhIHRhcmdldCBJQU5BIHRpbWV6b25lLiAqL1xuZnVuY3Rpb24gZ2V0WU1ESW5UWihkOiBEYXRlLCB0aW1lWm9uZTogc3RyaW5nKTogeyB5OiBudW1iZXI7IG06IG51bWJlcjsgZGF5OiBudW1iZXIgfSB7XG4gIGNvbnN0IGYgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChcImVuLUNBXCIsIHtcbiAgICB0aW1lWm9uZSxcbiAgICB5ZWFyOiBcIm51bWVyaWNcIixcbiAgICBtb250aDogXCIyLWRpZ2l0XCIsXG4gICAgZGF5OiBcIjItZGlnaXRcIixcbiAgfSk7XG4gIGNvbnN0IHBhcnRzID0gZi5mb3JtYXRUb1BhcnRzKGQpO1xuICBjb25zdCB5ID0gTnVtYmVyKHBhcnRzLmZpbmQocCA9PiBwLnR5cGUgPT09IFwieWVhclwiKT8udmFsdWUpO1xuICBjb25zdCBtID0gTnVtYmVyKHBhcnRzLmZpbmQocCA9PiBwLnR5cGUgPT09IFwibW9udGhcIik/LnZhbHVlKTtcbiAgY29uc3QgZGF5ID0gTnVtYmVyKHBhcnRzLmZpbmQocCA9PiBwLnR5cGUgPT09IFwiZGF5XCIpPy52YWx1ZSk7XG4gIHJldHVybiB7IHksIG0sIGRheSB9O1xufVxuXG4vKiogUGFyc2VzIGEgVFogb2Zmc2V0IGxpa2UgXCJHTVQtMDY6MDBcIiDihpIgbWludXRlcyAoLTM2MCkuICovXG5mdW5jdGlvbiBwYXJzZUdtdE9mZnNldFRvTWludXRlcyhsYWJlbDogc3RyaW5nKTogbnVtYmVyIHwgbnVsbCB7XG4gIC8vIEV4cGVjdCBzdHJpbmdzIGxpa2UgXCJHTVQtMDY6MDBcIiAvIFwiR01UKzA1OjMwXCJcbiAgY29uc3QgbSA9IC9HTVQoWystXSkoXFxkezJ9KTooXFxkezJ9KS8uZXhlYyhsYWJlbCk7XG4gIGlmICghbSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHNpZ24gPSBtWzFdID09PSBcIi1cIiA/IC0xIDogMTtcbiAgY29uc3QgaGggPSBOdW1iZXIobVsyXSk7XG4gIGNvbnN0IG1tID0gTnVtYmVyKG1bM10pO1xuICByZXR1cm4gc2lnbiAqIChoaCAqIDYwICsgbW0pO1xufVxuXG4vKiogR2V0cyB0aGUgbnVtZXJpYyBvZmZzZXQsIGluIG1pbnV0ZXMsIG9mIGB0aW1lWm9uZWAgYXQgaW5zdGFudCBgZGAuICovXG5mdW5jdGlvbiB0ek9mZnNldE1pbnV0ZXNBdChkOiBEYXRlLCB0aW1lWm9uZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgLy8gVXNlIHRpbWVab25lTmFtZTogJ3Nob3J0T2Zmc2V0JyB0byBnZXQgbGFiZWxzIGxpa2UgXCJHTVQtMDY6MDBcIlxuICBjb25zdCBmbXQgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChcImVuLVVTXCIsIHtcbiAgICB0aW1lWm9uZSxcbiAgICB0aW1lWm9uZU5hbWU6IFwic2hvcnRPZmZzZXRcIixcbiAgICBob3VyMTI6IGZhbHNlLFxuICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICAgIG1vbnRoOiBcIjItZGlnaXRcIixcbiAgICBkYXk6IFwiMi1kaWdpdFwiLFxuICAgIGhvdXI6IFwiMi1kaWdpdFwiLFxuICAgIG1pbnV0ZTogXCIyLWRpZ2l0XCIsXG4gIH0pO1xuICBjb25zdCBwYXJ0cyA9IGZtdC5mb3JtYXRUb1BhcnRzKGQpO1xuICBjb25zdCBsYWJlbCA9IHBhcnRzLmZpbmQocCA9PiBwLnR5cGUgPT09IFwidGltZVpvbmVOYW1lXCIpPy52YWx1ZSB8fCBcIlwiO1xuICBjb25zdCBtaW5zID0gcGFyc2VHbXRPZmZzZXRUb01pbnV0ZXMobGFiZWwpO1xuICAvLyBGYWxsYmFjazogY29tcHV0ZSBvZmZzZXQgdmlhIHdhbGwtY2xvY2sgY29tcGFyaXNvbiBpZiBwYXJzaW5nIGZhaWxzXG4gIGlmIChtaW5zID09IG51bGwpIHtcbiAgICBjb25zdCBhc0xvY2FsID0gbmV3IERhdGUoXG4gICAgICBmbXQuZm9ybWF0KGQpLnJlcGxhY2UoXG4gICAgICAgIC8oXFxkezJ9KVxcLyhcXGR7Mn0pXFwvKFxcZHs0fSksIChcXGR7Mn0pOihcXGR7Mn0pLiovLFxuICAgICAgICBcIiQzLSQxLSQyVCQ0OiQ1OjAwWlwiXG4gICAgICApXG4gICAgKTtcbiAgICBjb25zdCBkaWZmID0gKGFzTG9jYWwuZ2V0VGltZSgpIC0gZC5nZXRUaW1lKCkpIC8gNjAwMDA7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoZGlmZik7XG4gIH1cbiAgcmV0dXJuIG1pbnM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgVVRDIGluc3RhbnQgY29ycmVzcG9uZGluZyB0byBMT0NBTCBtaWRuaWdodCAoMDA6MDA6MDAuMDAwKSBmb3JcbiAqIHRoZSBnaXZlbiBZL00vRCBpbiBgdGltZVpvbmVgLlxuICovXG5mdW5jdGlvbiBsb2NhbE1pZG5pZ2h0VVRDKHk6IG51bWJlciwgbTE6IG51bWJlciwgZDogbnVtYmVyLCB0aW1lWm9uZTogc3RyaW5nKTogRGF0ZSB7XG4gIC8vIENyZWF0ZSBhbiBhcHByb3hpbWF0ZSBVVEMgaW5zdGFudCBmb3IgdGhhdCBkYXRlXG4gIGNvbnN0IGFwcHJveFVUQyA9IG5ldyBEYXRlKERhdGUuVVRDKHksIG0xIC0gMSwgZCwgMCwgMCwgMCwgMCkpO1xuICAvLyBHZXQgdGhlIGNvcnJlY3Qgb2Zmc2V0IGF0IHRoYXQgbG9jYWwgZGF0ZVxuICBjb25zdCBvZmZzZXRNaW4gPSB0ek9mZnNldE1pbnV0ZXNBdChhcHByb3hVVEMsIHRpbWVab25lKTtcbiAgLy8gTG9jYWwgbWlkbmlnaHQgPSBVVEMgLSBvZmZzZXRcbiAgcmV0dXJuIG5ldyBEYXRlKGFwcHJveFVUQy5nZXRUaW1lKCkgLSBvZmZzZXRNaW4gKiA2MF8wMDApO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFVUQyBpbnN0YW50IGNvcnJlc3BvbmRpbmcgdG8gTE9DQUwgMjM6NTk6NTkuOTk5IGZvciB0aGUgZ2l2ZW5cbiAqIFkvTS9EIGluIGB0aW1lWm9uZWAuXG4gKi9cbmZ1bmN0aW9uIGxvY2FsRW5kT2ZEYXlVVEMoeTogbnVtYmVyLCBtMTogbnVtYmVyLCBkOiBudW1iZXIsIHRpbWVab25lOiBzdHJpbmcpOiBEYXRlIHtcbiAgY29uc3QgYXBwcm94VVRDID0gbmV3IERhdGUoRGF0ZS5VVEMoeSwgbTEgLSAxLCBkLCAyMywgNTksIDU5LCA5OTkpKTtcbiAgY29uc3Qgb2Zmc2V0TWluID0gdHpPZmZzZXRNaW51dGVzQXQoYXBwcm94VVRDLCB0aW1lWm9uZSk7XG4gIHJldHVybiBuZXcgRGF0ZShhcHByb3hVVEMuZ2V0VGltZSgpIC0gb2Zmc2V0TWluICogNjBfMDAwKTtcbn1cblxuLyoqXG4gKiBTdGVwIDcuMTog4oCcVGhpcyBNb250aOKAnSByYW5nZSBpbiBhIHRhcmdldCBidXNpbmVzcyB0aW1lem9uZSAoZGVmYXVsdDogQW1lcmljYS9EZW52ZXIpLlxuICogLSBmcm9tOiBmaXJzdCBkYXkgb2YgdGhpcyBtb250aCBhdCAwMDowMCBsb2NhbCAoYXMgYSBVVEMgRGF0ZSlcbiAqIC0gdG86ICAgbGFzdCBkYXkgb2YgdGhpcyBtb250aCBhdCAyMzo1OTo1OS45OTkgbG9jYWwgKGFzIGEgVVRDIERhdGUpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjdXJyZW50TW9udGhSYW5nZSh0ejogc3RyaW5nID0gREVGQVVMVF9UWik6IHsgZnJvbTogRGF0ZTsgdG86IERhdGUgfSB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIGNvbnN0IHsgeSwgbSB9ID0gZ2V0WU1ESW5UWihub3csIHR6KTsgLy8gbW9udGggaXMgMeKAkzEyXG4gIGNvbnN0IGZpcnN0TG9jYWxVVEMgPSBsb2NhbE1pZG5pZ2h0VVRDKHksIG0sIDEsIHR6KTtcblxuICAvLyBGaW5kIG51bWJlciBvZiBkYXlzIGluIHRoaXMgbW9udGggKGluIHRhcmdldCBUWikgYnkgbW92aW5nIHRvIG5leHQgbW9udGggZGF5IDAuXG4gIGNvbnN0IG5leHRNb250aCA9IG0gPT09IDEyID8gMSA6IG0gKyAxO1xuICBjb25zdCBuZXh0TW9udGhZZWFyID0gbSA9PT0gMTIgPyB5ICsgMSA6IHk7XG5cbiAgLy8gTGFzdCBkYXkgbnVtYmVyID0gZGF5IGNvbXBvbmVudCBvZiBcInRoZSBkYXkgYmVmb3JlIHRoZSAxc3Qgb2YgbmV4dCBtb250aFwiXG4gIGNvbnN0IGxhc3RPZk1vbnRoRGF0ZSA9IG5ldyBEYXRlKERhdGUuVVRDKG5leHRNb250aFllYXIsIG5leHRNb250aCAtIDEsIDEpKTtcbiAgbGFzdE9mTW9udGhEYXRlLnNldFVUQ0RhdGUoMCk7IC8vIG1vdmUgdG8gbGFzdCBkYXkgb2YgY3VycmVudCBtb250aFxuICBjb25zdCBsYXN0RGF5TnVtID0gbGFzdE9mTW9udGhEYXRlLmdldFVUQ0RhdGUoKTtcblxuICBjb25zdCBsYXN0TG9jYWxVVEMgPSBsb2NhbEVuZE9mRGF5VVRDKHksIG0sIGxhc3REYXlOdW0sIHR6KTtcbiAgcmV0dXJuIHsgZnJvbTogZmlyc3RMb2NhbFVUQywgdG86IGxhc3RMb2NhbFVUQyB9O1xufVxuXG4vKipcbiAqIENvbnZlbmllbmNlOiBSZXR1cm5zIElTTyBzdHJpbmdzIGZvciBVSS9kZWJ1Zy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGN1cnJlbnRNb250aFJhbmdlSVNPKHR6OiBzdHJpbmcgPSBERUZBVUxUX1RaKTogeyBmcm9tOiBzdHJpbmc7IHRvOiBzdHJpbmcgfSB7XG4gIGNvbnN0IHsgZnJvbSwgdG8gfSA9IGN1cnJlbnRNb250aFJhbmdlKHR6KTtcbiAgcmV0dXJuIHsgZnJvbTogZnJvbS50b0lTT1N0cmluZygpLCB0bzogdG8udG9JU09TdHJpbmcoKSB9O1xufVxuIl0sIm5hbWVzIjpbIkRFRkFVTFRfVFoiLCJwcm9jZXNzIiwiZW52IiwicGFyc2VEYXRlT25seSIsInMiLCJtIiwiZXhlYyIsImQiLCJEYXRlIiwiVVRDIiwiaXNOYU4iLCJnZXRUaW1lIiwiY29tcHV0ZVdpbmRvdyIsInEiLCJub3ciLCJlbmRRIiwiYXJyYXlGaXJzdCIsImVuZCIsInN0YXJ0USIsInN0YXJ0IiwicmFuZ2VRIiwicmFuZ2UiLCJ0b2RheVVUQyIsImdldFVUQ0Z1bGxZZWFyIiwiZ2V0VVRDTW9udGgiLCJnZXRVVENEYXRlIiwiZnJvbSIsInRvIiwibGFiZWwiLCJtYXAiLCJkNyIsImQzMCIsImQ5MCIsImFsbCIsImRheXMiLCJzZXRVVENEYXRlIiwiZW5kT2ZEYXlVVEMiLCJ2IiwiQXJyYXkiLCJpc0FycmF5IiwicGFyc2VMaW1pdCIsImRlZiIsImNhcCIsInJhdyIsImxpbWl0IiwibiIsIk1hdGgiLCJtYXgiLCJwYXJzZUludCIsIlN0cmluZyIsIm1pbiIsInJlYWRTdHJpbmdGaWx0ZXIiLCJrZXkiLCJ0cmltbWVkIiwidHJpbSIsInVuZGVmaW5lZCIsImdldFlNREluVFoiLCJ0aW1lWm9uZSIsImYiLCJJbnRsIiwiRGF0ZVRpbWVGb3JtYXQiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJwYXJ0cyIsImZvcm1hdFRvUGFydHMiLCJ5IiwiTnVtYmVyIiwiZmluZCIsInAiLCJ0eXBlIiwidmFsdWUiLCJwYXJzZUdtdE9mZnNldFRvTWludXRlcyIsInNpZ24iLCJoaCIsIm1tIiwidHpPZmZzZXRNaW51dGVzQXQiLCJmbXQiLCJ0aW1lWm9uZU5hbWUiLCJob3VyMTIiLCJob3VyIiwibWludXRlIiwibWlucyIsImFzTG9jYWwiLCJmb3JtYXQiLCJyZXBsYWNlIiwiZGlmZiIsInJvdW5kIiwibG9jYWxNaWRuaWdodFVUQyIsIm0xIiwiYXBwcm94VVRDIiwib2Zmc2V0TWluIiwibG9jYWxFbmRPZkRheVVUQyIsImN1cnJlbnRNb250aFJhbmdlIiwidHoiLCJmaXJzdExvY2FsVVRDIiwibmV4dE1vbnRoIiwibmV4dE1vbnRoWWVhciIsImxhc3RPZk1vbnRoRGF0ZSIsImxhc3REYXlOdW0iLCJsYXN0TG9jYWxVVEMiLCJjdXJyZW50TW9udGhSYW5nZUlTTyIsInRvSVNPU3RyaW5nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/reportingWindow.ts\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/dashboard/summary.ts":
/*!********************************************!*\
  !*** ./src/pages/api/dashboard/summary.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(api-node)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_rbac__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/rbac */ \"(api-node)/./src/lib/rbac.ts\");\n/* harmony import */ var _lib_leadScoring__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/leadScoring */ \"(api-node)/./src/lib/leadScoring.ts\");\n/* harmony import */ var _lib_reportingWindow__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/reportingWindow */ \"(api-node)/./src/lib/reportingWindow.ts\");\n// src/pages/api/dashboard/summary.ts\n\n\n\n\nasync function handler(req, res) {\n    try {\n        if (!await (0,_lib_rbac__WEBPACK_IMPORTED_MODULE_1__.assertPermission)(req, res, _lib_rbac__WEBPACK_IMPORTED_MODULE_1__.PERMS.DASHBOARD_VIEW)) return;\n        // --- Step 7.1 augment: timezone-aware \"This Month\" window (America/Denver by default)\n        const { from: periodStart, to: periodEnd } = (0,_lib_reportingWindow__WEBPACK_IMPORTED_MODULE_3__.currentMonthRange)();\n        const now = new Date();\n        // ---- Recent block (unchanged intent): last 90 days by CREATED date for generic KPIs/trend\n        const recent = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.findMany({\n            where: {\n                createdAt: {\n                    gte: new Date(now.getTime() - 90 * 24 * 3600 * 1000)\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            select: {\n                id: true,\n                createdAt: true,\n                convertedAt: true,\n                status: true,\n                sourceType: true,\n                sourceDetail: true,\n                systemGenerated: true,\n                aiScore: true,\n                enrichmentJson: true\n            }\n        });\n        const total = recent.length;\n        let converted = 0;\n        let rfp = 0;\n        const HOT_SCORE_THRESHOLD = Number(process.env.HOT_SCORE_THRESHOLD ?? 70);\n        let hot = 0;\n        let cold = 0;\n        const trendBuckets = {};\n        const trendStart = new Date(now.getTime() - 30 * 24 * 3600 * 1000);\n        // We will compute month billables via a dedicated conversion-scoped query below.\n        // Initialize here to keep the response shape identical.\n        let monthBillableCount = 0;\n        let monthBillableAmountUSD = 0;\n        for (const l of recent){\n            const st = (l.status || \"\").toString().toUpperCase();\n            const srcType = (l.sourceType || \"\").toString().toUpperCase();\n            // narrow enrichmentJson safely\n            const ej = l.enrichmentJson ?? {};\n            if (srcType === \"RFP\" || l.systemGenerated || (0,_lib_leadScoring__WEBPACK_IMPORTED_MODULE_2__.isSystemGenerated)(l.sourceDetail ?? \"\")) {\n                rfp++;\n            }\n            if (st === \"CONVERTED\" || st === \"WON\" || st === \"CLOSED-WON\") {\n                converted++;\n            }\n            const score = typeof l.aiScore === \"number\" ? l.aiScore : null;\n            if (score !== null) {\n                if (score >= HOT_SCORE_THRESHOLD) hot++;\n                else cold++;\n            }\n            const createdAt = l.createdAt ? new Date(l.createdAt) : null;\n            if (createdAt && createdAt >= trendStart) {\n                const key = createdAt.toISOString().slice(0, 10);\n                if (!trendBuckets[key]) trendBuckets[key] = {\n                    newLeads: 0,\n                    converted: 0\n                };\n                trendBuckets[key].newLeads++;\n            }\n            const convAt = l.convertedAt ? new Date(l.convertedAt) : null;\n            if (st === \"CONVERTED\" && convAt && convAt >= trendStart) {\n                const key = convAt.toISOString().slice(0, 10);\n                if (!trendBuckets[key]) trendBuckets[key] = {\n                    newLeads: 0,\n                    converted: 0\n                };\n                trendBuckets[key].converted++;\n            }\n        }\n        // ---- Accurate month billables: query by CONVERTED date within the month window\n        // Includes leads created long ago but converted this month.\n        const monthConverted = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.findMany({\n            where: {\n                // statuses: your dataset sometimes uses WON/CLOSED-WON; we treat them as converted as well\n                // If your enum is strict, feel free to narrow to 'CONVERTED' only.\n                convertedAt: {\n                    gte: periodStart,\n                    lte: periodEnd\n                },\n                // \"System-generated\" guard: either explicit field or sourceType flag\n                OR: [\n                    {\n                        sourceType: \"SYSTEM\"\n                    },\n                    {\n                        systemGenerated: true\n                    }\n                ]\n            },\n            select: {\n                id: true,\n                convertedAt: true,\n                status: true,\n                sourceType: true,\n                systemGenerated: true,\n                enrichmentJson: true\n            }\n        });\n        for (const l of monthConverted){\n            const ej = l.enrichmentJson ?? {};\n            const billing = ej.billing ?? {};\n            // Bill only if the conversion is marked eligible and not yet billed\n            if (billing.billableEligible === true && !billing.billedAt) {\n                monthBillableCount++;\n                const price = Number(billing.unitPriceCents || 0) / 100;\n                monthBillableAmountUSD += price;\n            }\n        }\n        const trend = Object.keys(trendBuckets).sort().map((d)=>({\n                date: d,\n                ...trendBuckets[d]\n            }));\n        return res.status(200).json({\n            ok: true,\n            kpis: {\n                totalLeads90d: total,\n                converted90d: converted,\n                rfp90d: rfp,\n                monthBillableCount,\n                monthBillableAmountUSD,\n                periodStartISO: periodStart.toISOString(),\n                periodEndISO: periodEnd.toISOString(),\n                hot90d: hot,\n                cold90d: cold,\n                trend\n            }\n        });\n    } catch (e) {\n        const msg = e?.message ?? \"Internal Error\";\n        // eslint-disable-next-line no-console\n        console.error(\"/api/dashboard/summary error:\", e);\n        return res.status(500).json({\n            ok: false,\n            error: msg\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvZGFzaGJvYXJkL3N1bW1hcnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxxQ0FBcUM7QUFFTztBQUNTO0FBQ0M7QUFDSTtBQVUzQyxlQUFlTSxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJO1FBQ0YsSUFBSSxDQUFFLE1BQU1OLDJEQUFnQkEsQ0FBQ0ssS0FBS0MsS0FBS0wsNENBQUtBLENBQUNNLGNBQWMsR0FBSTtRQUUvRCx1RkFBdUY7UUFDdkYsTUFBTSxFQUFFQyxNQUFNQyxXQUFXLEVBQUVDLElBQUlDLFNBQVMsRUFBRSxHQUFHUix1RUFBaUJBO1FBRTlELE1BQU1TLE1BQU0sSUFBSUM7UUFFaEIsNEZBQTRGO1FBQzVGLE1BQU1DLFNBQVMsTUFBTWYsK0NBQUVBLENBQUNnQixJQUFJLENBQUNDLFFBQVEsQ0FBQztZQUNwQ0MsT0FBTztnQkFBRUMsV0FBVztvQkFBRUMsS0FBSyxJQUFJTixLQUFLRCxJQUFJUSxPQUFPLEtBQUssS0FBSyxLQUFLLE9BQU87Z0JBQU07WUFBRTtZQUM3RUMsU0FBUztnQkFBRUgsV0FBVztZQUFPO1lBQzdCSSxRQUFRO2dCQUNOQyxJQUFJO2dCQUNKTCxXQUFXO2dCQUNYTSxhQUFhO2dCQUNiQyxRQUFRO2dCQUNSQyxZQUFZO2dCQUNaQyxjQUFjO2dCQUNkQyxpQkFBaUI7Z0JBQ2pCQyxTQUFTO2dCQUNUQyxnQkFBZ0I7WUFDbEI7UUFDRjtRQUVBLE1BQU1DLFFBQVFqQixPQUFPa0IsTUFBTTtRQUMzQixJQUFJQyxZQUFZO1FBQ2hCLElBQUlDLE1BQU07UUFFVixNQUFNQyxzQkFBc0JDLE9BQU9DLFFBQVFDLEdBQUcsQ0FBQ0gsbUJBQW1CLElBQUk7UUFDdEUsSUFBSUksTUFBTTtRQUNWLElBQUlDLE9BQU87UUFFWCxNQUFNQyxlQUE0QyxDQUFDO1FBQ25ELE1BQU1DLGFBQWEsSUFBSTdCLEtBQUtELElBQUlRLE9BQU8sS0FBSyxLQUFLLEtBQUssT0FBTztR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Q3ZCMkIsSUFBSSxHQUNKQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTztnQkFBRUMsTUFBTUQ7Z0JBQUcsR0FBRzdCLFlBQVksQ0FBQzZCLEVBQUU7WUFBQztRQUU3QyxPQUFPaEUsSUFBSW1CLE1BQU0sQ0FBQyxLQUFLK0MsSUFBSSxDQUFDO1lBQzFCQyxJQUFJO1lBQ0pDLE1BQU07Z0JBQ0pDLGVBQWU1QztnQkFDZjZDLGNBQWMzQztnQkFDZDRDLFFBQVEzQztnQkFDUlM7Z0JBQ0FDO2dCQUNBa0MsZ0JBQWdCckUsWUFBWTRDLFdBQVc7Z0JBQ3ZDMEIsY0FBY3BFLFVBQVUwQyxXQUFXO2dCQUNuQzJCLFFBQVF6QztnQkFDUjBDLFNBQVN6QztnQkFDVHlCO1lBQ0Y7UUFDRjtJQUNGLEVBQUUsT0FBT2lCLEdBQVk7UUFDbkIsTUFBTUMsTUFBTSxHQUFvQ0MsV0FBVztRQUMzRCxzQ0FBc0M7UUFDdENDLFFBQVFDLEtBQUssQ0FBQyxpQ0FBaUNKO1FBQy9DLE9BQU81RSxJQUFJbUIsTUFBTSxDQUFDLEtBQUsrQyxJQUFJLENBQUM7WUFBRUMsSUFBSTtZQUFPYSxPQUFPSDtRQUFJO0lBQ3REO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL3BhZ2VzL2FwaS9kYXNoYm9hcmQvc3VtbWFyeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcGFnZXMvYXBpL2Rhc2hib2FyZC9zdW1tYXJ5LnRzXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IHsgcHJpc21hIGFzIGRiIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuaW1wb3J0IHsgYXNzZXJ0UGVybWlzc2lvbiwgUEVSTVMgfSBmcm9tIFwiQC9saWIvcmJhY1wiO1xuaW1wb3J0IHsgaXNTeXN0ZW1HZW5lcmF0ZWQgfSBmcm9tIFwiQC9saWIvbGVhZFNjb3JpbmdcIjtcbmltcG9ydCB7IGN1cnJlbnRNb250aFJhbmdlIH0gZnJvbSBcIkAvbGliL3JlcG9ydGluZ1dpbmRvd1wiO1xuXG50eXBlIFRyZW5kQnVja2V0ID0geyBuZXdMZWFkczogbnVtYmVyOyBjb252ZXJ0ZWQ6IG51bWJlciB9O1xudHlwZSBFbnJpY2htZW50QmlsbGluZyA9IHtcbiAgYmlsbGFibGVFbGlnaWJsZT86IGJvb2xlYW47XG4gIGJpbGxlZEF0PzogdW5rbm93bjtcbiAgdW5pdFByaWNlQ2VudHM/OiBudW1iZXI7XG59O1xudHlwZSBFbnJpY2htZW50SnNvbiA9IHsgYmlsbGluZz86IEVucmljaG1lbnRCaWxsaW5nIH0gJiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICB0cnkge1xuICAgIGlmICghKGF3YWl0IGFzc2VydFBlcm1pc3Npb24ocmVxLCByZXMsIFBFUk1TLkRBU0hCT0FSRF9WSUVXKSkpIHJldHVybjtcblxuICAgIC8vIC0tLSBTdGVwIDcuMSBhdWdtZW50OiB0aW1lem9uZS1hd2FyZSBcIlRoaXMgTW9udGhcIiB3aW5kb3cgKEFtZXJpY2EvRGVudmVyIGJ5IGRlZmF1bHQpXG4gICAgY29uc3QgeyBmcm9tOiBwZXJpb2RTdGFydCwgdG86IHBlcmlvZEVuZCB9ID0gY3VycmVudE1vbnRoUmFuZ2UoKTtcblxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAvLyAtLS0tIFJlY2VudCBibG9jayAodW5jaGFuZ2VkIGludGVudCk6IGxhc3QgOTAgZGF5cyBieSBDUkVBVEVEIGRhdGUgZm9yIGdlbmVyaWMgS1BJcy90cmVuZFxuICAgIGNvbnN0IHJlY2VudCA9IGF3YWl0IGRiLmxlYWQuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHsgY3JlYXRlZEF0OiB7IGd0ZTogbmV3IERhdGUobm93LmdldFRpbWUoKSAtIDkwICogMjQgKiAzNjAwICogMTAwMCkgfSB9LFxuICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6IFwiZGVzY1wiIH0sXG4gICAgICBzZWxlY3Q6IHtcbiAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogdHJ1ZSxcbiAgICAgICAgY29udmVydGVkQXQ6IHRydWUsXG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgc291cmNlVHlwZTogdHJ1ZSxcbiAgICAgICAgc291cmNlRGV0YWlsOiB0cnVlLFxuICAgICAgICBzeXN0ZW1HZW5lcmF0ZWQ6IHRydWUsXG4gICAgICAgIGFpU2NvcmU6IHRydWUsXG4gICAgICAgIGVucmljaG1lbnRKc29uOiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHRvdGFsID0gcmVjZW50Lmxlbmd0aDtcbiAgICBsZXQgY29udmVydGVkID0gMDtcbiAgICBsZXQgcmZwID0gMDtcblxuICAgIGNvbnN0IEhPVF9TQ09SRV9USFJFU0hPTEQgPSBOdW1iZXIocHJvY2Vzcy5lbnYuSE9UX1NDT1JFX1RIUkVTSE9MRCA/PyA3MCk7XG4gICAgbGV0IGhvdCA9IDA7XG4gICAgbGV0IGNvbGQgPSAwO1xuXG4gICAgY29uc3QgdHJlbmRCdWNrZXRzOiBSZWNvcmQ8c3RyaW5nLCBUcmVuZEJ1Y2tldD4gPSB7fTtcbiAgICBjb25zdCB0cmVuZFN0YXJ0ID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIDMwICogMjQgKiAzNjAwICogMTAwMCk7XG5cbiAgICAvLyBXZSB3aWxsIGNvbXB1dGUgbW9udGggYmlsbGFibGVzIHZpYSBhIGRlZGljYXRlZCBjb252ZXJzaW9uLXNjb3BlZCBxdWVyeSBiZWxvdy5cbiAgICAvLyBJbml0aWFsaXplIGhlcmUgdG8ga2VlcCB0aGUgcmVzcG9uc2Ugc2hhcGUgaWRlbnRpY2FsLlxuICAgIGxldCBtb250aEJpbGxhYmxlQ291bnQgPSAwO1xuICAgIGxldCBtb250aEJpbGxhYmxlQW1vdW50VVNEID0gMDtcblxuICAgIGZvciAoY29uc3QgbCBvZiByZWNlbnQpIHtcbiAgICAgIGNvbnN0IHN0ID0gKGwuc3RhdHVzIHx8IFwiXCIpLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcbiAgICAgIGNvbnN0IHNyY1R5cGUgPSAobC5zb3VyY2VUeXBlIHx8IFwiXCIpLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcblxuICAgICAgLy8gbmFycm93IGVucmljaG1lbnRKc29uIHNhZmVseVxuICAgICAgY29uc3QgZWogPSAobC5lbnJpY2htZW50SnNvbiA/PyB7fSkgYXMgRW5yaWNobWVudEpzb247XG5cbiAgICAgIGlmIChzcmNUeXBlID09PSBcIlJGUFwiIHx8IGwuc3lzdGVtR2VuZXJhdGVkIHx8IGlzU3lzdGVtR2VuZXJhdGVkKGwuc291cmNlRGV0YWlsID8/IFwiXCIpKSB7XG4gICAgICAgIHJmcCsrO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3QgPT09IFwiQ09OVkVSVEVEXCIgfHwgc3QgPT09IFwiV09OXCIgfHwgc3QgPT09IFwiQ0xPU0VELVdPTlwiKSB7XG4gICAgICAgIGNvbnZlcnRlZCsrO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzY29yZSA9IHR5cGVvZiBsLmFpU2NvcmUgPT09IFwibnVtYmVyXCIgPyBsLmFpU2NvcmUgOiBudWxsO1xuICAgICAgaWYgKHNjb3JlICE9PSBudWxsKSB7XG4gICAgICAgIGlmIChzY29yZSA+PSBIT1RfU0NPUkVfVEhSRVNIT0xEKSBob3QrKztcbiAgICAgICAgZWxzZSBjb2xkKys7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNyZWF0ZWRBdCA9IGwuY3JlYXRlZEF0ID8gbmV3IERhdGUobC5jcmVhdGVkQXQpIDogbnVsbDtcbiAgICAgIGlmIChjcmVhdGVkQXQgJiYgY3JlYXRlZEF0ID49IHRyZW5kU3RhcnQpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApO1xuICAgICAgICBpZiAoIXRyZW5kQnVja2V0c1trZXldKSB0cmVuZEJ1Y2tldHNba2V5XSA9IHsgbmV3TGVhZHM6IDAsIGNvbnZlcnRlZDogMCB9O1xuICAgICAgICB0cmVuZEJ1Y2tldHNba2V5XS5uZXdMZWFkcysrO1xuICAgICAgfVxuICAgICAgY29uc3QgY29udkF0ID0gbC5jb252ZXJ0ZWRBdCA/IG5ldyBEYXRlKGwuY29udmVydGVkQXQpIDogbnVsbDtcbiAgICAgIGlmIChzdCA9PT0gXCJDT05WRVJURURcIiAmJiBjb252QXQgJiYgY29udkF0ID49IHRyZW5kU3RhcnQpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gY29udkF0LnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApO1xuICAgICAgICBpZiAoIXRyZW5kQnVja2V0c1trZXldKSB0cmVuZEJ1Y2tldHNba2V5XSA9IHsgbmV3TGVhZHM6IDAsIGNvbnZlcnRlZDogMCB9O1xuICAgICAgICB0cmVuZEJ1Y2tldHNba2V5XS5jb252ZXJ0ZWQrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAtLS0tIEFjY3VyYXRlIG1vbnRoIGJpbGxhYmxlczogcXVlcnkgYnkgQ09OVkVSVEVEIGRhdGUgd2l0aGluIHRoZSBtb250aCB3aW5kb3dcbiAgICAvLyBJbmNsdWRlcyBsZWFkcyBjcmVhdGVkIGxvbmcgYWdvIGJ1dCBjb252ZXJ0ZWQgdGhpcyBtb250aC5cbiAgICBjb25zdCBtb250aENvbnZlcnRlZCA9IGF3YWl0IGRiLmxlYWQuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgLy8gc3RhdHVzZXM6IHlvdXIgZGF0YXNldCBzb21ldGltZXMgdXNlcyBXT04vQ0xPU0VELVdPTjsgd2UgdHJlYXQgdGhlbSBhcyBjb252ZXJ0ZWQgYXMgd2VsbFxuICAgICAgICAvLyBJZiB5b3VyIGVudW0gaXMgc3RyaWN0LCBmZWVsIGZyZWUgdG8gbmFycm93IHRvICdDT05WRVJURUQnIG9ubHkuXG4gICAgICAgIGNvbnZlcnRlZEF0OiB7IGd0ZTogcGVyaW9kU3RhcnQsIGx0ZTogcGVyaW9kRW5kIH0sXG4gICAgICAgIC8vIFwiU3lzdGVtLWdlbmVyYXRlZFwiIGd1YXJkOiBlaXRoZXIgZXhwbGljaXQgZmllbGQgb3Igc291cmNlVHlwZSBmbGFnXG4gICAgICAgIE9SOiBbeyBzb3VyY2VUeXBlOiBcIlNZU1RFTVwiIGFzIGFueSB9LCB7IHN5c3RlbUdlbmVyYXRlZDogdHJ1ZSB9XSxcbiAgICAgIH0sXG4gICAgICBzZWxlY3Q6IHtcbiAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgIGNvbnZlcnRlZEF0OiB0cnVlLFxuICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgIHNvdXJjZVR5cGU6IHRydWUsXG4gICAgICAgIHN5c3RlbUdlbmVyYXRlZDogdHJ1ZSxcbiAgICAgICAgZW5yaWNobWVudEpzb246IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgZm9yIChjb25zdCBsIG9mIG1vbnRoQ29udmVydGVkKSB7XG4gICAgICBjb25zdCBlaiA9IChsLmVucmljaG1lbnRKc29uID8/IHt9KSBhcyBFbnJpY2htZW50SnNvbjtcbiAgICAgIGNvbnN0IGJpbGxpbmcgPSAoZWouYmlsbGluZyA/PyB7fSkgYXMgRW5yaWNobWVudEJpbGxpbmc7XG5cbiAgICAgIC8vIEJpbGwgb25seSBpZiB0aGUgY29udmVyc2lvbiBpcyBtYXJrZWQgZWxpZ2libGUgYW5kIG5vdCB5ZXQgYmlsbGVkXG4gICAgICBpZiAoYmlsbGluZy5iaWxsYWJsZUVsaWdpYmxlID09PSB0cnVlICYmICFiaWxsaW5nLmJpbGxlZEF0KSB7XG4gICAgICAgIG1vbnRoQmlsbGFibGVDb3VudCsrO1xuICAgICAgICBjb25zdCBwcmljZSA9IE51bWJlcihiaWxsaW5nLnVuaXRQcmljZUNlbnRzIHx8IDApIC8gMTAwO1xuICAgICAgICBtb250aEJpbGxhYmxlQW1vdW50VVNEICs9IHByaWNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHRyZW5kID0gT2JqZWN0LmtleXModHJlbmRCdWNrZXRzKVxuICAgICAgLnNvcnQoKVxuICAgICAgLm1hcCgoZCkgPT4gKHsgZGF0ZTogZCwgLi4udHJlbmRCdWNrZXRzW2RdIH0pKTtcblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBvazogdHJ1ZSxcbiAgICAgIGtwaXM6IHtcbiAgICAgICAgdG90YWxMZWFkczkwZDogdG90YWwsXG4gICAgICAgIGNvbnZlcnRlZDkwZDogY29udmVydGVkLFxuICAgICAgICByZnA5MGQ6IHJmcCxcbiAgICAgICAgbW9udGhCaWxsYWJsZUNvdW50LFxuICAgICAgICBtb250aEJpbGxhYmxlQW1vdW50VVNELFxuICAgICAgICBwZXJpb2RTdGFydElTTzogcGVyaW9kU3RhcnQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgcGVyaW9kRW5kSVNPOiBwZXJpb2RFbmQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgaG90OTBkOiBob3QsXG4gICAgICAgIGNvbGQ5MGQ6IGNvbGQsXG4gICAgICAgIHRyZW5kLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZTogdW5rbm93bikge1xuICAgIGNvbnN0IG1zZyA9IChlIGFzIHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCk/Lm1lc3NhZ2UgPz8gXCJJbnRlcm5hbCBFcnJvclwiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5lcnJvcihcIi9hcGkvZGFzaGJvYXJkL3N1bW1hcnkgZXJyb3I6XCIsIGUpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IG1zZyB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImRiIiwiYXNzZXJ0UGVybWlzc2lvbiIsIlBFUk1TIiwiaXNTeXN0ZW1HZW5lcmF0ZWQiLCJjdXJyZW50TW9udGhSYW5nZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJEQVNIQk9BUkRfVklFVyIsImZyb20iLCJwZXJpb2RTdGFydCIsInRvIiwicGVyaW9kRW5kIiwibm93IiwiRGF0ZSIsInJlY2VudCIsImxlYWQiLCJmaW5kTWFueSIsIndoZXJlIiwiY3JlYXRlZEF0IiwiZ3RlIiwiZ2V0VGltZSIsIm9yZGVyQnkiLCJzZWxlY3QiLCJpZCIsImNvbnZlcnRlZEF0Iiwic3RhdHVzIiwic291cmNlVHlwZSIsInNvdXJjZURldGFpbCIsInN5c3RlbUdlbmVyYXRlZCIsImFpU2NvcmUiLCJlbnJpY2htZW50SnNvbiIsInRvdGFsIiwibGVuZ3RoIiwiY29udmVydGVkIiwicmZwIiwiSE9UX1NDT1JFX1RIUkVTSE9MRCIsIk51bWJlciIsInByb2Nlc3MiLCJlbnYiLCJob3QiLCJjb2xkIiwidHJlbmRCdWNrZXRzIiwidHJlbmRTdGFydCIsIm1vbnRoQmlsbGFibGVDb3VudCIsIm1vbnRoQmlsbGFibGVBbW91bnRVU0QiLCJsIiwic3QiLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIiwic3JjVHlwZSIsImVqIiwic2NvcmUiLCJrZXkiLCJ0b0lTT1N0cmluZyIsInNsaWNlIiwibmV3TGVhZHMiLCJjb252QXQiLCJtb250aENvbnZlcnRlZCIsImx0ZSIsIk9SIiwiYmlsbGluZyIsImJpbGxhYmxlRWxpZ2libGUiLCJiaWxsZWRBdCIsInByaWNlIiwidW5pdFByaWNlQ2VudHMiLCJ0cmVuZCIsIk9iamVjdCIsImtleXMiLCJzb3J0IiwibWFwIiwiZCIsImRhdGUiLCJqc29uIiwib2siLCJrcGlzIiwidG90YWxMZWFkczkwZCIsImNvbnZlcnRlZDkwZCIsInJmcDkwZCIsInBlcmlvZFN0YXJ0SVNPIiwicGVyaW9kRW5kSVNPIiwiaG90OTBkIiwiY29sZDkwZCIsImUiLCJtc2ciLCJtZXNzYWdlIiwiY29uc29sZSIsImVycm9yIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/dashboard/summary.ts\n");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard%2Fsummary&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fdashboard%2Fsummary.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();