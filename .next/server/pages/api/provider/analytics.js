"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/provider/analytics";
exports.ids = ["pages/api/provider/analytics"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Fanalytics&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Fanalytics.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Fanalytics&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Fanalytics.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_provider_analytics_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/provider/analytics.ts */ \"(api-node)/./src/pages/api/provider/analytics.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_provider_analytics_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_provider_analytics_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/provider/analytics\",\n        pathname: \"/api/provider/analytics\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_provider_analytics_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/provider/analytics\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/provider/analytics\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGcHJvdmlkZXIlMkZhbmFseXRpY3MmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlMkZwYWdlcyUyRmFwaSUyRnByb3ZpZGVyJTJGYW5hbHl0aWNzLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUF1RDtBQUNDO0FBQ3VDO0FBQ3JDO0FBQzFEO0FBQ2tFO0FBQ007QUFDRjtBQUN0RTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsaUVBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGlFQUFRO0FBQ3BDO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osYUFBYSxPQUFvQyxJQUFJLENBQUU7QUFDdkQsd0JBQXdCLE1BQXVDO0FBQy9ELENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxLQUFxQixFQUFFLEVBRTFCO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUF3RDtBQUNwRTtBQUNBO0FBQ0EsdUJBQXVCLDRFQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLDZDQUE2QyxFQUE2QztBQUMxRiw0Q0FBNEMsS0FBd0M7QUFDcEYsaUNBQWlDLEtBQW9DO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnRkFBYztBQUMvRSwrREFBK0QseUNBQXlDO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVEsRUFBRSxNQUFNO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0Esa0JBQWtCO0FBQ2xCLHVDQUF1QyxRQUFRLEVBQUUsUUFBUTtBQUN6RDtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2RUFBNkUsZ0ZBQWM7QUFDM0YsaUNBQWlDLFFBQVEsRUFBRSxRQUFRO0FBQ25ELDBCQUEwQix1RUFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHFFQUFTO0FBQ2pCLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzZW5kRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9hcGktdXRpbHNcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9wcm92aWRlci9hbmFseXRpY3MudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcHJvdmlkZXIvYW5hbHl0aWNzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHJvdmlkZXIvYW5hbHl0aWNzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmQsXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnXG59KTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICBsZXQgc3JjUGFnZSA9IFwiL2FwaS9wcm92aWRlci9hbmFseXRpY3NcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvcHJvdmlkZXIvYW5hbHl0aWNzXCIsXG4gICAgICAgICAgICAgICAgaW50ZXJuYWxSZXZhbGlkYXRlOiByb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LnJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgb25FcnJvcjogKC4uLmFyZ3MpPT5vblJlcXVlc3RFcnJvcihyZXEsIC4uLmFyZ3MpXG4gICAgICAgICAgICB9KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShhY3RpdmVTcGFuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICAgICBzcGFuTmFtZTogYCR7bWV0aG9kfSAke3JlcS51cmx9YCxcbiAgICAgICAgICAgICAgICAgICAga2luZDogU3BhbktpbmQuU0VSVkVSLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5tZXRob2QnOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC50YXJnZXQnOiByZXEudXJsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBpbnZva2VSb3V0ZU1vZHVsZSkpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIHdlIHJlLXRocm93IGluIGRldiB0byBzaG93IHRoZSBlcnJvciBvdmVybGF5XG4gICAgICAgIGlmIChyb3V0ZU1vZHVsZS5pc0Rldikge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgICAgIC8vIHRoaXMgaXMgdGVjaG5pY2FsbHkgYW4gaW52YXJpYW50IGFzIGVycm9yIGhhbmRsaW5nXG4gICAgICAgIC8vIHNob3VsZCBiZSBkb25lIGluc2lkZSBvZiBhcGktcmVzb2x2ZXIgb25FcnJvclxuICAgICAgICBzZW5kRXJyb3IocmVzLCA1MDAsICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InKTtcbiAgICB9IGZpbmFsbHl7XG4gICAgICAgIC8vIFdlIGRvbid0IGFsbG93IGFueSB3YWl0VW50aWwgd29yayBpbiBwYWdlcyBBUEkgcm91dGVzIGN1cnJlbnRseVxuICAgICAgICAvLyBzbyBpZiBjYWxsYmFjayBpcyBwcmVzZW50IHJldHVybiB3aXRoIHJlc29sdmVkIHByb21pc2Ugc2luY2Ugbm9cbiAgICAgICAgLy8gcGVuZGluZyB3b3JrXG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Fanalytics&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Fanalytics.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n// src/lib/prisma.ts\n\nconst prisma = global.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) global.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLG9CQUFvQjtBQUMwQjtBQVF2QyxNQUFNQyxTQUNYQyxPQUFPRCxNQUFNLElBQ2IsSUFBSUQsd0RBQVlBLENBQUM7SUFDZkcsS0FBS0MsS0FBc0MsR0FBRztRQUFDO1FBQVM7UUFBUztLQUFPLEdBQUcsQ0FBUztBQUN0RixHQUFHO0FBRUwsSUFBSUEsSUFBcUMsRUFBRUYsT0FBT0QsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zcmMvbGliL3ByaXNtYS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL3ByaXNtYS50c1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gQWxsb3cgZ2xvYmFsIGB2YXJgIHJlZGVjbGFyYXRpb24gaW4gZGV2XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsLnByaXNtYSA/P1xuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBbXCJxdWVyeVwiLCBcImVycm9yXCIsIFwid2FyblwiXSA6IFtcImVycm9yXCJdLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikgZ2xvYmFsLnByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJnbG9iYWwiLCJsb2ciLCJwcm9jZXNzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(api-node)/./src/lib/rbac.ts":
/*!*************************!*\
  !*** ./src/lib/rbac.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PERMS: () => (/* binding */ PERMS),\n/* harmony export */   assertPermission: () => (/* binding */ assertPermission),\n/* harmony export */   getEmailFromReq: () => (/* binding */ getEmailFromReq),\n/* harmony export */   getOrgIdFromReq: () => (/* binding */ getOrgIdFromReq)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(api-node)/./src/lib/prisma.ts\");\n// src/lib/rbac.ts\n\n/**\n * Permission catalog. Keep codes in sync with seed.\n */ const PERMS = {\n    DASHBOARD_VIEW: \"dashboard:view\",\n    LEAD_READ: \"lead:read\",\n    LEAD_CREATE: \"lead:create\",\n    LEAD_UPDATE: \"lead:update\",\n    LEAD_DELETE: \"lead:delete\",\n    LEAD_EXPORT: \"lead:export\",\n    ROLES_MANAGE: \"roles:manage\",\n    BILLING_MANAGE: \"billing:manage\"\n};\n/**\n * Email that should bypass RBAC permission checks entirely.\n * If DEV_USER_EMAIL is set in the environment, any request from that\n * email address will be treated as having all permissions. This is\n * useful for development and automated testing. In production you\n * should leave DEV_USER_EMAIL unset.\n */ const DEV_USER_EMAIL = process.env.DEV_USER_EMAIL?.toLowerCase() || null;\n/**\n * Extract current user's email from cookie or header.\n * - Cookie: mv_user=<email>\n * - Header: x-mv-user: <email>  (useful for scripts/tests)\n */ function getEmailFromReq(req) {\n    const fromCookie = req.cookies?.mv_user;\n    const fromHeader = req.headers[\"x-mv-user\"] || req.headers[\"x-mvuser\"];\n    const raw = (Array.isArray(fromCookie) ? fromCookie[0] : fromCookie) ?? fromHeader ?? \"\";\n    const email = raw?.toString().trim().toLowerCase();\n    return email || null;\n}\n/** Look up orgId for current user (used to scope queries). */ async function getOrgIdFromReq(req) {\n    const email = getEmailFromReq(req);\n    if (!email) return null;\n    // Development bypass: if this is the dev user, return a fixed orgId\n    // if provided via DEV_ORG_ID, otherwise fall through to DB lookup.\n    if (DEV_USER_EMAIL && email === DEV_USER_EMAIL) {\n        // Use DEV_ORG_ID if provided, else null to indicate no org\n        const devOrg = process.env.DEV_ORG_ID;\n        if (devOrg) return devOrg;\n        // As a fallback, attempt to fetch the first org from the database\n        try {\n            const firstOrg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.org.findFirst({\n                select: {\n                    id: true\n                }\n            });\n            return firstOrg?.id ?? null;\n        } catch  {\n            return null;\n        }\n    }\n    const u = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email\n        },\n        select: {\n            orgId: true\n        }\n    });\n    return u?.orgId ?? null;\n}\n/**\n * Fetch user's effective permissions from RBAC tables.\n * Falls back to legacy User.role for OWNER/MANAGER/STAFF convenience.\n */ async function getUserPermCodes(userId, legacyRole) {\n    const roleLinks = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.rbacUserRole.findMany({\n        where: {\n            userId\n        },\n        select: {\n            roleId: true\n        }\n    });\n    const roleIds = roleLinks.map((r)=>r.roleId);\n    const perms = roleIds.length ? await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.rbacRolePermission.findMany({\n        where: {\n            roleId: {\n                in: roleIds\n            }\n        },\n        include: {\n            permission: true\n        }\n    }) : [];\n    const codes = new Set(perms.map((rp)=>rp.permission.code));\n    // Legacy role convenience (non-blocking): give sensible defaults\n    switch((legacyRole || \"\").toUpperCase()){\n        case \"OWNER\":\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE,\n                PERMS.LEAD_DELETE,\n                PERMS.LEAD_EXPORT,\n                PERMS.ROLES_MANAGE,\n                PERMS.BILLING_MANAGE\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"MANAGER\":\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE,\n                PERMS.LEAD_DELETE,\n                PERMS.LEAD_EXPORT\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"STAFF\":\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE\n            ].forEach((c)=>codes.add(c));\n            break;\n    }\n    return codes;\n}\n/**\n * Assert that current request is from an authenticated user with a given permission.\n * Writes 401/403 to res if not allowed. Returns true if allowed, false otherwise.\n */ async function assertPermission(req, res, required) {\n    try {\n        const email = getEmailFromReq(req);\n        if (!email) {\n            res.status(401).json({\n                ok: false,\n                error: \"Unauthorized\"\n            });\n            return false;\n        }\n        // Development bypass: if the incoming email matches the DEV_USER_EMAIL\n        // then skip any database lookups and allow the request. This permits\n        // automated tests and development sessions to exercise any API\n        // regardless of the user's persisted role or permissions. If no\n        // DEV_USER_EMAIL is configured, this block has no effect.\n        if (DEV_USER_EMAIL && email === DEV_USER_EMAIL) {\n            return true;\n        }\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                email\n            },\n            select: {\n                id: true,\n                role: true\n            }\n        });\n        if (!user) {\n            res.status(401).json({\n                ok: false,\n                error: \"Unauthorized\"\n            });\n            return false;\n        }\n        const codes = await getUserPermCodes(user.id, user.role);\n        if (!codes.has(required)) {\n            res.status(403).json({\n                ok: false,\n                error: \"Forbidden\"\n            });\n            return false;\n        }\n        return true;\n    } catch (e) {\n        console.error(\"assertPermission error:\", e);\n        res.status(500).json({\n            ok: false,\n            error: \"Internal Server Error\"\n        });\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsSUFBSTtnQkFBT0MsT0FBTztZQUFlO1lBQ3hELE9BQU87UUFDVDtRQUVBLE1BQU1kLFFBQVEsTUFBTWhCLGlCQUFpQkosS0FBS0YsRUFBRSxFQUFFRSxLQUFLbUMsSUFBSTtRQUN2RCxJQUFJLENBQUNmLE1BQU1nQixHQUFHLENBQUNOLFdBQVc7WUFDeEJELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLElBQUk7Z0JBQU9DLE9BQU87WUFBWTtZQUNyRCxPQUFPO1FBQ1Q7UUFDQSxPQUFPO0lBQ1QsRUFBRSxPQUFPRyxHQUFZO1FBQ25CQyxRQUFRSixLQUFLLENBQUMsMkJBQTJCRztRQUN6Q1IsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxJQUFJO1lBQU9DLE9BQU87UUFBd0I7UUFDakUsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL2xpYi9yYmFjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvcmJhYy50c1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcbmltcG9ydCB7IHByaXNtYSBhcyBkYiB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcblxuLyoqXG4gKiBQZXJtaXNzaW9uIGNhdGFsb2cuIEtlZXAgY29kZXMgaW4gc3luYyB3aXRoIHNlZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBQRVJNUyA9IHtcbiAgREFTSEJPQVJEX1ZJRVc6IFwiZGFzaGJvYXJkOnZpZXdcIixcbiAgTEVBRF9SRUFEOiBcImxlYWQ6cmVhZFwiLFxuICBMRUFEX0NSRUFURTogXCJsZWFkOmNyZWF0ZVwiLFxuICBMRUFEX1VQREFURTogXCJsZWFkOnVwZGF0ZVwiLFxuICBMRUFEX0RFTEVURTogXCJsZWFkOmRlbGV0ZVwiLFxuICBMRUFEX0VYUE9SVDogXCJsZWFkOmV4cG9ydFwiLFxuICBST0xFU19NQU5BR0U6IFwicm9sZXM6bWFuYWdlXCIsXG4gIEJJTExJTkdfTUFOQUdFOiBcImJpbGxpbmc6bWFuYWdlXCIsXG59IGFzIGNvbnN0O1xuZXhwb3J0IHR5cGUgUGVybUNvZGUgPSAodHlwZW9mIFBFUk1TKVtrZXlvZiB0eXBlb2YgUEVSTVNdO1xuXG4vKipcbiAqIEVtYWlsIHRoYXQgc2hvdWxkIGJ5cGFzcyBSQkFDIHBlcm1pc3Npb24gY2hlY2tzIGVudGlyZWx5LlxuICogSWYgREVWX1VTRVJfRU1BSUwgaXMgc2V0IGluIHRoZSBlbnZpcm9ubWVudCwgYW55IHJlcXVlc3QgZnJvbSB0aGF0XG4gKiBlbWFpbCBhZGRyZXNzIHdpbGwgYmUgdHJlYXRlZCBhcyBoYXZpbmcgYWxsIHBlcm1pc3Npb25zLiBUaGlzIGlzXG4gKiB1c2VmdWwgZm9yIGRldmVsb3BtZW50IGFuZCBhdXRvbWF0ZWQgdGVzdGluZy4gSW4gcHJvZHVjdGlvbiB5b3VcbiAqIHNob3VsZCBsZWF2ZSBERVZfVVNFUl9FTUFJTCB1bnNldC5cbiAqL1xuY29uc3QgREVWX1VTRVJfRU1BSUwgPSBwcm9jZXNzLmVudi5ERVZfVVNFUl9FTUFJTD8udG9Mb3dlckNhc2UoKSB8fCBudWxsO1xuXG4vKipcbiAqIEV4dHJhY3QgY3VycmVudCB1c2VyJ3MgZW1haWwgZnJvbSBjb29raWUgb3IgaGVhZGVyLlxuICogLSBDb29raWU6IG12X3VzZXI9PGVtYWlsPlxuICogLSBIZWFkZXI6IHgtbXYtdXNlcjogPGVtYWlsPiAgKHVzZWZ1bCBmb3Igc2NyaXB0cy90ZXN0cylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVtYWlsRnJvbVJlcShyZXE6IE5leHRBcGlSZXF1ZXN0KTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGZyb21Db29raWUgPSByZXEuY29va2llcz8ubXZfdXNlcjtcbiAgY29uc3QgZnJvbUhlYWRlciA9IChyZXEuaGVhZGVyc1tcIngtbXYtdXNlclwiXSB8fCByZXEuaGVhZGVyc1tcIngtbXZ1c2VyXCJdKSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIGNvbnN0IHJhdyA9IChBcnJheS5pc0FycmF5KGZyb21Db29raWUpID8gZnJvbUNvb2tpZVswXSA6IGZyb21Db29raWUpID8/IGZyb21IZWFkZXIgPz8gXCJcIjtcbiAgY29uc3QgZW1haWwgPSByYXc/LnRvU3RyaW5nKCkudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiBlbWFpbCB8fCBudWxsO1xufVxuXG4vKiogTG9vayB1cCBvcmdJZCBmb3IgY3VycmVudCB1c2VyICh1c2VkIHRvIHNjb3BlIHF1ZXJpZXMpLiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yZ0lkRnJvbVJlcShyZXE6IE5leHRBcGlSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gIGNvbnN0IGVtYWlsID0gZ2V0RW1haWxGcm9tUmVxKHJlcSk7XG4gIGlmICghZW1haWwpIHJldHVybiBudWxsO1xuXG4gIC8vIERldmVsb3BtZW50IGJ5cGFzczogaWYgdGhpcyBpcyB0aGUgZGV2IHVzZXIsIHJldHVybiBhIGZpeGVkIG9yZ0lkXG4gIC8vIGlmIHByb3ZpZGVkIHZpYSBERVZfT1JHX0lELCBvdGhlcndpc2UgZmFsbCB0aHJvdWdoIHRvIERCIGxvb2t1cC5cbiAgaWYgKERFVl9VU0VSX0VNQUlMICYmIGVtYWlsID09PSBERVZfVVNFUl9FTUFJTCkge1xuICAgIC8vIFVzZSBERVZfT1JHX0lEIGlmIHByb3ZpZGVkLCBlbHNlIG51bGwgdG8gaW5kaWNhdGUgbm8gb3JnXG4gICAgY29uc3QgZGV2T3JnID0gcHJvY2Vzcy5lbnYuREVWX09SR19JRDtcbiAgICBpZiAoZGV2T3JnKSByZXR1cm4gZGV2T3JnO1xuICAgIC8vIEFzIGEgZmFsbGJhY2ssIGF0dGVtcHQgdG8gZmV0Y2ggdGhlIGZpcnN0IG9yZyBmcm9tIHRoZSBkYXRhYmFzZVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaXJzdE9yZyA9IGF3YWl0IGRiLm9yZy5maW5kRmlyc3QoeyBzZWxlY3Q6IHsgaWQ6IHRydWUgfSB9KTtcbiAgICAgIHJldHVybiBmaXJzdE9yZz8uaWQgPz8gbnVsbDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuICBjb25zdCB1ID0gYXdhaXQgZGIudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgZW1haWwgfSwgc2VsZWN0OiB7IG9yZ0lkOiB0cnVlIH0gfSk7XG4gIHJldHVybiB1Py5vcmdJZCA/PyBudWxsO1xufVxuXG4vKipcbiAqIEZldGNoIHVzZXIncyBlZmZlY3RpdmUgcGVybWlzc2lvbnMgZnJvbSBSQkFDIHRhYmxlcy5cbiAqIEZhbGxzIGJhY2sgdG8gbGVnYWN5IFVzZXIucm9sZSBmb3IgT1dORVIvTUFOQUdFUi9TVEFGRiBjb252ZW5pZW5jZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclBlcm1Db2Rlcyh1c2VySWQ6IHN0cmluZywgbGVnYWN5Um9sZT86IHN0cmluZyB8IG51bGwpOiBQcm9taXNlPFNldDxzdHJpbmc+PiB7XG4gIGNvbnN0IHJvbGVMaW5rcyA9IGF3YWl0IGRiLnJiYWNVc2VyUm9sZS5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgc2VsZWN0OiB7IHJvbGVJZDogdHJ1ZSB9LFxuICB9KTtcblxuICBjb25zdCByb2xlSWRzID0gcm9sZUxpbmtzLm1hcCgocikgPT4gci5yb2xlSWQpO1xuICBjb25zdCBwZXJtcyA9IHJvbGVJZHMubGVuZ3RoXG4gICAgPyBhd2FpdCBkYi5yYmFjUm9sZVBlcm1pc3Npb24uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyByb2xlSWQ6IHsgaW46IHJvbGVJZHMgfSB9LFxuICAgICAgICBpbmNsdWRlOiB7IHBlcm1pc3Npb246IHRydWUgfSxcbiAgICAgIH0pXG4gICAgOiBbXTtcblxuICBjb25zdCBjb2RlcyA9IG5ldyBTZXQ8c3RyaW5nPihwZXJtcy5tYXAoKHJwKSA9PiBycC5wZXJtaXNzaW9uLmNvZGUpKTtcblxuICAvLyBMZWdhY3kgcm9sZSBjb252ZW5pZW5jZSAobm9uLWJsb2NraW5nKTogZ2l2ZSBzZW5zaWJsZSBkZWZhdWx0c1xuICBzd2l0Y2ggKChsZWdhY3lSb2xlIHx8IFwiXCIpLnRvVXBwZXJDYXNlKCkpIHtcbiAgICBjYXNlIFwiT1dORVJcIjpcbiAgICAgIFtQRVJNUy5EQVNIQk9BUkRfVklFVywgUEVSTVMuTEVBRF9SRUFELCBQRVJNUy5MRUFEX0NSRUFURSwgUEVSTVMuTEVBRF9VUERBVEUsIFBFUk1TLkxFQURfREVMRVRFLCBQRVJNUy5MRUFEX0VYUE9SVCwgUEVSTVMuUk9MRVNfTUFOQUdFLCBQRVJNUy5CSUxMSU5HX01BTkFHRV0uZm9yRWFjaChjID0+IGNvZGVzLmFkZChjKSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiTUFOQUdFUlwiOlxuICAgICAgW1BFUk1TLkRBU0hCT0FSRF9WSUVXLCBQRVJNUy5MRUFEX1JFQUQsIFBFUk1TLkxFQURfQ1JFQVRFLCBQRVJNUy5MRUFEX1VQREFURSwgUEVSTVMuTEVBRF9ERUxFVEUsIFBFUk1TLkxFQURfRVhQT1JUXS5mb3JFYWNoKGMgPT4gY29kZXMuYWRkKGMpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJTVEFGRlwiOlxuICAgICAgW1BFUk1TLkRBU0hCT0FSRF9WSUVXLCBQRVJNUy5MRUFEX1JFQUQsIFBFUk1TLkxFQURfQ1JFQVRFLCBQRVJNUy5MRUFEX1VQREFURV0uZm9yRWFjaChjID0+IGNvZGVzLmFkZChjKSk7XG4gICAgICBicmVhaztcbiAgfVxuXG4gIHJldHVybiBjb2Rlcztcbn1cblxuLyoqXG4gKiBBc3NlcnQgdGhhdCBjdXJyZW50IHJlcXVlc3QgaXMgZnJvbSBhbiBhdXRoZW50aWNhdGVkIHVzZXIgd2l0aCBhIGdpdmVuIHBlcm1pc3Npb24uXG4gKiBXcml0ZXMgNDAxLzQwMyB0byByZXMgaWYgbm90IGFsbG93ZWQuIFJldHVybnMgdHJ1ZSBpZiBhbGxvd2VkLCBmYWxzZSBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhc3NlcnRQZXJtaXNzaW9uKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZSxcbiAgcmVxdWlyZWQ6IFBlcm1Db2RlXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBlbWFpbCA9IGdldEVtYWlsRnJvbVJlcShyZXEpO1xuICAgIGlmICghZW1haWwpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBEZXZlbG9wbWVudCBieXBhc3M6IGlmIHRoZSBpbmNvbWluZyBlbWFpbCBtYXRjaGVzIHRoZSBERVZfVVNFUl9FTUFJTFxuICAgIC8vIHRoZW4gc2tpcCBhbnkgZGF0YWJhc2UgbG9va3VwcyBhbmQgYWxsb3cgdGhlIHJlcXVlc3QuIFRoaXMgcGVybWl0c1xuICAgIC8vIGF1dG9tYXRlZCB0ZXN0cyBhbmQgZGV2ZWxvcG1lbnQgc2Vzc2lvbnMgdG8gZXhlcmNpc2UgYW55IEFQSVxuICAgIC8vIHJlZ2FyZGxlc3Mgb2YgdGhlIHVzZXIncyBwZXJzaXN0ZWQgcm9sZSBvciBwZXJtaXNzaW9ucy4gSWYgbm9cbiAgICAvLyBERVZfVVNFUl9FTUFJTCBpcyBjb25maWd1cmVkLCB0aGlzIGJsb2NrIGhhcyBubyBlZmZlY3QuXG4gICAgaWYgKERFVl9VU0VSX0VNQUlMICYmIGVtYWlsID09PSBERVZfVVNFUl9FTUFJTCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBlbWFpbCB9LFxuICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCByb2xlOiB0cnVlIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCBjb2RlcyA9IGF3YWl0IGdldFVzZXJQZXJtQ29kZXModXNlci5pZCwgdXNlci5yb2xlKTtcbiAgICBpZiAoIWNvZGVzLmhhcyhyZXF1aXJlZCkpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJGb3JiaWRkZW5cIiB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICBjb25zb2xlLmVycm9yKFwiYXNzZXJ0UGVybWlzc2lvbiBlcnJvcjpcIiwgZSk7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIkludGVybmFsIFNlcnZlciBFcnJvclwiIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImRiIiwiUEVSTVMiLCJEQVNIQk9BUkRfVklFVyIsIkxFQURfUkVBRCIsIkxFQURfQ1JFQVRFIiwiTEVBRF9VUERBVEUiLCJMRUFEX0RFTEVURSIsIkxFQURfRVhQT1JUIiwiUk9MRVNfTUFOQUdFIiwiQklMTElOR19NQU5BR0UiLCJERVZfVVNFUl9FTUFJTCIsInByb2Nlc3MiLCJlbnYiLCJ0b0xvd2VyQ2FzZSIsImdldEVtYWlsRnJvbVJlcSIsInJlcSIsImZyb21Db29raWUiLCJjb29raWVzIiwibXZfdXNlciIsImZyb21IZWFkZXIiLCJoZWFkZXJzIiwicmF3IiwiQXJyYXkiLCJpc0FycmF5IiwiZW1haWwiLCJ0b1N0cmluZyIsInRyaW0iLCJnZXRPcmdJZEZyb21SZXEiLCJkZXZPcmciLCJERVZfT1JHX0lEIiwiZmlyc3RPcmciLCJvcmciLCJmaW5kRmlyc3QiLCJzZWxlY3QiLCJpZCIsInUiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwib3JnSWQiLCJnZXRVc2VyUGVybUNvZGVzIiwidXNlcklkIiwibGVnYWN5Um9sZSIsInJvbGVMaW5rcyIsInJiYWNVc2VyUm9sZSIsImZpbmRNYW55Iiwicm9sZUlkIiwicm9sZUlkcyIsIm1hcCIsInIiLCJwZXJtcyIsImxlbmd0aCIsInJiYWNSb2xlUGVybWlzc2lvbiIsImluIiwiaW5jbHVkZSIsInBlcm1pc3Npb24iLCJjb2RlcyIsIlNldCIsInJwIiwiY29kZSIsInRvVXBwZXJDYXNlIiwiZm9yRWFjaCIsImMiLCJhZGQiLCJhc3NlcnRQZXJtaXNzaW9uIiwicmVzIiwicmVxdWlyZWQiLCJzdGF0dXMiLCJqc29uIiwib2siLCJlcnJvciIsInJvbGUiLCJoYXMiLCJlIiwiY29uc29sZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/rbac.ts\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/provider/analytics.ts":
/*!*********************************************!*\
  !*** ./src/pages/api/provider/analytics.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(api-node)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_rbac__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/rbac */ \"(api-node)/./src/lib/rbac.ts\");\n// src/pages/api/provider/analytics.ts\n\n\n// Ensure only providers can access this endpoint\nasync function ensureProvider(req, res) {\n    const email = (0,_lib_rbac__WEBPACK_IMPORTED_MODULE_1__.getEmailFromReq)(req);\n    if (!email) {\n        res.status(401).json({\n            ok: false,\n            error: \"Unauthorized\"\n        });\n        return null;\n    }\n    const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email\n        },\n        select: {\n            id: true,\n            role: true\n        }\n    });\n    if (!user || user.role !== 'PROVIDER') {\n        res.status(403).json({\n            ok: false,\n            error: \"Provider access required\"\n        });\n        return null;\n    }\n    return user;\n}\nfunction getDateRange(range) {\n    const now = new Date();\n    let startDate;\n    switch(range){\n        case '30d':\n            startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n            break;\n        case '90d':\n            startDate = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);\n            break;\n        case '6m':\n            startDate = new Date(now.getFullYear(), now.getMonth() - 6, 1);\n            break;\n        case '1y':\n            startDate = new Date(now.getFullYear() - 1, now.getMonth(), 1);\n            break;\n        default:\n            startDate = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);\n    }\n    return {\n        startDate,\n        endDate: now\n    };\n}\nasync function handler(req, res) {\n    try {\n        if (req.method !== 'GET') {\n            res.setHeader('Allow', 'GET');\n            return res.status(405).json({\n                ok: false,\n                error: 'Method not allowed'\n            });\n        }\n        const user = await ensureProvider(req, res);\n        if (!user) return;\n        const range = req.query.range || '90d';\n        const { startDate, endDate } = getDateRange(range);\n        // Overview metrics\n        const totalLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                createdAt: {\n                    gte: startDate,\n                    lte: endDate\n                }\n            }\n        });\n        const convertedLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                convertedAt: {\n                    not: null,\n                    gte: startDate,\n                    lte: endDate\n                },\n                enrichmentJson: {\n                    path: [\n                        'billing',\n                        'billableEligible'\n                    ],\n                    equals: true\n                }\n            }\n        });\n        const conversionRate = totalLeads > 0 ? convertedLeads / totalLeads * 100 : 0;\n        const totalRevenue = convertedLeads * 100;\n        // Get client count for average calculation\n        const clientCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.org.count();\n        const averageRevenuePerClient = clientCount > 0 ? totalRevenue / clientCount : 0;\n        // Calculate growth rate (compare to previous period)\n        const periodLength = endDate.getTime() - startDate.getTime();\n        const previousStartDate = new Date(startDate.getTime() - periodLength);\n        const previousConvertedLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                convertedAt: {\n                    not: null,\n                    gte: previousStartDate,\n                    lt: startDate\n                },\n                enrichmentJson: {\n                    path: [\n                        'billing',\n                        'billableEligible'\n                    ],\n                    equals: true\n                }\n            }\n        });\n        const previousRevenue = previousConvertedLeads * 100;\n        const growthRate = previousRevenue > 0 ? (totalRevenue - previousRevenue) / previousRevenue * 100 : 0;\n        // Monthly breakdown - get last 6 months\n        const monthlyData = [];\n        for(let i = 5; i >= 0; i--){\n            const monthStart = new Date(endDate.getFullYear(), endDate.getMonth() - i, 1);\n            const monthEnd = new Date(endDate.getFullYear(), endDate.getMonth() - i + 1, 0, 23, 59, 59);\n            const monthLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    createdAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    }\n                }\n            });\n            const monthConversions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    convertedAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    },\n                    enrichmentJson: {\n                        path: [\n                            'billing',\n                            'billableEligible'\n                        ],\n                        equals: true\n                    }\n                }\n            });\n            const monthRevenue = monthConversions * 100;\n            // AI cost calculation with configurable limit\n            // TODO: Replace with actual AI usage tracking from aiMeter system\n            const estimatedAiCost = monthLeads * 0.02 + monthConversions * 0.1;\n            const maxAiCostPerMonth = 50; // Default limit - should come from provider settings\n            const aiCost = Math.min(estimatedAiCost, maxAiCostPerMonth);\n            const profit = monthRevenue - aiCost;\n            monthlyData.push({\n                month: monthStart.toISOString(),\n                leads: monthLeads,\n                conversions: monthConversions,\n                revenue: monthRevenue,\n                aiCost,\n                profit\n            });\n        }\n        // Client performance - get top performing clients in the period\n        const orgs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.org.findMany({\n            select: {\n                id: true,\n                name: true\n            }\n        });\n        const clientPerformance = await Promise.all(orgs.map(async (org)=>{\n            const leads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    orgId: org.id,\n                    createdAt: {\n                        gte: startDate,\n                        lte: endDate\n                    }\n                }\n            });\n            const conversions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    orgId: org.id,\n                    convertedAt: {\n                        gte: startDate,\n                        lte: endDate\n                    },\n                    enrichmentJson: {\n                        path: [\n                            'billing',\n                            'billableEligible'\n                        ],\n                        equals: true\n                    }\n                }\n            });\n            const revenue = conversions * 100;\n            const conversionRate = leads > 0 ? conversions / leads * 100 : 0;\n            // Calculate growth vs previous period for this client\n            const previousConversions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    orgId: org.id,\n                    convertedAt: {\n                        gte: previousStartDate,\n                        lt: startDate\n                    },\n                    enrichmentJson: {\n                        path: [\n                            'billing',\n                            'billableEligible'\n                        ],\n                        equals: true\n                    }\n                }\n            });\n            const previousClientRevenue = previousConversions * 100;\n            const growth = previousClientRevenue > 0 ? (revenue - previousClientRevenue) / previousClientRevenue * 100 : 0;\n            return {\n                clientId: org.id,\n                clientName: org.name,\n                leads,\n                conversions,\n                revenue,\n                conversionRate,\n                growth\n            };\n        }));\n        // Sort by revenue and take top performers\n        clientPerformance.sort((a, b)=>b.revenue - a.revenue);\n        // Source breakdown - analyze lead sources\n        const allLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.findMany({\n            where: {\n                createdAt: {\n                    gte: startDate,\n                    lte: endDate\n                }\n            },\n            select: {\n                sourceType: true,\n                convertedAt: true,\n                enrichmentJson: true\n            }\n        });\n        const sourceStats = new Map();\n        allLeads.forEach((lead)=>{\n            const source = lead.sourceType || 'Unknown';\n            if (!sourceStats.has(source)) {\n                sourceStats.set(source, {\n                    leads: 0,\n                    conversions: 0,\n                    revenue: 0\n                });\n            }\n            const stats = sourceStats.get(source);\n            stats.leads++;\n            if (lead.convertedAt && lead.enrichmentJson && lead.enrichmentJson?.billing?.billableEligible) {\n                stats.conversions++;\n                stats.revenue += 100;\n            }\n        });\n        const sourceBreakdown = Array.from(sourceStats.entries()).map(([source, stats])=>({\n                source,\n                leads: stats.leads,\n                conversions: stats.conversions,\n                revenue: stats.revenue,\n                percentage: totalLeads > 0 ? stats.leads / totalLeads * 100 : 0\n            })).sort((a, b)=>b.revenue - a.revenue);\n        const analyticsData = {\n            overview: {\n                totalLeads,\n                convertedLeads,\n                conversionRate,\n                totalRevenue,\n                averageRevenuePerClient,\n                growthRate\n            },\n            monthly: monthlyData,\n            clientPerformance: clientPerformance.slice(0, 10),\n            sourceBreakdown: sourceBreakdown.slice(0, 10) // Top 10 sources\n        };\n        return res.status(200).json({\n            ok: true,\n            data: analyticsData\n        });\n    } catch (error) {\n        console.error('Provider analytics error:', error);\n        return res.status(500).json({\n            ok: false,\n            error: error.message || 'Failed to fetch analytics data'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvcHJvdmlkZXIvYW5hbHl0aWNzLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHNDQUFzQztBQUVNO0FBQ0M7QUFFN0MsaURBQWlEO0FBQ2pELGVBQWVHLGVBQWVDLEdBQW1CLEVBQUVDLEdBQW9CO0lBQ3JFLE1BQU1DLFFBQVFKLDBEQUFlQSxDQUFDRTtJQUM5QixJQUFJLENBQUNFLE9BQU87UUFDVkQsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxJQUFJO1lBQU9DLE9BQU87UUFBZTtRQUN4RCxPQUFPO0lBQ1Q7SUFFQSxNQUFNQyxPQUFPLE1BQU1WLCtDQUFFQSxDQUFDVSxJQUFJLENBQUNDLFVBQVUsQ0FBQztRQUNwQ0MsT0FBTztZQUFFUDtRQUFNO1FBQ2ZRLFFBQVE7WUFBRUMsSUFBSTtZQUFNQyxNQUFNO1FBQUs7SUFDakM7SUFFQSxJQUFJLENBQUNMLFFBQVFBLEtBQUtLLElBQUksS0FBSyxZQUFZO1FBQ3JDWCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBT0MsT0FBTztRQUEyQjtRQUNwRSxPQUFPO0lBQ1Q7SUFFQSxPQUFPQztBQUNUO0FBRUEsU0FBU00sYUFBYUMsS0FBYTtJQUNqQyxNQUFNQyxNQUFNLElBQUlDO0lBQ2hCLElBQUlDO0lBRUosT0FBUUg7UUFDTixLQUFLO1lBQ0hHLFlBQVksSUFBSUQsS0FBS0QsSUFBSUcsT0FBTyxLQUFLLEtBQUssS0FBSyxLQUFLLEtBQUs7WUFDekQ7UUFDRixLQUFLO1lBQ0hELFlBQVksSUFBSUQsS0FBS0QsSUFBSUcsT0FBTyxLQUFLLEtBQUssS0FBSyxLQUFLLEtBQUs7WUFDekQ7UUFDRixLQUFLO1lBQ0hELFlBQVksSUFBSUQsS0FBS0QsSUFBSUksV0FBVyxJQUFJSixJQUFJSyxRQUFRLEtBQUssR0FBRztZQUM1RDtRQUNGLEtBQUs7WUFDSEgsWUFBWSxJQUFJRCxLQUFLRCxJQUFJSSxXQUFXLEtB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LEtBQUssQ0FBQyxHQUFHLElBQUksaUJBQWlCO1FBQ2pFO1FBRUEsT0FBT3ZHLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLElBQUk7WUFDSm9HLE1BQU1KO1FBQ1I7SUFFRixFQUFFLE9BQU8vRixPQUFZO1FBQ25Cb0csUUFBUXBHLEtBQUssQ0FBQyw2QkFBNkJBO1FBQzNDLE9BQU9MLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLElBQUk7WUFDSkMsT0FBT0EsTUFBTXFHLE9BQU8sSUFBSTtRQUMxQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL3BhZ2VzL2FwaS9wcm92aWRlci9hbmFseXRpY3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3BhZ2VzL2FwaS9wcm92aWRlci9hbmFseXRpY3MudHNcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgeyBwcmlzbWEgYXMgZGIgfSBmcm9tIFwiQC9saWIvcHJpc21hXCI7XG5pbXBvcnQgeyBnZXRFbWFpbEZyb21SZXEgfSBmcm9tIFwiQC9saWIvcmJhY1wiO1xuXG4vLyBFbnN1cmUgb25seSBwcm92aWRlcnMgY2FuIGFjY2VzcyB0aGlzIGVuZHBvaW50XG5hc3luYyBmdW5jdGlvbiBlbnN1cmVQcm92aWRlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCBlbWFpbCA9IGdldEVtYWlsRnJvbVJlcShyZXEpO1xuICBpZiAoIWVtYWlsKSB7XG4gICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0pO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgZW1haWwgfSxcbiAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIHJvbGU6IHRydWUgfSxcbiAgfSk7XG5cbiAgaWYgKCF1c2VyIHx8IHVzZXIucm9sZSAhPT0gJ1BST1ZJREVSJykge1xuICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJQcm92aWRlciBhY2Nlc3MgcmVxdWlyZWRcIiB9KTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiB1c2VyO1xufVxuXG5mdW5jdGlvbiBnZXREYXRlUmFuZ2UocmFuZ2U6IHN0cmluZykge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBsZXQgc3RhcnREYXRlOiBEYXRlO1xuXG4gIHN3aXRjaCAocmFuZ2UpIHtcbiAgICBjYXNlICczMGQnOlxuICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICc5MGQnOlxuICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIDkwICogMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICc2bSc6XG4gICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCkgLSA2LCAxKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJzF5JzpcbiAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpIC0gMSwgbm93LmdldE1vbnRoKCksIDEpO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSA5MCAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICB9XG5cbiAgcmV0dXJuIHsgc3RhcnREYXRlLCBlbmREYXRlOiBub3cgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICB0cnkge1xuICAgIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xuICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCAnR0VUJyk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZW5zdXJlUHJvdmlkZXIocmVxLCByZXMpO1xuICAgIGlmICghdXNlcikgcmV0dXJuO1xuXG4gICAgY29uc3QgcmFuZ2UgPSByZXEucXVlcnkucmFuZ2UgYXMgc3RyaW5nIHx8ICc5MGQnO1xuICAgIGNvbnN0IHsgc3RhcnREYXRlLCBlbmREYXRlIH0gPSBnZXREYXRlUmFuZ2UocmFuZ2UpO1xuXG4gICAgLy8gT3ZlcnZpZXcgbWV0cmljc1xuICAgIGNvbnN0IHRvdGFsTGVhZHMgPSBhd2FpdCBkYi5sZWFkLmNvdW50KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIGd0ZTogc3RhcnREYXRlLFxuICAgICAgICAgIGx0ZTogZW5kRGF0ZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBjb252ZXJ0ZWRMZWFkcyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgY29udmVydGVkQXQ6IHsgXG4gICAgICAgICAgbm90OiBudWxsLFxuICAgICAgICAgIGd0ZTogc3RhcnREYXRlLFxuICAgICAgICAgIGx0ZTogZW5kRGF0ZVxuICAgICAgICB9LFxuICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdiaWxsYWJsZUVsaWdpYmxlJ10sXG4gICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbnZlcnNpb25SYXRlID0gdG90YWxMZWFkcyA+IDAgPyAoY29udmVydGVkTGVhZHMgLyB0b3RhbExlYWRzKSAqIDEwMCA6IDA7XG4gICAgY29uc3QgdG90YWxSZXZlbnVlID0gY29udmVydGVkTGVhZHMgKiAxMDA7XG5cbiAgICAvLyBHZXQgY2xpZW50IGNvdW50IGZvciBhdmVyYWdlIGNhbGN1bGF0aW9uXG4gICAgY29uc3QgY2xpZW50Q291bnQgPSBhd2FpdCBkYi5vcmcuY291bnQoKTtcbiAgICBjb25zdCBhdmVyYWdlUmV2ZW51ZVBlckNsaWVudCA9IGNsaWVudENvdW50ID4gMCA/IHRvdGFsUmV2ZW51ZSAvIGNsaWVudENvdW50IDogMDtcblxuICAgIC8vIENhbGN1bGF0ZSBncm93dGggcmF0ZSAoY29tcGFyZSB0byBwcmV2aW91cyBwZXJpb2QpXG4gICAgY29uc3QgcGVyaW9kTGVuZ3RoID0gZW5kRGF0ZS5nZXRUaW1lKCkgLSBzdGFydERhdGUuZ2V0VGltZSgpO1xuICAgIGNvbnN0IHByZXZpb3VzU3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlLmdldFRpbWUoKSAtIHBlcmlvZExlbmd0aCk7XG4gICAgXG4gICAgY29uc3QgcHJldmlvdXNDb252ZXJ0ZWRMZWFkcyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgY29udmVydGVkQXQ6IHsgXG4gICAgICAgICAgbm90OiBudWxsLFxuICAgICAgICAgIGd0ZTogcHJldmlvdXNTdGFydERhdGUsXG4gICAgICAgICAgbHQ6IHN0YXJ0RGF0ZVxuICAgICAgICB9LFxuICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdiaWxsYWJsZUVsaWdpYmxlJ10sXG4gICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHByZXZpb3VzUmV2ZW51ZSA9IHByZXZpb3VzQ29udmVydGVkTGVhZHMgKiAxMDA7XG4gICAgY29uc3QgZ3Jvd3RoUmF0ZSA9IHByZXZpb3VzUmV2ZW51ZSA+IDAgPyAoKHRvdGFsUmV2ZW51ZSAtIHByZXZpb3VzUmV2ZW51ZSkgLyBwcmV2aW91c1JldmVudWUpICogMTAwIDogMDtcblxuICAgIC8vIE1vbnRobHkgYnJlYWtkb3duIC0gZ2V0IGxhc3QgNiBtb250aHNcbiAgICBjb25zdCBtb250aGx5RGF0YSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSA1OyBpID49IDA7IGktLSkge1xuICAgICAgY29uc3QgbW9udGhTdGFydCA9IG5ldyBEYXRlKGVuZERhdGUuZ2V0RnVsbFllYXIoKSwgZW5kRGF0ZS5nZXRNb250aCgpIC0gaSwgMSk7XG4gICAgICBjb25zdCBtb250aEVuZCA9IG5ldyBEYXRlKGVuZERhdGUuZ2V0RnVsbFllYXIoKSwgZW5kRGF0ZS5nZXRNb250aCgpIC0gaSArIDEsIDAsIDIzLCA1OSwgNTkpO1xuXG4gICAgICBjb25zdCBtb250aExlYWRzID0gYXdhaXQgZGIubGVhZC5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICBndGU6IG1vbnRoU3RhcnQsXG4gICAgICAgICAgICBsdGU6IG1vbnRoRW5kXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbW9udGhDb252ZXJzaW9ucyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGNvbnZlcnRlZEF0OiB7XG4gICAgICAgICAgICBndGU6IG1vbnRoU3RhcnQsXG4gICAgICAgICAgICBsdGU6IG1vbnRoRW5kXG4gICAgICAgICAgfSxcbiAgICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2JpbGxhYmxlRWxpZ2libGUnXSxcbiAgICAgICAgICAgIGVxdWFsczogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vbnRoUmV2ZW51ZSA9IG1vbnRoQ29udmVyc2lvbnMgKiAxMDA7XG4gICAgICAvLyBBSSBjb3N0IGNhbGN1bGF0aW9uIHdpdGggY29uZmlndXJhYmxlIGxpbWl0XG4gICAgICAvLyBUT0RPOiBSZXBsYWNlIHdpdGggYWN0dWFsIEFJIHVzYWdlIHRyYWNraW5nIGZyb20gYWlNZXRlciBzeXN0ZW1cbiAgICAgIGNvbnN0IGVzdGltYXRlZEFpQ29zdCA9IG1vbnRoTGVhZHMgKiAwLjAyICsgbW9udGhDb252ZXJzaW9ucyAqIDAuMTtcbiAgICAgIGNvbnN0IG1heEFpQ29zdFBlck1vbnRoID0gNTA7IC8vIERlZmF1bHQgbGltaXQgLSBzaG91bGQgY29tZSBmcm9tIHByb3ZpZGVyIHNldHRpbmdzXG4gICAgICBjb25zdCBhaUNvc3QgPSBNYXRoLm1pbihlc3RpbWF0ZWRBaUNvc3QsIG1heEFpQ29zdFBlck1vbnRoKTtcbiAgICAgIGNvbnN0IHByb2ZpdCA9IG1vbnRoUmV2ZW51ZSAtIGFpQ29zdDtcblxuICAgICAgbW9udGhseURhdGEucHVzaCh7XG4gICAgICAgIG1vbnRoOiBtb250aFN0YXJ0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGxlYWRzOiBtb250aExlYWRzLFxuICAgICAgICBjb252ZXJzaW9uczogbW9udGhDb252ZXJzaW9ucyxcbiAgICAgICAgcmV2ZW51ZTogbW9udGhSZXZlbnVlLFxuICAgICAgICBhaUNvc3QsXG4gICAgICAgIHByb2ZpdFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2xpZW50IHBlcmZvcm1hbmNlIC0gZ2V0IHRvcCBwZXJmb3JtaW5nIGNsaWVudHMgaW4gdGhlIHBlcmlvZFxuICAgIGNvbnN0IG9yZ3MgPSBhd2FpdCBkYi5vcmcuZmluZE1hbnkoe1xuICAgICAgc2VsZWN0OiB7XG4gICAgICAgIGlkOiB0cnVlLFxuICAgICAgICBuYW1lOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBjbGllbnRQZXJmb3JtYW5jZSA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgb3Jncy5tYXAoYXN5bmMgKG9yZykgPT4ge1xuICAgICAgICBjb25zdCBsZWFkcyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICBvcmdJZDogb3JnLmlkLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgIGd0ZTogc3RhcnREYXRlLFxuICAgICAgICAgICAgICBsdGU6IGVuZERhdGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGNvbnZlcnNpb25zID0gYXdhaXQgZGIubGVhZC5jb3VudCh7XG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIG9yZ0lkOiBvcmcuaWQsXG4gICAgICAgICAgICBjb252ZXJ0ZWRBdDoge1xuICAgICAgICAgICAgICBndGU6IHN0YXJ0RGF0ZSxcbiAgICAgICAgICAgICAgbHRlOiBlbmREYXRlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5yaWNobWVudEpzb246IHtcbiAgICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2JpbGxhYmxlRWxpZ2libGUnXSxcbiAgICAgICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXZlbnVlID0gY29udmVyc2lvbnMgKiAxMDA7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNpb25SYXRlID0gbGVhZHMgPiAwID8gKGNvbnZlcnNpb25zIC8gbGVhZHMpICogMTAwIDogMDtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgZ3Jvd3RoIHZzIHByZXZpb3VzIHBlcmlvZCBmb3IgdGhpcyBjbGllbnRcbiAgICAgICAgY29uc3QgcHJldmlvdXNDb252ZXJzaW9ucyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICBvcmdJZDogb3JnLmlkLFxuICAgICAgICAgICAgY29udmVydGVkQXQ6IHtcbiAgICAgICAgICAgICAgZ3RlOiBwcmV2aW91c1N0YXJ0RGF0ZSxcbiAgICAgICAgICAgICAgbHQ6IHN0YXJ0RGF0ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdiaWxsYWJsZUVsaWdpYmxlJ10sXG4gICAgICAgICAgICAgIGVxdWFsczogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcHJldmlvdXNDbGllbnRSZXZlbnVlID0gcHJldmlvdXNDb252ZXJzaW9ucyAqIDEwMDtcbiAgICAgICAgY29uc3QgZ3Jvd3RoID0gcHJldmlvdXNDbGllbnRSZXZlbnVlID4gMCA/ICgocmV2ZW51ZSAtIHByZXZpb3VzQ2xpZW50UmV2ZW51ZSkgLyBwcmV2aW91c0NsaWVudFJldmVudWUpICogMTAwIDogMDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNsaWVudElkOiBvcmcuaWQsXG4gICAgICAgICAgY2xpZW50TmFtZTogb3JnLm5hbWUsXG4gICAgICAgICAgbGVhZHMsXG4gICAgICAgICAgY29udmVyc2lvbnMsXG4gICAgICAgICAgcmV2ZW51ZSxcbiAgICAgICAgICBjb252ZXJzaW9uUmF0ZSxcbiAgICAgICAgICBncm93dGhcbiAgICAgICAgfTtcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIC8vIFNvcnQgYnkgcmV2ZW51ZSBhbmQgdGFrZSB0b3AgcGVyZm9ybWVyc1xuICAgIGNsaWVudFBlcmZvcm1hbmNlLnNvcnQoKGEsIGIpID0+IGIucmV2ZW51ZSAtIGEucmV2ZW51ZSk7XG5cbiAgICAvLyBTb3VyY2UgYnJlYWtkb3duIC0gYW5hbHl6ZSBsZWFkIHNvdXJjZXNcbiAgICBjb25zdCBhbGxMZWFkcyA9IGF3YWl0IGRiLmxlYWQuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgZ3RlOiBzdGFydERhdGUsXG4gICAgICAgICAgbHRlOiBlbmREYXRlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzZWxlY3Q6IHtcbiAgICAgICAgc291cmNlVHlwZTogdHJ1ZSxcbiAgICAgICAgY29udmVydGVkQXQ6IHRydWUsXG4gICAgICAgIGVucmljaG1lbnRKc29uOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBzb3VyY2VTdGF0cyA9IG5ldyBNYXA8c3RyaW5nLCB7XG4gICAgICBsZWFkczogbnVtYmVyO1xuICAgICAgY29udmVyc2lvbnM6IG51bWJlcjtcbiAgICAgIHJldmVudWU6IG51bWJlcjtcbiAgICB9PigpO1xuXG4gICAgYWxsTGVhZHMuZm9yRWFjaChsZWFkID0+IHtcbiAgICAgIGNvbnN0IHNvdXJjZSA9IGxlYWQuc291cmNlVHlwZSB8fCAnVW5rbm93bic7XG4gICAgICBpZiAoIXNvdXJjZVN0YXRzLmhhcyhzb3VyY2UpKSB7XG4gICAgICAgIHNvdXJjZVN0YXRzLnNldChzb3VyY2UsIHsgbGVhZHM6IDAsIGNvbnZlcnNpb25zOiAwLCByZXZlbnVlOiAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzdGF0cyA9IHNvdXJjZVN0YXRzLmdldChzb3VyY2UpITtcbiAgICAgIHN0YXRzLmxlYWRzKys7XG5cbiAgICAgIGlmIChsZWFkLmNvbnZlcnRlZEF0ICYmIGxlYWQuZW5yaWNobWVudEpzb24gJiYgXG4gICAgICAgICAgKGxlYWQuZW5yaWNobWVudEpzb24gYXMgYW55KT8uYmlsbGluZz8uYmlsbGFibGVFbGlnaWJsZSkge1xuICAgICAgICBzdGF0cy5jb252ZXJzaW9ucysrO1xuICAgICAgICBzdGF0cy5yZXZlbnVlICs9IDEwMDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHNvdXJjZUJyZWFrZG93biA9IEFycmF5LmZyb20oc291cmNlU3RhdHMuZW50cmllcygpKS5tYXAoKFtzb3VyY2UsIHN0YXRzXSkgPT4gKHtcbiAgICAgIHNvdXJjZSxcbiAgICAgIGxlYWRzOiBzdGF0cy5sZWFkcyxcbiAgICAgIGNvbnZlcnNpb25zOiBzdGF0cy5jb252ZXJzaW9ucyxcbiAgICAgIHJldmVudWU6IHN0YXRzLnJldmVudWUsXG4gICAgICBwZXJjZW50YWdlOiB0b3RhbExlYWRzID4gMCA/IChzdGF0cy5sZWFkcyAvIHRvdGFsTGVhZHMpICogMTAwIDogMFxuICAgIH0pKS5zb3J0KChhLCBiKSA9PiBiLnJldmVudWUgLSBhLnJldmVudWUpO1xuXG4gICAgY29uc3QgYW5hbHl0aWNzRGF0YSA9IHtcbiAgICAgIG92ZXJ2aWV3OiB7XG4gICAgICAgIHRvdGFsTGVhZHMsXG4gICAgICAgIGNvbnZlcnRlZExlYWRzLFxuICAgICAgICBjb252ZXJzaW9uUmF0ZSxcbiAgICAgICAgdG90YWxSZXZlbnVlLFxuICAgICAgICBhdmVyYWdlUmV2ZW51ZVBlckNsaWVudCxcbiAgICAgICAgZ3Jvd3RoUmF0ZVxuICAgICAgfSxcbiAgICAgIG1vbnRobHk6IG1vbnRobHlEYXRhLFxuICAgICAgY2xpZW50UGVyZm9ybWFuY2U6IGNsaWVudFBlcmZvcm1hbmNlLnNsaWNlKDAsIDEwKSwgLy8gVG9wIDEwIGNsaWVudHNcbiAgICAgIHNvdXJjZUJyZWFrZG93bjogc291cmNlQnJlYWtkb3duLnNsaWNlKDAsIDEwKSAvLyBUb3AgMTAgc291cmNlc1xuICAgIH07XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBkYXRhOiBhbmFseXRpY3NEYXRhXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1Byb3ZpZGVyIGFuYWx5dGljcyBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBvazogZmFsc2UsIFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBmZXRjaCBhbmFseXRpY3MgZGF0YScgXG4gICAgfSk7XG4gIH1cbn0iXSwibmFtZXMiOlsicHJpc21hIiwiZGIiLCJnZXRFbWFpbEZyb21SZXEiLCJlbnN1cmVQcm92aWRlciIsInJlcSIsInJlcyIsImVtYWlsIiwic3RhdHVzIiwianNvbiIsIm9rIiwiZXJyb3IiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwic2VsZWN0IiwiaWQiLCJyb2xlIiwiZ2V0RGF0ZVJhbmdlIiwicmFuZ2UiLCJub3ciLCJEYXRlIiwic3RhcnREYXRlIiwiZ2V0VGltZSIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJlbmREYXRlIiwiaGFuZGxlciIsIm1ldGhvZCIsInNldEhlYWRlciIsInF1ZXJ5IiwidG90YWxMZWFkcyIsImxlYWQiLCJjb3VudCIsImNyZWF0ZWRBdCIsImd0ZSIsImx0ZSIsImNvbnZlcnRlZExlYWRzIiwiY29udmVydGVkQXQiLCJub3QiLCJlbnJpY2htZW50SnNvbiIsInBhdGgiLCJlcXVhbHMiLCJjb252ZXJzaW9uUmF0ZSIsInRvdGFsUmV2ZW51ZSIsImNsaWVudENvdW50Iiwib3JnIiwiYXZlcmFnZVJldmVudWVQZXJDbGllbnQiLCJwZXJpb2RMZW5ndGgiLCJwcmV2aW91c1N0YXJ0RGF0ZSIsInByZXZpb3VzQ29udmVydGVkTGVhZHMiLCJsdCIsInByZXZpb3VzUmV2ZW51ZSIsImdyb3d0aFJhdGUiLCJtb250aGx5RGF0YSIsImkiLCJtb250aFN0YXJ0IiwibW9udGhFbmQiLCJtb250aExlYWRzIiwibW9udGhDb252ZXJzaW9ucyIsIm1vbnRoUmV2ZW51ZSIsImVzdGltYXRlZEFpQ29zdCIsIm1heEFpQ29zdFBlck1vbnRoIiwiYWlDb3N0IiwiTWF0aCIsIm1pbiIsInByb2ZpdCIsInB1c2giLCJtb250aCIsInRvSVNPU3RyaW5nIiwibGVhZHMiLCJjb252ZXJzaW9ucyIsInJldmVudWUiLCJvcmdzIiwiZmluZE1hbnkiLCJuYW1lIiwiY2xpZW50UGVyZm9ybWFuY2UiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwib3JnSWQiLCJwcmV2aW91c0NvbnZlcnNpb25zIiwicHJldmlvdXNDbGllbnRSZXZlbnVlIiwiZ3Jvd3RoIiwiY2xpZW50SWQiLCJjbGllbnROYW1lIiwic29ydCIsImEiLCJiIiwiYWxsTGVhZHMiLCJzb3VyY2VUeXBlIiwic291cmNlU3RhdHMiLCJNYXAiLCJmb3JFYWNoIiwic291cmNlIiwiaGFzIiwic2V0Iiwic3RhdHMiLCJnZXQiLCJiaWxsaW5nIiwiYmlsbGFibGVFbGlnaWJsZSIsInNvdXJjZUJyZWFrZG93biIsIkFycmF5IiwiZnJvbSIsImVudHJpZXMiLCJwZXJjZW50YWdlIiwiYW5hbHl0aWNzRGF0YSIsIm92ZXJ2aWV3IiwibW9udGhseSIsInNsaWNlIiwiZGF0YSIsImNvbnNvbGUiLCJtZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/provider/analytics.ts\n");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Fanalytics&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Fanalytics.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();