"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/provider/revenue";
exports.ids = ["pages/api/provider/revenue"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Frevenue&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Frevenue.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Frevenue&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Frevenue.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_provider_revenue_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/provider/revenue.ts */ \"(api-node)/./src/pages/api/provider/revenue.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_provider_revenue_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_provider_revenue_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/provider/revenue\",\n        pathname: \"/api/provider/revenue\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_provider_revenue_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/provider/revenue\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/provider/revenue\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGcHJvdmlkZXIlMkZyZXZlbnVlJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTJGcGFnZXMlMkZhcGklMkZwcm92aWRlciUyRnJldmVudWUudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXVEO0FBQ0M7QUFDdUM7QUFDckM7QUFDMUQ7QUFDZ0U7QUFDUTtBQUNGO0FBQ3RFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywrREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsK0RBQVE7QUFDcEM7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCx3QkFBd0IsTUFBdUM7QUFDL0QsQ0FBQztBQUNNO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUI7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0RBQXdEO0FBQ3BFO0FBQ0E7QUFDQSx1QkFBdUIsNEVBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsNkNBQTZDLEVBQTZDO0FBQzFGLDRDQUE0QyxLQUF3QztBQUNwRixpQ0FBaUMsS0FBb0M7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGdGQUFjO0FBQy9FLCtEQUErRCx5Q0FBeUM7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsUUFBUSxFQUFFLE1BQU07QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxrQkFBa0I7QUFDbEIsdUNBQXVDLFFBQVEsRUFBRSxRQUFRO0FBQ3pEO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEscUVBQVM7QUFDakIsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNlbmRFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2FwaS11dGlsc1wiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmMvcGFnZXMvYXBpL3Byb3ZpZGVyL3JldmVudWUudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcHJvdmlkZXIvcmV2ZW51ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Byb3ZpZGVyL3JldmVudWVcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZCxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJydcbn0pO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL3Byb3ZpZGVyL3JldmVudWVcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvcHJvdmlkZXIvcmV2ZW51ZVwiLFxuICAgICAgICAgICAgICAgIGludGVybmFsUmV2YWxpZGF0ZTogcm91dGVyU2VydmVyQ29udGV4dCA9PSBudWxsID8gdm9pZCAwIDogcm91dGVyU2VydmVyQ29udGV4dC5yZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIG9uRXJyb3I6ICguLi5hcmdzKT0+b25SZXF1ZXN0RXJyb3IocmVxLCAuLi5hcmdzKVxuICAgICAgICAgICAgfSkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW52b2tlUm91dGVNb2R1bGUpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvLyB3ZSByZS10aHJvdyBpbiBkZXYgdG8gc2hvdyB0aGUgZXJyb3Igb3ZlcmxheVxuICAgICAgICBpZiAocm91dGVNb2R1bGUuaXNEZXYpIHtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGlzIGlzIHRlY2huaWNhbGx5IGFuIGludmFyaWFudCBhcyBlcnJvciBoYW5kbGluZ1xuICAgICAgICAvLyBzaG91bGQgYmUgZG9uZSBpbnNpZGUgb2YgYXBpLXJlc29sdmVyIG9uRXJyb3JcbiAgICAgICAgc2VuZEVycm9yKHJlcywgNTAwLCAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyk7XG4gICAgfSBmaW5hbGx5e1xuICAgICAgICAvLyBXZSBkb24ndCBhbGxvdyBhbnkgd2FpdFVudGlsIHdvcmsgaW4gcGFnZXMgQVBJIHJvdXRlcyBjdXJyZW50bHlcbiAgICAgICAgLy8gc28gaWYgY2FsbGJhY2sgaXMgcHJlc2VudCByZXR1cm4gd2l0aCByZXNvbHZlZCBwcm9taXNlIHNpbmNlIG5vXG4gICAgICAgIC8vIHBlbmRpbmcgd29ya1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Frevenue&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Frevenue.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n// src/lib/prisma.ts\n\nconst prisma = global.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) global.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLG9CQUFvQjtBQUMwQjtBQVF2QyxNQUFNQyxTQUNYQyxPQUFPRCxNQUFNLElBQ2IsSUFBSUQsd0RBQVlBLENBQUM7SUFDZkcsS0FBS0MsS0FBc0MsR0FBRztRQUFDO1FBQVM7UUFBUztLQUFPLEdBQUcsQ0FBUztBQUN0RixHQUFHO0FBRUwsSUFBSUEsSUFBcUMsRUFBRUYsT0FBT0QsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zcmMvbGliL3ByaXNtYS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL3ByaXNtYS50c1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gQWxsb3cgZ2xvYmFsIGB2YXJgIHJlZGVjbGFyYXRpb24gaW4gZGV2XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsLnByaXNtYSA/P1xuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBbXCJxdWVyeVwiLCBcImVycm9yXCIsIFwid2FyblwiXSA6IFtcImVycm9yXCJdLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikgZ2xvYmFsLnByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJnbG9iYWwiLCJsb2ciLCJwcm9jZXNzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(api-node)/./src/lib/rbac.ts":
/*!*************************!*\
  !*** ./src/lib/rbac.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PERMS: () => (/* binding */ PERMS),\n/* harmony export */   assertPermission: () => (/* binding */ assertPermission),\n/* harmony export */   getEmailFromReq: () => (/* binding */ getEmailFromReq),\n/* harmony export */   getOrgIdFromReq: () => (/* binding */ getOrgIdFromReq)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(api-node)/./src/lib/prisma.ts\");\n// src/lib/rbac.ts\n\n/**\n * Permission catalog. Keep codes in sync with seed.\n */ const PERMS = {\n    DASHBOARD_VIEW: \"dashboard:view\",\n    LEAD_READ: \"lead:read\",\n    LEAD_CREATE: \"lead:create\",\n    LEAD_UPDATE: \"lead:update\",\n    LEAD_DELETE: \"lead:delete\",\n    LEAD_EXPORT: \"lead:export\",\n    ROLES_MANAGE: \"roles:manage\",\n    BILLING_MANAGE: \"billing:manage\"\n};\n/**\n * Email that should bypass RBAC permission checks entirely.\n * If DEV_USER_EMAIL is set in the environment, any request from that\n * email address will be treated as having all permissions. This is\n * useful for development and automated testing. In production you\n * should leave DEV_USER_EMAIL unset.\n */ const DEV_USER_EMAIL = process.env.DEV_USER_EMAIL?.toLowerCase() || null;\n/**\n * Extract current user's email from cookie or header.\n * - Cookie: mv_user=<email>\n * - Header: x-mv-user: <email>  (useful for scripts/tests)\n */ function getEmailFromReq(req) {\n    const fromCookie = req.cookies?.mv_user;\n    const fromHeader = req.headers[\"x-mv-user\"] || req.headers[\"x-mvuser\"];\n    const raw = (Array.isArray(fromCookie) ? fromCookie[0] : fromCookie) ?? fromHeader ?? \"\";\n    const email = raw?.toString().trim().toLowerCase();\n    return email || null;\n}\n/** Look up orgId for current user (used to scope queries). */ async function getOrgIdFromReq(req) {\n    const email = getEmailFromReq(req);\n    if (!email) return null;\n    // Development bypass: if this is the dev user, return a fixed orgId\n    // if provided via DEV_ORG_ID, otherwise fall through to DB lookup.\n    if (DEV_USER_EMAIL && email === DEV_USER_EMAIL) {\n        // Use DEV_ORG_ID if provided, else null to indicate no org\n        const devOrg = process.env.DEV_ORG_ID;\n        if (devOrg) return devOrg;\n        // As a fallback, attempt to fetch the first org from the database\n        try {\n            const firstOrg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.org.findFirst({\n                select: {\n                    id: true\n                }\n            });\n            return firstOrg?.id ?? null;\n        } catch  {\n            return null;\n        }\n    }\n    const u = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email\n        },\n        select: {\n            orgId: true\n        }\n    });\n    return u?.orgId ?? null;\n}\n/**\n * Fetch user's effective permissions from RBAC tables.\n * Falls back to legacy User.role for OWNER/MANAGER/STAFF convenience.\n */ async function getUserPermCodes(userId, legacyRole) {\n    const roleLinks = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.rbacUserRole.findMany({\n        where: {\n            userId\n        },\n        select: {\n            roleId: true\n        }\n    });\n    const roleIds = roleLinks.map((r)=>r.roleId);\n    const perms = roleIds.length ? await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.rbacRolePermission.findMany({\n        where: {\n            roleId: {\n                in: roleIds\n            }\n        },\n        include: {\n            permission: true\n        }\n    }) : [];\n    const codes = new Set(perms.map((rp)=>rp.permission.code));\n    // Legacy role convenience (non-blocking): give sensible defaults\n    switch((legacyRole || \"\").toUpperCase()){\n        case \"OWNER\":\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE,\n                PERMS.LEAD_DELETE,\n                PERMS.LEAD_EXPORT,\n                PERMS.ROLES_MANAGE,\n                PERMS.BILLING_MANAGE\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"MANAGER\":\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE,\n                PERMS.LEAD_DELETE,\n                PERMS.LEAD_EXPORT\n            ].forEach((c)=>codes.add(c));\n            break;\n        case \"STAFF\":\n            [\n                PERMS.DASHBOARD_VIEW,\n                PERMS.LEAD_READ,\n                PERMS.LEAD_CREATE,\n                PERMS.LEAD_UPDATE\n            ].forEach((c)=>codes.add(c));\n            break;\n    }\n    return codes;\n}\n/**\n * Assert that current request is from an authenticated user with a given permission.\n * Writes 401/403 to res if not allowed. Returns true if allowed, false otherwise.\n */ async function assertPermission(req, res, required) {\n    try {\n        const email = getEmailFromReq(req);\n        if (!email) {\n            res.status(401).json({\n                ok: false,\n                error: \"Unauthorized\"\n            });\n            return false;\n        }\n        // Development bypass: if the incoming email matches the DEV_USER_EMAIL\n        // then skip any database lookups and allow the request. This permits\n        // automated tests and development sessions to exercise any API\n        // regardless of the user's persisted role or permissions. If no\n        // DEV_USER_EMAIL is configured, this block has no effect.\n        if (DEV_USER_EMAIL && email === DEV_USER_EMAIL) {\n            return true;\n        }\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                email\n            },\n            select: {\n                id: true,\n                role: true\n            }\n        });\n        if (!user) {\n            res.status(401).json({\n                ok: false,\n                error: \"Unauthorized\"\n            });\n            return false;\n        }\n        const codes = await getUserPermCodes(user.id, user.role);\n        if (!codes.has(required)) {\n            res.status(403).json({\n                ok: false,\n                error: \"Forbidden\"\n            });\n            return false;\n        }\n        return true;\n    } catch (e) {\n        console.error(\"assertPermission error:\", e);\n        res.status(500).json({\n            ok: false,\n            error: \"Internal Server Error\"\n        });\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvcmJhYy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLGtCQUFrQjtBQUUwQjtBQUU1Qzs7Q0FFQyxHQUNNLE1BQU1FLFFBQVE7SUFDbkJDLGdCQUFnQjtJQUNoQkMsV0FBVztJQUNYQyxhQUFhO0lBQ2JDLGFBQWE7SUFDYkMsYUFBYTtJQUNiQyxhQUFhO0lBQ2JDLGNBQWM7SUFDZEMsZ0JBQWdCO0FBQ2xCLEVBQVc7QUFHWDs7Ozs7O0NBTUMsR0FDRCxNQUFNQyxpQkFBaUJDLFFBQVFDLEdBQUcsQ0FBQ0YsY0FBYyxFQUFFRyxpQkFBaUI7QUFFcEU7Ozs7Q0FJQyxHQUNNLFNBQVNDLGdCQUFnQkMsR0FBbUI7SUFDakQsTUFBTUMsYUFBYUQsSUFBSUUsT0FBTyxFQUFFQztJQUNoQyxNQUFNQyxhQUFjSixJQUFJSyxPQUFPLENBQUMsWUFBWSxJQUFJTCxJQUFJSyxPQUFPLENBQUMsV0FBVztJQUN2RSxNQUFNQyxNQUFNLENBQUNDLE1BQU1DLE9BQU8sQ0FBQ1AsY0FBY0EsVUFBVSxDQUFDLEVBQUUsR0FBR0EsVUFBUyxLQUFNRyxjQUFjO0lBQ3RGLE1BQU1LLFFBQVFILEtBQUtJLFdBQVdDLE9BQU9iO0lBQ3JDLE9BQU9XLFNBQVM7QUFDbEI7QUFFQSw0REFBNEQsR0FDckQsZUFBZUcsZ0JBQWdCWixHQUFtQjtJQUN2RCxNQUFNUyxRQUFRVixnQkFBZ0JDO0lBQzlCLElBQUksQ0FBQ1MsT0FBTyxPQUFPO0lBRW5CLG9FQUFvRTtJQUNwRSxtRUFBbUU7SUFDbkUsSUFBSWQsa0JBQWtCYyxVQUFVZCxnQkFBZ0I7UUFDOUMsMkRBQTJEO1FBQzNELE1BQU1rQixTQUFTakIsUUFBUUMsR0FBRyxDQUFDaUIsVUFBVTtRQUNyQyxJQUFJRCxRQUFRLE9BQU9BO1FBQ25CLGtFQUFrRTtRQUNsRSxJQUFJO1lBQ0YsTUFBTUUsV0FBVyxNQUFNOUIsK0NBQUVBLENBQUMrQixHQUFHLENBQUNDLFNBQVMsQ0FBQztnQkFBRUMsUUFBUTtvQkFBRUMsSUFBSTtnQkFBSztZQUFFO1lBQy9ELE9BQU9KLFVBQVVJLE1BQU07UUFDekIsRUFBRSxPQUFNO1lBQ04sT0FBTztRQUNUO0lBQ0Y7SUFDQSxNQUFNQyxJQUFJLE1BQU1uQywrQ0FBRUEsQ0FBQ29DLElBQUksQ0FBQ0MsVUFBVSxDQUFDO1FBQUVDLE9BQU87WUFBRWQ7UUFBTTtRQUFHUyxRQUFRO1lBQUVNLE9BQU87UUFBSztJQUFFO0lBQy9FLE9BQU9KLEdBQUdJLFNBQVM7QUFDckI7QUFFQTs7O0NBR0MsR0FDRCxlQUFlQyxpQkFBaUJDLE1BQWMsRUFBRUMsVUFBMEI7SUFDeEUsTUFBTUMsWUFBWSxNQUFNM0MsK0NBQUVBLENBQUM0QyxZQUFZLENBQUNDLFFBQVEsQ0FBQztRQUMvQ1AsT0FBTztZQUFFRztRQUFPO1FBQ2hCUixRQUFRO1lBQUVhLFFBQVE7UUFBSztJQUN6QjtJQUVBLE1BQU1DLFVBQVVKLFVBQVVLLEdBQUcsQ0FBQyxDQUFDQyxJQUFNQSxFQUFFSCxNQUFNO0lBQzdDLE1BQU1JLFFBQVFILFFBQVFJLE1BQU0sR0FDeEIsTUFBTW5ELCtDQUFFQSxDQUFDb0Qsa0JBQWtCLENBQUNQLFFBQVEsQ0FBQztRQUNuQ1AsT0FBTztZQUFFUSxRQUFRO2dCQUFFTyxJQUFJTjtZQUFRO1FBQUU7UUFDakNPLFNBQVM7WUFBRUMsWUFBWTtRQUFLO0lBQzlCLEtBQ0EsRUFBRTtJQUVOLE1BQU1DLFFBQVEsSUFBSUMsSUFBWVAsTUFBTUYsR0FBRyxDQUFDLENBQUNVLEtBQU9BLEdBQUdILFVBQVUsQ0FBQ0ksSUFBSTtJQUVsRSxpRUFBaUU7SUFDakUsT0FBUSxDQUFDakIsY0FBYyxFQUFDLEVBQUdrQixXQUFXO1FBQ3BDLEtBQUs7WUFDSDtnQkFBQzNELE1BQU1DLGNBQWM7Z0JBQUVELE1BQU1FLFNBQVM7Z0JBQUVGLE1BQU1HLFdBQVc7Z0JBQUVILE1BQU1JLFdBQVc7Z0JBQUVKLE1BQU1LLFdBQVc7Z0JBQUVMLE1BQU1NLFdBQVc7Z0JBQUVOLE1BQU1PLFlBQVk7Z0JBQUVQLE1BQU1RLGNBQWM7YUFBQyxDQUFDb0QsT0FBTyxDQUFDQyxDQUFBQSxJQUFLTixNQUFNTyxHQUFHLENBQUNEO1lBQ3JMO1FBQ0YsS0FBSztZQUNIO2dCQUFDN0QsTUFBTUMsY0FBYztnQkFBRUQsTUFBTUUsU0FBUztnQkFBRUYsTUFBTUcsV0FBVztnQkFBRUgsTUFBTUksV0FBVztnQkFBRUosTUFBTUssV0FBVztnQkFBRUwsTUFBTU0sV0FBVzthQUFDLENBQUNzRCxPQUFPLENBQUNDLENBQUFBLElBQUtOLE1BQU1PLEdBQUcsQ0FBQ0Q7WUFDM0k7UUFDRixLQUFLO1lBQ0g7Z0JBQUM3RCxNQUFNQyxjQUFjO2dCQUFFRCxNQUFNRSxTQUFTO2dCQUFFRixNQUFNRyxXQUFXO2dCQUFFSCxNQUFNSSxXQUFXO2FBQUMsQ0FBQ3dELE9BQU8sQ0FBQ0MsQ0FBQUEsSUFBS04sTUFBTU8sR0FBRyxDQUFDRDtZQUNyRztJQUNKO0lBRUEsT0FBT047QUFDVDtBQUVBOzs7Q0FHQyxHQUNNLGVBQWVRLGlCQUNwQmpELEdBQW1CLEVBQ25Ca0QsR0FBb0IsRUFDcEJDLFFBQWtCO0lBRWxCLElBQUk7UUFDRixNQUFNMUMsUUFBUVYsZ0JBQWdCQztRQUM5QixJQUFJLENBQUNTLE9BQU87WUFDVnlDLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLElBQUk7Z0JBQU9DLE9BQU87WUFBZTtZQUN4RCxPQUFPO1FBQ1Q7UUFFQSx1RUFBdUU7UUFDdkUscUVBQXFFO1FBQ3JFLCtEQUErRDtRQUMvRCxnRUFBZ0U7UUFDaEUsMERBQTBEO1FBQzFELElBQUk1RCxrQkFBa0JjLFVBQVVkLGdCQUFnQjtZQUM5QyxPQUFPO1FBQ1Q7UUFFQSxNQUFNMEIsT0FBTyxNQUFNcEMsK0NBQUVBLENBQUNvQyxJQUFJLENBQUNDLFVBQVUsQ0FBQztZQUNwQ0MsT0FBTztnQkFBRWQ7WUFBTTtZQUNmUyxRQUFRO2dCQUFFQyxJQUFJO2dCQUFNcUMsTUFBTTtZQUFLO1FBQ2pDO1FBRUEsSUFBSSxDQUFDbkMsTUFBTTtZQUNUNkIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsSUFBSTtnQkFBT0MsT0FBTztZQUFlO1lBQ3hELE9BQU87UUFDVDtRQUVBLE1BQU1kLFFBQVEsTUFBTWhCLGlCQUFpQkosS0FBS0YsRUFBRSxFQUFFRSxLQUFLbUMsSUFBSTtRQUN2RCxJQUFJLENBQUNmLE1BQU1nQixHQUFHLENBQUNOLFdBQVc7WUFDeEJELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLElBQUk7Z0JBQU9DLE9BQU87WUFBWTtZQUNyRCxPQUFPO1FBQ1Q7UUFDQSxPQUFPO0lBQ1QsRUFBRSxPQUFPRyxHQUFZO1FBQ25CQyxRQUFRSixLQUFLLENBQUMsMkJBQTJCRztRQUN6Q1IsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxJQUFJO1lBQU9DLE9BQU87UUFBd0I7UUFDakUsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL2xpYi9yYmFjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvcmJhYy50c1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcbmltcG9ydCB7IHByaXNtYSBhcyBkYiB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcblxuLyoqXG4gKiBQZXJtaXNzaW9uIGNhdGFsb2cuIEtlZXAgY29kZXMgaW4gc3luYyB3aXRoIHNlZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBQRVJNUyA9IHtcbiAgREFTSEJPQVJEX1ZJRVc6IFwiZGFzaGJvYXJkOnZpZXdcIixcbiAgTEVBRF9SRUFEOiBcImxlYWQ6cmVhZFwiLFxuICBMRUFEX0NSRUFURTogXCJsZWFkOmNyZWF0ZVwiLFxuICBMRUFEX1VQREFURTogXCJsZWFkOnVwZGF0ZVwiLFxuICBMRUFEX0RFTEVURTogXCJsZWFkOmRlbGV0ZVwiLFxuICBMRUFEX0VYUE9SVDogXCJsZWFkOmV4cG9ydFwiLFxuICBST0xFU19NQU5BR0U6IFwicm9sZXM6bWFuYWdlXCIsXG4gIEJJTExJTkdfTUFOQUdFOiBcImJpbGxpbmc6bWFuYWdlXCIsXG59IGFzIGNvbnN0O1xuZXhwb3J0IHR5cGUgUGVybUNvZGUgPSAodHlwZW9mIFBFUk1TKVtrZXlvZiB0eXBlb2YgUEVSTVNdO1xuXG4vKipcbiAqIEVtYWlsIHRoYXQgc2hvdWxkIGJ5cGFzcyBSQkFDIHBlcm1pc3Npb24gY2hlY2tzIGVudGlyZWx5LlxuICogSWYgREVWX1VTRVJfRU1BSUwgaXMgc2V0IGluIHRoZSBlbnZpcm9ubWVudCwgYW55IHJlcXVlc3QgZnJvbSB0aGF0XG4gKiBlbWFpbCBhZGRyZXNzIHdpbGwgYmUgdHJlYXRlZCBhcyBoYXZpbmcgYWxsIHBlcm1pc3Npb25zLiBUaGlzIGlzXG4gKiB1c2VmdWwgZm9yIGRldmVsb3BtZW50IGFuZCBhdXRvbWF0ZWQgdGVzdGluZy4gSW4gcHJvZHVjdGlvbiB5b3VcbiAqIHNob3VsZCBsZWF2ZSBERVZfVVNFUl9FTUFJTCB1bnNldC5cbiAqL1xuY29uc3QgREVWX1VTRVJfRU1BSUwgPSBwcm9jZXNzLmVudi5ERVZfVVNFUl9FTUFJTD8udG9Mb3dlckNhc2UoKSB8fCBudWxsO1xuXG4vKipcbiAqIEV4dHJhY3QgY3VycmVudCB1c2VyJ3MgZW1haWwgZnJvbSBjb29raWUgb3IgaGVhZGVyLlxuICogLSBDb29raWU6IG12X3VzZXI9PGVtYWlsPlxuICogLSBIZWFkZXI6IHgtbXYtdXNlcjogPGVtYWlsPiAgKHVzZWZ1bCBmb3Igc2NyaXB0cy90ZXN0cylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVtYWlsRnJvbVJlcShyZXE6IE5leHRBcGlSZXF1ZXN0KTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGZyb21Db29raWUgPSByZXEuY29va2llcz8ubXZfdXNlcjtcbiAgY29uc3QgZnJvbUhlYWRlciA9IChyZXEuaGVhZGVyc1tcIngtbXYtdXNlclwiXSB8fCByZXEuaGVhZGVyc1tcIngtbXZ1c2VyXCJdKSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIGNvbnN0IHJhdyA9IChBcnJheS5pc0FycmF5KGZyb21Db29raWUpID8gZnJvbUNvb2tpZVswXSA6IGZyb21Db29raWUpID8/IGZyb21IZWFkZXIgPz8gXCJcIjtcbiAgY29uc3QgZW1haWwgPSByYXc/LnRvU3RyaW5nKCkudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiBlbWFpbCB8fCBudWxsO1xufVxuXG4vKiogTG9vayB1cCBvcmdJZCBmb3IgY3VycmVudCB1c2VyICh1c2VkIHRvIHNjb3BlIHF1ZXJpZXMpLiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yZ0lkRnJvbVJlcShyZXE6IE5leHRBcGlSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gIGNvbnN0IGVtYWlsID0gZ2V0RW1haWxGcm9tUmVxKHJlcSk7XG4gIGlmICghZW1haWwpIHJldHVybiBudWxsO1xuXG4gIC8vIERldmVsb3BtZW50IGJ5cGFzczogaWYgdGhpcyBpcyB0aGUgZGV2IHVzZXIsIHJldHVybiBhIGZpeGVkIG9yZ0lkXG4gIC8vIGlmIHByb3ZpZGVkIHZpYSBERVZfT1JHX0lELCBvdGhlcndpc2UgZmFsbCB0aHJvdWdoIHRvIERCIGxvb2t1cC5cbiAgaWYgKERFVl9VU0VSX0VNQUlMICYmIGVtYWlsID09PSBERVZfVVNFUl9FTUFJTCkge1xuICAgIC8vIFVzZSBERVZfT1JHX0lEIGlmIHByb3ZpZGVkLCBlbHNlIG51bGwgdG8gaW5kaWNhdGUgbm8gb3JnXG4gICAgY29uc3QgZGV2T3JnID0gcHJvY2Vzcy5lbnYuREVWX09SR19JRDtcbiAgICBpZiAoZGV2T3JnKSByZXR1cm4gZGV2T3JnO1xuICAgIC8vIEFzIGEgZmFsbGJhY2ssIGF0dGVtcHQgdG8gZmV0Y2ggdGhlIGZpcnN0IG9yZyBmcm9tIHRoZSBkYXRhYmFzZVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaXJzdE9yZyA9IGF3YWl0IGRiLm9yZy5maW5kRmlyc3QoeyBzZWxlY3Q6IHsgaWQ6IHRydWUgfSB9KTtcbiAgICAgIHJldHVybiBmaXJzdE9yZz8uaWQgPz8gbnVsbDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuICBjb25zdCB1ID0gYXdhaXQgZGIudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgZW1haWwgfSwgc2VsZWN0OiB7IG9yZ0lkOiB0cnVlIH0gfSk7XG4gIHJldHVybiB1Py5vcmdJZCA/PyBudWxsO1xufVxuXG4vKipcbiAqIEZldGNoIHVzZXIncyBlZmZlY3RpdmUgcGVybWlzc2lvbnMgZnJvbSBSQkFDIHRhYmxlcy5cbiAqIEZhbGxzIGJhY2sgdG8gbGVnYWN5IFVzZXIucm9sZSBmb3IgT1dORVIvTUFOQUdFUi9TVEFGRiBjb252ZW5pZW5jZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclBlcm1Db2Rlcyh1c2VySWQ6IHN0cmluZywgbGVnYWN5Um9sZT86IHN0cmluZyB8IG51bGwpOiBQcm9taXNlPFNldDxzdHJpbmc+PiB7XG4gIGNvbnN0IHJvbGVMaW5rcyA9IGF3YWl0IGRiLnJiYWNVc2VyUm9sZS5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgc2VsZWN0OiB7IHJvbGVJZDogdHJ1ZSB9LFxuICB9KTtcblxuICBjb25zdCByb2xlSWRzID0gcm9sZUxpbmtzLm1hcCgocikgPT4gci5yb2xlSWQpO1xuICBjb25zdCBwZXJtcyA9IHJvbGVJZHMubGVuZ3RoXG4gICAgPyBhd2FpdCBkYi5yYmFjUm9sZVBlcm1pc3Npb24uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyByb2xlSWQ6IHsgaW46IHJvbGVJZHMgfSB9LFxuICAgICAgICBpbmNsdWRlOiB7IHBlcm1pc3Npb246IHRydWUgfSxcbiAgICAgIH0pXG4gICAgOiBbXTtcblxuICBjb25zdCBjb2RlcyA9IG5ldyBTZXQ8c3RyaW5nPihwZXJtcy5tYXAoKHJwKSA9PiBycC5wZXJtaXNzaW9uLmNvZGUpKTtcblxuICAvLyBMZWdhY3kgcm9sZSBjb252ZW5pZW5jZSAobm9uLWJsb2NraW5nKTogZ2l2ZSBzZW5zaWJsZSBkZWZhdWx0c1xuICBzd2l0Y2ggKChsZWdhY3lSb2xlIHx8IFwiXCIpLnRvVXBwZXJDYXNlKCkpIHtcbiAgICBjYXNlIFwiT1dORVJcIjpcbiAgICAgIFtQRVJNUy5EQVNIQk9BUkRfVklFVywgUEVSTVMuTEVBRF9SRUFELCBQRVJNUy5MRUFEX0NSRUFURSwgUEVSTVMuTEVBRF9VUERBVEUsIFBFUk1TLkxFQURfREVMRVRFLCBQRVJNUy5MRUFEX0VYUE9SVCwgUEVSTVMuUk9MRVNfTUFOQUdFLCBQRVJNUy5CSUxMSU5HX01BTkFHRV0uZm9yRWFjaChjID0+IGNvZGVzLmFkZChjKSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiTUFOQUdFUlwiOlxuICAgICAgW1BFUk1TLkRBU0hCT0FSRF9WSUVXLCBQRVJNUy5MRUFEX1JFQUQsIFBFUk1TLkxFQURfQ1JFQVRFLCBQRVJNUy5MRUFEX1VQREFURSwgUEVSTVMuTEVBRF9ERUxFVEUsIFBFUk1TLkxFQURfRVhQT1JUXS5mb3JFYWNoKGMgPT4gY29kZXMuYWRkKGMpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJTVEFGRlwiOlxuICAgICAgW1BFUk1TLkRBU0hCT0FSRF9WSUVXLCBQRVJNUy5MRUFEX1JFQUQsIFBFUk1TLkxFQURfQ1JFQVRFLCBQRVJNUy5MRUFEX1VQREFURV0uZm9yRWFjaChjID0+IGNvZGVzLmFkZChjKSk7XG4gICAgICBicmVhaztcbiAgfVxuXG4gIHJldHVybiBjb2Rlcztcbn1cblxuLyoqXG4gKiBBc3NlcnQgdGhhdCBjdXJyZW50IHJlcXVlc3QgaXMgZnJvbSBhbiBhdXRoZW50aWNhdGVkIHVzZXIgd2l0aCBhIGdpdmVuIHBlcm1pc3Npb24uXG4gKiBXcml0ZXMgNDAxLzQwMyB0byByZXMgaWYgbm90IGFsbG93ZWQuIFJldHVybnMgdHJ1ZSBpZiBhbGxvd2VkLCBmYWxzZSBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhc3NlcnRQZXJtaXNzaW9uKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZSxcbiAgcmVxdWlyZWQ6IFBlcm1Db2RlXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBlbWFpbCA9IGdldEVtYWlsRnJvbVJlcShyZXEpO1xuICAgIGlmICghZW1haWwpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBEZXZlbG9wbWVudCBieXBhc3M6IGlmIHRoZSBpbmNvbWluZyBlbWFpbCBtYXRjaGVzIHRoZSBERVZfVVNFUl9FTUFJTFxuICAgIC8vIHRoZW4gc2tpcCBhbnkgZGF0YWJhc2UgbG9va3VwcyBhbmQgYWxsb3cgdGhlIHJlcXVlc3QuIFRoaXMgcGVybWl0c1xuICAgIC8vIGF1dG9tYXRlZCB0ZXN0cyBhbmQgZGV2ZWxvcG1lbnQgc2Vzc2lvbnMgdG8gZXhlcmNpc2UgYW55IEFQSVxuICAgIC8vIHJlZ2FyZGxlc3Mgb2YgdGhlIHVzZXIncyBwZXJzaXN0ZWQgcm9sZSBvciBwZXJtaXNzaW9ucy4gSWYgbm9cbiAgICAvLyBERVZfVVNFUl9FTUFJTCBpcyBjb25maWd1cmVkLCB0aGlzIGJsb2NrIGhhcyBubyBlZmZlY3QuXG4gICAgaWYgKERFVl9VU0VSX0VNQUlMICYmIGVtYWlsID09PSBERVZfVVNFUl9FTUFJTCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBlbWFpbCB9LFxuICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCByb2xlOiB0cnVlIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCBjb2RlcyA9IGF3YWl0IGdldFVzZXJQZXJtQ29kZXModXNlci5pZCwgdXNlci5yb2xlKTtcbiAgICBpZiAoIWNvZGVzLmhhcyhyZXF1aXJlZCkpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJGb3JiaWRkZW5cIiB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICBjb25zb2xlLmVycm9yKFwiYXNzZXJ0UGVybWlzc2lvbiBlcnJvcjpcIiwgZSk7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIkludGVybmFsIFNlcnZlciBFcnJvclwiIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImRiIiwiUEVSTVMiLCJEQVNIQk9BUkRfVklFVyIsIkxFQURfUkVBRCIsIkxFQURfQ1JFQVRFIiwiTEVBRF9VUERBVEUiLCJMRUFEX0RFTEVURSIsIkxFQURfRVhQT1JUIiwiUk9MRVNfTUFOQUdFIiwiQklMTElOR19NQU5BR0UiLCJERVZfVVNFUl9FTUFJTCIsInByb2Nlc3MiLCJlbnYiLCJ0b0xvd2VyQ2FzZSIsImdldEVtYWlsRnJvbVJlcSIsInJlcSIsImZyb21Db29raWUiLCJjb29raWVzIiwibXZfdXNlciIsImZyb21IZWFkZXIiLCJoZWFkZXJzIiwicmF3IiwiQXJyYXkiLCJpc0FycmF5IiwiZW1haWwiLCJ0b1N0cmluZyIsInRyaW0iLCJnZXRPcmdJZEZyb21SZXEiLCJkZXZPcmciLCJERVZfT1JHX0lEIiwiZmlyc3RPcmciLCJvcmciLCJmaW5kRmlyc3QiLCJzZWxlY3QiLCJpZCIsInUiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwib3JnSWQiLCJnZXRVc2VyUGVybUNvZGVzIiwidXNlcklkIiwibGVnYWN5Um9sZSIsInJvbGVMaW5rcyIsInJiYWNVc2VyUm9sZSIsImZpbmRNYW55Iiwicm9sZUlkIiwicm9sZUlkcyIsIm1hcCIsInIiLCJwZXJtcyIsImxlbmd0aCIsInJiYWNSb2xlUGVybWlzc2lvbiIsImluIiwiaW5jbHVkZSIsInBlcm1pc3Npb24iLCJjb2RlcyIsIlNldCIsInJwIiwiY29kZSIsInRvVXBwZXJDYXNlIiwiZm9yRWFjaCIsImMiLCJhZGQiLCJhc3NlcnRQZXJtaXNzaW9uIiwicmVzIiwicmVxdWlyZWQiLCJzdGF0dXMiLCJqc29uIiwib2siLCJlcnJvciIsInJvbGUiLCJoYXMiLCJlIiwiY29uc29sZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/rbac.ts\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/provider/revenue.ts":
/*!*******************************************!*\
  !*** ./src/pages/api/provider/revenue.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(api-node)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_rbac__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/rbac */ \"(api-node)/./src/lib/rbac.ts\");\n// src/pages/api/provider/revenue.ts\n\n\n// Ensure only providers can access this endpoint\nasync function ensureProvider(req, res) {\n    const email = (0,_lib_rbac__WEBPACK_IMPORTED_MODULE_1__.getEmailFromReq)(req);\n    if (!email) {\n        res.status(401).json({\n            ok: false,\n            error: \"Unauthorized\"\n        });\n        return null;\n    }\n    const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email\n        },\n        select: {\n            id: true,\n            role: true\n        }\n    });\n    if (!user || user.role !== 'PROVIDER') {\n        res.status(403).json({\n            ok: false,\n            error: \"Provider access required\"\n        });\n        return null;\n    }\n    return user;\n}\nfunction getDateRange(range) {\n    const now = new Date();\n    let startDate;\n    switch(range){\n        case '30d':\n            startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n            break;\n        case '90d':\n            startDate = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);\n            break;\n        case '6m':\n            startDate = new Date(now.getFullYear(), now.getMonth() - 6, 1);\n            break;\n        case '1y':\n            startDate = new Date(now.getFullYear() - 1, now.getMonth(), 1);\n            break;\n        default:\n            startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n    }\n    return {\n        startDate,\n        endDate: now\n    };\n}\nasync function handler(req, res) {\n    try {\n        if (req.method !== 'GET') {\n            res.setHeader('Allow', 'GET');\n            return res.status(405).json({\n                ok: false,\n                error: 'Method not allowed'\n            });\n        }\n        const user = await ensureProvider(req, res);\n        if (!user) return;\n        const range = req.query.range || '30d';\n        const { startDate, endDate } = getDateRange(range);\n        // Get current month for monthly calculations\n        const now = new Date();\n        const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n        // Revenue summary calculations\n        const totalConvertedLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                convertedAt: {\n                    not: null\n                },\n                enrichmentJson: {\n                    path: [\n                        'billing',\n                        'billableEligible'\n                    ],\n                    equals: true\n                },\n                // CRITICAL: Exclude employee referrals from Provider revenue\n                NOT: {\n                    OR: [\n                        {\n                            sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            sourceType: 'EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            enrichmentJson: {\n                                path: [\n                                    'billing',\n                                    'employeeRewardEligible'\n                                ],\n                                equals: true\n                            }\n                        }\n                    ]\n                }\n            }\n        });\n        const monthlyConvertedLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                convertedAt: {\n                    gte: monthStart,\n                    lte: endDate\n                },\n                enrichmentJson: {\n                    path: [\n                        'billing',\n                        'billableEligible'\n                    ],\n                    equals: true\n                },\n                // CRITICAL: Exclude employee referrals from Provider revenue\n                NOT: {\n                    OR: [\n                        {\n                            sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            sourceType: 'EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            enrichmentJson: {\n                                path: [\n                                    'billing',\n                                    'employeeRewardEligible'\n                                ],\n                                equals: true\n                            }\n                        }\n                    ]\n                }\n            }\n        });\n        const periodConvertedLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                convertedAt: {\n                    gte: startDate,\n                    lte: endDate\n                },\n                enrichmentJson: {\n                    path: [\n                        'billing',\n                        'billableEligible'\n                    ],\n                    equals: true\n                },\n                // CRITICAL: Exclude employee referrals from Provider revenue\n                NOT: {\n                    OR: [\n                        {\n                            sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            sourceType: 'EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            enrichmentJson: {\n                                path: [\n                                    'billing',\n                                    'employeeRewardEligible'\n                                ],\n                                equals: true\n                            }\n                        }\n                    ]\n                }\n            }\n        });\n        const totalRevenue = totalConvertedLeads * 100;\n        const monthlyRevenue = monthlyConvertedLeads * 100;\n        const pendingRevenue = 0; // Would be calculated from unpaid invoices\n        // AI cost calculation with configurable limit\n        // TODO: Replace with actual AI usage tracking from aiMeter system\n        const totalLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n            where: {\n                createdAt: {\n                    gte: monthStart,\n                    lte: endDate\n                },\n                // CRITICAL: Exclude employee referrals from Provider AI cost calculations\n                NOT: {\n                    OR: [\n                        {\n                            sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            sourceType: 'EMPLOYEE_REFERRAL'\n                        },\n                        {\n                            enrichmentJson: {\n                                path: [\n                                    'billing',\n                                    'employeeRewardEligible'\n                                ],\n                                equals: true\n                            }\n                        }\n                    ]\n                }\n            }\n        });\n        const estimatedAiCost = totalLeads * 0.02 + monthlyConvertedLeads * 0.1;\n        const maxAiCostPerMonth = 50; // Default limit - should come from provider settings\n        const aiCosts = Math.min(estimatedAiCost, maxAiCostPerMonth);\n        const netProfit = monthlyRevenue - aiCosts;\n        const profitMargin = monthlyRevenue > 0 ? netProfit / monthlyRevenue : 0;\n        const averageRevenuePerLead = periodConvertedLeads > 0 ? periodConvertedLeads * 100 / periodConvertedLeads : 100;\n        // Project monthly revenue based on current trends\n        const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();\n        const daysSoFar = now.getDate();\n        const projectedMonthlyRevenue = daysSoFar > 0 ? monthlyRevenue / daysSoFar * daysInMonth : monthlyRevenue;\n        // Monthly breakdown - get last 6 months\n        const monthlyBreakdown = [];\n        for(let i = 5; i >= 0; i--){\n            const monthStart = new Date(endDate.getFullYear(), endDate.getMonth() - i, 1);\n            const monthEnd = new Date(endDate.getFullYear(), endDate.getMonth() - i + 1, 0, 23, 59, 59);\n            const leads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    createdAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    },\n                    // CRITICAL: Exclude employee referrals from Provider revenue calculations\n                    NOT: {\n                        OR: [\n                            {\n                                sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                sourceType: 'EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                enrichmentJson: {\n                                    path: [\n                                        'billing',\n                                        'employeeRewardEligible'\n                                    ],\n                                    equals: true\n                                }\n                            }\n                        ]\n                    }\n                }\n            });\n            const conversions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    convertedAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    },\n                    enrichmentJson: {\n                        path: [\n                            'billing',\n                            'billableEligible'\n                        ],\n                        equals: true\n                    },\n                    // CRITICAL: Exclude employee referrals from Provider revenue\n                    NOT: {\n                        OR: [\n                            {\n                                sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                sourceType: 'EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                enrichmentJson: {\n                                    path: [\n                                        'billing',\n                                        'employeeRewardEligible'\n                                    ],\n                                    equals: true\n                                }\n                            }\n                        ]\n                    }\n                }\n            });\n            const revenue = conversions * 100;\n            // AI cost calculation with configurable limit\n            // TODO: Replace with actual AI usage tracking from aiMeter system\n            const estimatedAiCost = leads * 0.02 + conversions * 0.1;\n            const maxAiCostPerMonth = 50; // Default limit - should come from provider settings\n            const aiCost = Math.min(estimatedAiCost, maxAiCostPerMonth);\n            const netProfit = revenue - aiCost;\n            const profitMargin = revenue > 0 ? netProfit / revenue : 0;\n            monthlyBreakdown.push({\n                month: monthStart.toISOString(),\n                leads,\n                conversions,\n                revenue,\n                aiCost,\n                netProfit,\n                profitMargin\n            });\n        }\n        // Client revenue breakdown\n        const orgs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.org.findMany({\n            select: {\n                id: true,\n                name: true\n            }\n        });\n        const clientRevenue = await Promise.all(orgs.map(async (org)=>{\n            const monthlyConversions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    orgId: org.id,\n                    convertedAt: {\n                        gte: monthStart,\n                        lte: endDate\n                    },\n                    enrichmentJson: {\n                        path: [\n                            'billing',\n                            'billableEligible'\n                        ],\n                        equals: true\n                    },\n                    // CRITICAL: Exclude employee referrals from Provider revenue\n                    NOT: {\n                        OR: [\n                            {\n                                sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                sourceType: 'EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                enrichmentJson: {\n                                    path: [\n                                        'billing',\n                                        'employeeRewardEligible'\n                                    ],\n                                    equals: true\n                                }\n                            }\n                        ]\n                    }\n                }\n            });\n            const totalConversions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.lead.count({\n                where: {\n                    orgId: org.id,\n                    convertedAt: {\n                        not: null\n                    },\n                    enrichmentJson: {\n                        path: [\n                            'billing',\n                            'billableEligible'\n                        ],\n                        equals: true\n                    },\n                    // CRITICAL: Exclude employee referrals from Provider revenue\n                    NOT: {\n                        OR: [\n                            {\n                                sourceType: 'MANUAL_EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                sourceType: 'EMPLOYEE_REFERRAL'\n                            },\n                            {\n                                enrichmentJson: {\n                                    path: [\n                                        'billing',\n                                        'employeeRewardEligible'\n                                    ],\n                                    equals: true\n                                }\n                            }\n                        ]\n                    }\n                }\n            });\n            const monthlyRevenue = monthlyConversions * 100;\n            const totalRevenue = totalConversions * 100;\n            const averageRevenuePerConversion = totalConversions > 0 ? totalRevenue / totalConversions : 100;\n            // Mock payment status - would be calculated from actual billing records\n            const status = monthlyRevenue > 0 ? 'paid' : 'pending';\n            const lastPayment = monthlyRevenue > 0 ? new Date().toISOString() : null;\n            return {\n                clientId: org.id,\n                clientName: org.name,\n                monthlyRevenue,\n                totalRevenue,\n                conversions: totalConversions,\n                averageRevenuePerConversion,\n                lastPayment,\n                status\n            };\n        }));\n        // Sort by monthly revenue\n        clientRevenue.sort((a, b)=>b.monthlyRevenue - a.monthlyRevenue);\n        // Mock transaction history - would come from actual billing/payment records\n        const transactions = clientRevenue.slice(0, 10).flatMap((client)=>{\n            const clientTransactions = [];\n            if (client.monthlyRevenue > 0) {\n                clientTransactions.push({\n                    id: `txn_${client.clientId}_${Date.now()}`,\n                    clientId: client.clientId,\n                    clientName: client.clientName,\n                    amount: client.monthlyRevenue,\n                    type: 'lead_conversion',\n                    description: `${client.conversions} lead conversions`,\n                    createdAt: new Date().toISOString(),\n                    status: 'completed'\n                });\n            }\n            return clientTransactions;\n        });\n        // Add AI cost transactions\n        if (aiCosts > 0) {\n            transactions.unshift({\n                id: `ai_cost_${Date.now()}`,\n                clientId: 'system',\n                clientName: 'System AI Costs',\n                amount: aiCosts,\n                type: 'ai_cost',\n                description: 'Monthly AI processing costs',\n                createdAt: new Date().toISOString(),\n                status: 'completed'\n            });\n        }\n        // Sort transactions by date (newest first)\n        transactions.sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n        const revenueData = {\n            summary: {\n                totalRevenue,\n                monthlyRevenue,\n                pendingRevenue,\n                aiCosts,\n                netProfit,\n                profitMargin,\n                averageRevenuePerLead,\n                projectedMonthlyRevenue\n            },\n            monthlyBreakdown,\n            clientRevenue: clientRevenue.slice(0, 10),\n            transactions: transactions.slice(0, 20) // Recent 20 transactions\n        };\n        return res.status(200).json({\n            ok: true,\n            data: revenueData\n        });\n    } catch (error) {\n        console.error('Provider revenue error:', error);\n        return res.status(500).json({\n            ok: false,\n            error: error.message || 'Failed to fetch revenue data'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvcHJvdmlkZXIvcmV2ZW51ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvQ0FBb0M7QUFFUTtBQUNDO0FBRTdDLGlEQUFpRDtBQUNqRCxlQUFlRyxlQUFlQyxHQUFtQixFQUFFQyxHQUFvQjtJQUNyRSxNQUFNQyxRQUFRSiwwREFBZUEsQ0FBQ0U7SUFDOUIsSUFBSSxDQUFDRSxPQUFPO1FBQ1ZELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsSUFBSTtZQUFPQyxPQUFPO1FBQWU7UUFDeEQsT0FBTztJQUNUO0lBRUEsTUFBTUMsT0FBTyxNQUFNViwrQ0FBRUEsQ0FBQ1UsSUFBSSxDQUFDQyxVQUFVLENBQUM7UUFDcENDLE9BQU87WUFBRVA7UUFBTTtRQUNmUSxRQUFRO1lBQUVDLElBQUk7WUFBTUMsTUFBTTtRQUFLO0lBQ2pDO0lBRUEsSUFBSSxDQUFDTCxRQUFRQSxLQUFLSyxJQUFJLEtBQUssWUFBWTtRQUNyQ1gsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxJQUFJO1lBQU9DLE9BQU87UUFBMkI7UUFDcEUsT0FBTztJQUNUO0lBRUEsT0FBT0M7QUFDVDtBQUVBLFNBQVNNLGFBQWFDLEtBQWE7SUFDakMsTUFBTUMsTUFBTSxJQUFJQztJQUNoQixJQUFJQztJQUVKLE9BQVFIO1FBQ04sS0FBSztZQUNIRyxZQUFZLElBQUlELEtBQUtELElBQUlHLE9BQU8sS0FBSyxLQUFLLEtBQUssS0FBSyxLQUFLO1lBQ3pEO1FBQ0YsS0FBSztZQUNIRCxZQUFZLElBQUlELEtBQUtELElBQUlHLE9BQU8sS0FBSyxLQUFLLEtBQUssS0FBSyxLQUFLO1lBQ3pEO1FBQ0YsS0FBSztZQUNIRCxZQUFZLElBQUlELEtBQUtELElBQUlJLFdBQVcsSUFBSUosSUFBSUssUUFBUSxLQUFLLEdBQUc7WUFDNUQ7UUFDRixLQUFLO1lBQ0hILFlBQVksSUFBSUQsS0FBS0QsSUFBSUksV0FBVyxLQUFL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Q0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLElBQUk7WUFDSkMsT0FBT0EsTUFBTThGLE9BQU8sSUFBSTtRQUMxQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvc3JjL3BhZ2VzL2FwaS9wcm92aWRlci9yZXZlbnVlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9wYWdlcy9hcGkvcHJvdmlkZXIvcmV2ZW51ZS50c1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcbmltcG9ydCB7IHByaXNtYSBhcyBkYiB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmltcG9ydCB7IGdldEVtYWlsRnJvbVJlcSB9IGZyb20gXCJAL2xpYi9yYmFjXCI7XG5cbi8vIEVuc3VyZSBvbmx5IHByb3ZpZGVycyBjYW4gYWNjZXNzIHRoaXMgZW5kcG9pbnRcbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVByb3ZpZGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIGNvbnN0IGVtYWlsID0gZ2V0RW1haWxGcm9tUmVxKHJlcSk7XG4gIGlmICghZW1haWwpIHtcbiAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCB1c2VyID0gYXdhaXQgZGIudXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBlbWFpbCB9LFxuICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgcm9sZTogdHJ1ZSB9LFxuICB9KTtcblxuICBpZiAoIXVzZXIgfHwgdXNlci5yb2xlICE9PSAnUFJPVklERVInKSB7XG4gICAgcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIlByb3ZpZGVyIGFjY2VzcyByZXF1aXJlZFwiIH0pO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIHVzZXI7XG59XG5cbmZ1bmN0aW9uIGdldERhdGVSYW5nZShyYW5nZTogc3RyaW5nKSB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIGxldCBzdGFydERhdGU6IERhdGU7XG5cbiAgc3dpdGNoIChyYW5nZSkge1xuICAgIGNhc2UgJzMwZCc6XG4gICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJzkwZCc6XG4gICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gOTAgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJzZtJzpcbiAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCBub3cuZ2V0TW9udGgoKSAtIDYsIDEpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnMXknOlxuICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUobm93LmdldEZ1bGxZZWFyKCkgLSAxLCBub3cuZ2V0TW9udGgoKSwgMSk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gIH1cblxuICByZXR1cm4geyBzdGFydERhdGUsIGVuZERhdGU6IG5vdyB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIHRyeSB7XG4gICAgaWYgKHJlcS5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsICdHRVQnKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBlbnN1cmVQcm92aWRlcihyZXEsIHJlcyk7XG4gICAgaWYgKCF1c2VyKSByZXR1cm47XG5cbiAgICBjb25zdCByYW5nZSA9IHJlcS5xdWVyeS5yYW5nZSBhcyBzdHJpbmcgfHwgJzMwZCc7XG4gICAgY29uc3QgeyBzdGFydERhdGUsIGVuZERhdGUgfSA9IGdldERhdGVSYW5nZShyYW5nZSk7XG5cbiAgICAvLyBHZXQgY3VycmVudCBtb250aCBmb3IgbW9udGhseSBjYWxjdWxhdGlvbnNcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IG1vbnRoU3RhcnQgPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCksIDEpO1xuXG4gICAgLy8gUmV2ZW51ZSBzdW1tYXJ5IGNhbGN1bGF0aW9uc1xuICAgIGNvbnN0IHRvdGFsQ29udmVydGVkTGVhZHMgPSBhd2FpdCBkYi5sZWFkLmNvdW50KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGNvbnZlcnRlZEF0OiB7IG5vdDogbnVsbCB9LFxuICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdiaWxsYWJsZUVsaWdpYmxlJ10sXG4gICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIC8vIENSSVRJQ0FMOiBFeGNsdWRlIGVtcGxveWVlIHJlZmVycmFscyBmcm9tIFByb3ZpZGVyIHJldmVudWVcbiAgICAgICAgTk9UOiB7XG4gICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgIHsgc291cmNlVHlwZTogJ01BTlVBTF9FTVBMT1lFRV9SRUZFUlJBTCcgfSxcbiAgICAgICAgICAgIHsgc291cmNlVHlwZTogJ0VNUExPWUVFX1JFRkVSUkFMJyB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdlbXBsb3llZVJld2FyZEVsaWdpYmxlJ10sXG4gICAgICAgICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IG1vbnRobHlDb252ZXJ0ZWRMZWFkcyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgY29udmVydGVkQXQ6IHtcbiAgICAgICAgICBndGU6IG1vbnRoU3RhcnQsXG4gICAgICAgICAgbHRlOiBlbmREYXRlXG4gICAgICAgIH0sXG4gICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2JpbGxhYmxlRWxpZ2libGUnXSxcbiAgICAgICAgICBlcXVhbHM6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgLy8gQ1JJVElDQUw6IEV4Y2x1ZGUgZW1wbG95ZWUgcmVmZXJyYWxzIGZyb20gUHJvdmlkZXIgcmV2ZW51ZVxuICAgICAgICBOT1Q6IHtcbiAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnTUFOVUFMX0VNUExPWUVFX1JFRkVSUkFMJyB9LFxuICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnRU1QTE9ZRUVfUkVGRVJSQUwnIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2VtcGxveWVlUmV3YXJkRWxpZ2libGUnXSxcbiAgICAgICAgICAgICAgICBlcXVhbHM6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgcGVyaW9kQ29udmVydGVkTGVhZHMgPSBhd2FpdCBkYi5sZWFkLmNvdW50KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGNvbnZlcnRlZEF0OiB7XG4gICAgICAgICAgZ3RlOiBzdGFydERhdGUsXG4gICAgICAgICAgbHRlOiBlbmREYXRlXG4gICAgICAgIH0sXG4gICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2JpbGxhYmxlRWxpZ2libGUnXSxcbiAgICAgICAgICBlcXVhbHM6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgLy8gQ1JJVElDQUw6IEV4Y2x1ZGUgZW1wbG95ZWUgcmVmZXJyYWxzIGZyb20gUHJvdmlkZXIgcmV2ZW51ZVxuICAgICAgICBOT1Q6IHtcbiAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnTUFOVUFMX0VNUExPWUVFX1JFRkVSUkFMJyB9LFxuICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnRU1QTE9ZRUVfUkVGRVJSQUwnIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2VtcGxveWVlUmV3YXJkRWxpZ2libGUnXSxcbiAgICAgICAgICAgICAgICBlcXVhbHM6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgdG90YWxSZXZlbnVlID0gdG90YWxDb252ZXJ0ZWRMZWFkcyAqIDEwMDtcbiAgICBjb25zdCBtb250aGx5UmV2ZW51ZSA9IG1vbnRobHlDb252ZXJ0ZWRMZWFkcyAqIDEwMDtcbiAgICBjb25zdCBwZW5kaW5nUmV2ZW51ZSA9IDA7IC8vIFdvdWxkIGJlIGNhbGN1bGF0ZWQgZnJvbSB1bnBhaWQgaW52b2ljZXNcblxuICAgIC8vIEFJIGNvc3QgY2FsY3VsYXRpb24gd2l0aCBjb25maWd1cmFibGUgbGltaXRcbiAgICAvLyBUT0RPOiBSZXBsYWNlIHdpdGggYWN0dWFsIEFJIHVzYWdlIHRyYWNraW5nIGZyb20gYWlNZXRlciBzeXN0ZW1cbiAgICBjb25zdCB0b3RhbExlYWRzID0gYXdhaXQgZGIubGVhZC5jb3VudCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICBndGU6IG1vbnRoU3RhcnQsXG4gICAgICAgICAgbHRlOiBlbmREYXRlXG4gICAgICAgIH0sXG4gICAgICAgIC8vIENSSVRJQ0FMOiBFeGNsdWRlIGVtcGxveWVlIHJlZmVycmFscyBmcm9tIFByb3ZpZGVyIEFJIGNvc3QgY2FsY3VsYXRpb25zXG4gICAgICAgIE5PVDoge1xuICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICB7IHNvdXJjZVR5cGU6ICdNQU5VQUxfRU1QTE9ZRUVfUkVGRVJSQUwnIH0sXG4gICAgICAgICAgICB7IHNvdXJjZVR5cGU6ICdFTVBMT1lFRV9SRUZFUlJBTCcgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZW5yaWNobWVudEpzb246IHtcbiAgICAgICAgICAgICAgICBwYXRoOiBbJ2JpbGxpbmcnLCAnZW1wbG95ZWVSZXdhcmRFbGlnaWJsZSddLFxuICAgICAgICAgICAgICAgIGVxdWFsczogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBlc3RpbWF0ZWRBaUNvc3QgPSB0b3RhbExlYWRzICogMC4wMiArIG1vbnRobHlDb252ZXJ0ZWRMZWFkcyAqIDAuMTtcbiAgICBjb25zdCBtYXhBaUNvc3RQZXJNb250aCA9IDUwOyAvLyBEZWZhdWx0IGxpbWl0IC0gc2hvdWxkIGNvbWUgZnJvbSBwcm92aWRlciBzZXR0aW5nc1xuICAgIGNvbnN0IGFpQ29zdHMgPSBNYXRoLm1pbihlc3RpbWF0ZWRBaUNvc3QsIG1heEFpQ29zdFBlck1vbnRoKTtcbiAgICBjb25zdCBuZXRQcm9maXQgPSBtb250aGx5UmV2ZW51ZSAtIGFpQ29zdHM7XG4gICAgY29uc3QgcHJvZml0TWFyZ2luID0gbW9udGhseVJldmVudWUgPiAwID8gbmV0UHJvZml0IC8gbW9udGhseVJldmVudWUgOiAwO1xuICAgIGNvbnN0IGF2ZXJhZ2VSZXZlbnVlUGVyTGVhZCA9IHBlcmlvZENvbnZlcnRlZExlYWRzID4gMCA/IChwZXJpb2RDb252ZXJ0ZWRMZWFkcyAqIDEwMCkgLyBwZXJpb2RDb252ZXJ0ZWRMZWFkcyA6IDEwMDtcblxuICAgIC8vIFByb2plY3QgbW9udGhseSByZXZlbnVlIGJhc2VkIG9uIGN1cnJlbnQgdHJlbmRzXG4gICAgY29uc3QgZGF5c0luTW9udGggPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCkgKyAxLCAwKS5nZXREYXRlKCk7XG4gICAgY29uc3QgZGF5c1NvRmFyID0gbm93LmdldERhdGUoKTtcbiAgICBjb25zdCBwcm9qZWN0ZWRNb250aGx5UmV2ZW51ZSA9IGRheXNTb0ZhciA+IDAgPyAobW9udGhseVJldmVudWUgLyBkYXlzU29GYXIpICogZGF5c0luTW9udGggOiBtb250aGx5UmV2ZW51ZTtcblxuICAgIC8vIE1vbnRobHkgYnJlYWtkb3duIC0gZ2V0IGxhc3QgNiBtb250aHNcbiAgICBjb25zdCBtb250aGx5QnJlYWtkb3duID0gW107XG4gICAgZm9yIChsZXQgaSA9IDU7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBjb25zdCBtb250aFN0YXJ0ID0gbmV3IERhdGUoZW5kRGF0ZS5nZXRGdWxsWWVhcigpLCBlbmREYXRlLmdldE1vbnRoKCkgLSBpLCAxKTtcbiAgICAgIGNvbnN0IG1vbnRoRW5kID0gbmV3IERhdGUoZW5kRGF0ZS5nZXRGdWxsWWVhcigpLCBlbmREYXRlLmdldE1vbnRoKCkgLSBpICsgMSwgMCwgMjMsIDU5LCA1OSk7XG5cbiAgICAgIGNvbnN0IGxlYWRzID0gYXdhaXQgZGIubGVhZC5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICBndGU6IG1vbnRoU3RhcnQsXG4gICAgICAgICAgICBsdGU6IG1vbnRoRW5kXG4gICAgICAgICAgfSxcbiAgICAgICAgICAvLyBDUklUSUNBTDogRXhjbHVkZSBlbXBsb3llZSByZWZlcnJhbHMgZnJvbSBQcm92aWRlciByZXZlbnVlIGNhbGN1bGF0aW9uc1xuICAgICAgICAgIE5PVDoge1xuICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnTUFOVUFMX0VNUExPWUVFX1JFRkVSUkFMJyB9LFxuICAgICAgICAgICAgICB7IHNvdXJjZVR5cGU6ICdFTVBMT1lFRV9SRUZFUlJBTCcgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgICAgICAgICBwYXRoOiBbJ2JpbGxpbmcnLCAnZW1wbG95ZWVSZXdhcmRFbGlnaWJsZSddLFxuICAgICAgICAgICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgY29udmVyc2lvbnMgPSBhd2FpdCBkYi5sZWFkLmNvdW50KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjb252ZXJ0ZWRBdDoge1xuICAgICAgICAgICAgZ3RlOiBtb250aFN0YXJ0LFxuICAgICAgICAgICAgbHRlOiBtb250aEVuZFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZW5yaWNobWVudEpzb246IHtcbiAgICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdiaWxsYWJsZUVsaWdpYmxlJ10sXG4gICAgICAgICAgICBlcXVhbHM6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIC8vIENSSVRJQ0FMOiBFeGNsdWRlIGVtcGxveWVlIHJlZmVycmFscyBmcm9tIFByb3ZpZGVyIHJldmVudWVcbiAgICAgICAgICBOT1Q6IHtcbiAgICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICAgIHsgc291cmNlVHlwZTogJ01BTlVBTF9FTVBMT1lFRV9SRUZFUlJBTCcgfSxcbiAgICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnRU1QTE9ZRUVfUkVGRVJSQUwnIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2VtcGxveWVlUmV3YXJkRWxpZ2libGUnXSxcbiAgICAgICAgICAgICAgICAgIGVxdWFsczogdHJ1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJldmVudWUgPSBjb252ZXJzaW9ucyAqIDEwMDtcbiAgICAgIC8vIEFJIGNvc3QgY2FsY3VsYXRpb24gd2l0aCBjb25maWd1cmFibGUgbGltaXRcbiAgICAgIC8vIFRPRE86IFJlcGxhY2Ugd2l0aCBhY3R1YWwgQUkgdXNhZ2UgdHJhY2tpbmcgZnJvbSBhaU1ldGVyIHN5c3RlbVxuICAgICAgY29uc3QgZXN0aW1hdGVkQWlDb3N0ID0gbGVhZHMgKiAwLjAyICsgY29udmVyc2lvbnMgKiAwLjE7XG4gICAgICBjb25zdCBtYXhBaUNvc3RQZXJNb250aCA9IDUwOyAvLyBEZWZhdWx0IGxpbWl0IC0gc2hvdWxkIGNvbWUgZnJvbSBwcm92aWRlciBzZXR0aW5nc1xuICAgICAgY29uc3QgYWlDb3N0ID0gTWF0aC5taW4oZXN0aW1hdGVkQWlDb3N0LCBtYXhBaUNvc3RQZXJNb250aCk7XG4gICAgICBjb25zdCBuZXRQcm9maXQgPSByZXZlbnVlIC0gYWlDb3N0O1xuICAgICAgY29uc3QgcHJvZml0TWFyZ2luID0gcmV2ZW51ZSA+IDAgPyBuZXRQcm9maXQgLyByZXZlbnVlIDogMDtcblxuICAgICAgbW9udGhseUJyZWFrZG93bi5wdXNoKHtcbiAgICAgICAgbW9udGg6IG1vbnRoU3RhcnQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbGVhZHMsXG4gICAgICAgIGNvbnZlcnNpb25zLFxuICAgICAgICByZXZlbnVlLFxuICAgICAgICBhaUNvc3QsXG4gICAgICAgIG5ldFByb2ZpdCxcbiAgICAgICAgcHJvZml0TWFyZ2luXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBDbGllbnQgcmV2ZW51ZSBicmVha2Rvd25cbiAgICBjb25zdCBvcmdzID0gYXdhaXQgZGIub3JnLmZpbmRNYW55KHtcbiAgICAgIHNlbGVjdDoge1xuICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgbmFtZTogdHJ1ZVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgY2xpZW50UmV2ZW51ZSA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgb3Jncy5tYXAoYXN5bmMgKG9yZykgPT4ge1xuICAgICAgICBjb25zdCBtb250aGx5Q29udmVyc2lvbnMgPSBhd2FpdCBkYi5sZWFkLmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgb3JnSWQ6IG9yZy5pZCxcbiAgICAgICAgICAgIGNvbnZlcnRlZEF0OiB7XG4gICAgICAgICAgICAgIGd0ZTogbW9udGhTdGFydCxcbiAgICAgICAgICAgICAgbHRlOiBlbmREYXRlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5yaWNobWVudEpzb246IHtcbiAgICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2JpbGxhYmxlRWxpZ2libGUnXSxcbiAgICAgICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gQ1JJVElDQUw6IEV4Y2x1ZGUgZW1wbG95ZWUgcmVmZXJyYWxzIGZyb20gUHJvdmlkZXIgcmV2ZW51ZVxuICAgICAgICAgICAgTk9UOiB7XG4gICAgICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnTUFOVUFMX0VNUExPWUVFX1JFRkVSUkFMJyB9LFxuICAgICAgICAgICAgICAgIHsgc291cmNlVHlwZTogJ0VNUExPWUVFX1JFRkVSUkFMJyB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGVucmljaG1lbnRKc29uOiB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IFsnYmlsbGluZycsICdlbXBsb3llZVJld2FyZEVsaWdpYmxlJ10sXG4gICAgICAgICAgICAgICAgICAgIGVxdWFsczogdHJ1ZVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdG90YWxDb252ZXJzaW9ucyA9IGF3YWl0IGRiLmxlYWQuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICBvcmdJZDogb3JnLmlkLFxuICAgICAgICAgICAgY29udmVydGVkQXQ6IHsgbm90OiBudWxsIH0sXG4gICAgICAgICAgICBlbnJpY2htZW50SnNvbjoge1xuICAgICAgICAgICAgICBwYXRoOiBbJ2JpbGxpbmcnLCAnYmlsbGFibGVFbGlnaWJsZSddLFxuICAgICAgICAgICAgICBlcXVhbHM6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBDUklUSUNBTDogRXhjbHVkZSBlbXBsb3llZSByZWZlcnJhbHMgZnJvbSBQcm92aWRlciByZXZlbnVlXG4gICAgICAgICAgICBOT1Q6IHtcbiAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICB7IHNvdXJjZVR5cGU6ICdNQU5VQUxfRU1QTE9ZRUVfUkVGRVJSQUwnIH0sXG4gICAgICAgICAgICAgICAgeyBzb3VyY2VUeXBlOiAnRU1QTE9ZRUVfUkVGRVJSQUwnIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgZW5yaWNobWVudEpzb246IHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogWydiaWxsaW5nJywgJ2VtcGxveWVlUmV3YXJkRWxpZ2libGUnXSxcbiAgICAgICAgICAgICAgICAgICAgZXF1YWxzOiB0cnVlXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBtb250aGx5UmV2ZW51ZSA9IG1vbnRobHlDb252ZXJzaW9ucyAqIDEwMDtcbiAgICAgICAgY29uc3QgdG90YWxSZXZlbnVlID0gdG90YWxDb252ZXJzaW9ucyAqIDEwMDtcbiAgICAgICAgY29uc3QgYXZlcmFnZVJldmVudWVQZXJDb252ZXJzaW9uID0gdG90YWxDb252ZXJzaW9ucyA+IDAgPyB0b3RhbFJldmVudWUgLyB0b3RhbENvbnZlcnNpb25zIDogMTAwO1xuXG4gICAgICAgIC8vIE1vY2sgcGF5bWVudCBzdGF0dXMgLSB3b3VsZCBiZSBjYWxjdWxhdGVkIGZyb20gYWN0dWFsIGJpbGxpbmcgcmVjb3Jkc1xuICAgICAgICBjb25zdCBzdGF0dXM6ICdwYWlkJyB8ICdwZW5kaW5nJyB8ICdvdmVyZHVlJyA9IG1vbnRobHlSZXZlbnVlID4gMCA/ICdwYWlkJyA6ICdwZW5kaW5nJztcbiAgICAgICAgY29uc3QgbGFzdFBheW1lbnQgPSBtb250aGx5UmV2ZW51ZSA+IDAgPyBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgOiBudWxsO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9yZy5pZCxcbiAgICAgICAgICBjbGllbnROYW1lOiBvcmcubmFtZSxcbiAgICAgICAgICBtb250aGx5UmV2ZW51ZSxcbiAgICAgICAgICB0b3RhbFJldmVudWUsXG4gICAgICAgICAgY29udmVyc2lvbnM6IHRvdGFsQ29udmVyc2lvbnMsXG4gICAgICAgICAgYXZlcmFnZVJldmVudWVQZXJDb252ZXJzaW9uLFxuICAgICAgICAgIGxhc3RQYXltZW50LFxuICAgICAgICAgIHN0YXR1c1xuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgLy8gU29ydCBieSBtb250aGx5IHJldmVudWVcbiAgICBjbGllbnRSZXZlbnVlLnNvcnQoKGEsIGIpID0+IGIubW9udGhseVJldmVudWUgLSBhLm1vbnRobHlSZXZlbnVlKTtcblxuICAgIC8vIE1vY2sgdHJhbnNhY3Rpb24gaGlzdG9yeSAtIHdvdWxkIGNvbWUgZnJvbSBhY3R1YWwgYmlsbGluZy9wYXltZW50IHJlY29yZHNcbiAgICBjb25zdCB0cmFuc2FjdGlvbnM6IEFycmF5PHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBjbGllbnRJZDogc3RyaW5nO1xuICAgICAgY2xpZW50TmFtZTogc3RyaW5nO1xuICAgICAgYW1vdW50OiBudW1iZXI7XG4gICAgICB0eXBlOiAnbGVhZF9jb252ZXJzaW9uJyB8ICdhaV9jb3N0JyB8ICdhZGp1c3RtZW50JztcbiAgICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcgfCAncGVuZGluZycgfCAnZmFpbGVkJztcbiAgICB9PiA9IGNsaWVudFJldmVudWUuc2xpY2UoMCwgMTApLmZsYXRNYXAoY2xpZW50ID0+IHtcbiAgICAgIGNvbnN0IGNsaWVudFRyYW5zYWN0aW9ucyA9IFtdO1xuICAgICAgXG4gICAgICBpZiAoY2xpZW50Lm1vbnRobHlSZXZlbnVlID4gMCkge1xuICAgICAgICBjbGllbnRUcmFuc2FjdGlvbnMucHVzaCh7XG4gICAgICAgICAgaWQ6IGB0eG5fJHtjbGllbnQuY2xpZW50SWR9XyR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgIGNsaWVudElkOiBjbGllbnQuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50TmFtZTogY2xpZW50LmNsaWVudE5hbWUsXG4gICAgICAgICAgYW1vdW50OiBjbGllbnQubW9udGhseVJldmVudWUsXG4gICAgICAgICAgdHlwZTogJ2xlYWRfY29udmVyc2lvbicgYXMgY29uc3QsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGAke2NsaWVudC5jb252ZXJzaW9uc30gbGVhZCBjb252ZXJzaW9uc2AsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyBhcyBjb25zdFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNsaWVudFRyYW5zYWN0aW9ucztcbiAgICB9KTtcblxuICAgIC8vIEFkZCBBSSBjb3N0IHRyYW5zYWN0aW9uc1xuICAgIGlmIChhaUNvc3RzID4gMCkge1xuICAgICAgdHJhbnNhY3Rpb25zLnVuc2hpZnQoe1xuICAgICAgICBpZDogYGFpX2Nvc3RfJHtEYXRlLm5vdygpfWAsXG4gICAgICAgIGNsaWVudElkOiAnc3lzdGVtJyxcbiAgICAgICAgY2xpZW50TmFtZTogJ1N5c3RlbSBBSSBDb3N0cycsXG4gICAgICAgIGFtb3VudDogYWlDb3N0cyxcbiAgICAgICAgdHlwZTogJ2FpX2Nvc3QnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ01vbnRobHkgQUkgcHJvY2Vzc2luZyBjb3N0cycsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTb3J0IHRyYW5zYWN0aW9ucyBieSBkYXRlIChuZXdlc3QgZmlyc3QpXG4gICAgdHJhbnNhY3Rpb25zLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIuY3JlYXRlZEF0KS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLmNyZWF0ZWRBdCkuZ2V0VGltZSgpKTtcblxuICAgIGNvbnN0IHJldmVudWVEYXRhID0ge1xuICAgICAgc3VtbWFyeToge1xuICAgICAgICB0b3RhbFJldmVudWUsXG4gICAgICAgIG1vbnRobHlSZXZlbnVlLFxuICAgICAgICBwZW5kaW5nUmV2ZW51ZSxcbiAgICAgICAgYWlDb3N0cyxcbiAgICAgICAgbmV0UHJvZml0LFxuICAgICAgICBwcm9maXRNYXJnaW4sXG4gICAgICAgIGF2ZXJhZ2VSZXZlbnVlUGVyTGVhZCxcbiAgICAgICAgcHJvamVjdGVkTW9udGhseVJldmVudWVcbiAgICAgIH0sXG4gICAgICBtb250aGx5QnJlYWtkb3duLFxuICAgICAgY2xpZW50UmV2ZW51ZTogY2xpZW50UmV2ZW51ZS5zbGljZSgwLCAxMCksIC8vIFRvcCAxMCBjbGllbnRzXG4gICAgICB0cmFuc2FjdGlvbnM6IHRyYW5zYWN0aW9ucy5zbGljZSgwLCAyMCkgLy8gUmVjZW50IDIwIHRyYW5zYWN0aW9uc1xuICAgIH07XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBkYXRhOiByZXZlbnVlRGF0YVxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdQcm92aWRlciByZXZlbnVlIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIG9rOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGZldGNoIHJldmVudWUgZGF0YScgXG4gICAgfSk7XG4gIH1cbn0iXSwibmFtZXMiOlsicHJpc21hIiwiZGIiLCJnZXRFbWFpbEZyb21SZXEiLCJlbnN1cmVQcm92aWRlciIsInJlcSIsInJlcyIsImVtYWlsIiwic3RhdHVzIiwianNvbiIsIm9rIiwiZXJyb3IiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwic2VsZWN0IiwiaWQiLCJyb2xlIiwiZ2V0RGF0ZVJhbmdlIiwicmFuZ2UiLCJub3ciLCJEYXRlIiwic3RhcnREYXRlIiwiZ2V0VGltZSIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJlbmREYXRlIiwiaGFuZGxlciIsIm1ldGhvZCIsInNldEhlYWRlciIsInF1ZXJ5IiwibW9udGhTdGFydCIsInRvdGFsQ29udmVydGVkTGVhZHMiLCJsZWFkIiwiY291bnQiLCJjb252ZXJ0ZWRBdCIsIm5vdCIsImVucmljaG1lbnRKc29uIiwicGF0aCIsImVxdWFscyIsIk5PVCIsIk9SIiwic291cmNlVHlwZSIsIm1vbnRobHlDb252ZXJ0ZWRMZWFkcyIsImd0ZSIsImx0ZSIsInBlcmlvZENvbnZlcnRlZExlYWRzIiwidG90YWxSZXZlbnVlIiwibW9udGhseVJldmVudWUiLCJwZW5kaW5nUmV2ZW51ZSIsInRvdGFsTGVhZHMiLCJjcmVhdGVkQXQiLCJlc3RpbWF0ZWRBaUNvc3QiLCJtYXhBaUNvc3RQZXJNb250aCIsImFpQ29zdHMiLCJNYXRoIiwibWluIiwibmV0UHJvZml0IiwicHJvZml0TWFyZ2luIiwiYXZlcmFnZVJldmVudWVQZXJMZWFkIiwiZGF5c0luTW9udGgiLCJnZXREYXRlIiwiZGF5c1NvRmFyIiwicHJvamVjdGVkTW9udGhseVJldmVudWUiLCJtb250aGx5QnJlYWtkb3duIiwiaSIsIm1vbnRoRW5kIiwibGVhZHMiLCJjb252ZXJzaW9ucyIsInJldmVudWUiLCJhaUNvc3QiLCJwdXNoIiwibW9udGgiLCJ0b0lTT1N0cmluZyIsIm9yZ3MiLCJvcmciLCJmaW5kTWFueSIsIm5hbWUiLCJjbGllbnRSZXZlbnVlIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm1vbnRobHlDb252ZXJzaW9ucyIsIm9yZ0lkIiwidG90YWxDb252ZXJzaW9ucyIsImF2ZXJhZ2VSZXZlbnVlUGVyQ29udmVyc2lvbiIsImxhc3RQYXltZW50IiwiY2xpZW50SWQiLCJjbGllbnROYW1lIiwic29ydCIsImEiLCJiIiwidHJhbnNhY3Rpb25zIiwic2xpY2UiLCJmbGF0TWFwIiwiY2xpZW50IiwiY2xpZW50VHJhbnNhY3Rpb25zIiwiYW1vdW50IiwidHlwZSIsImRlc2NyaXB0aW9uIiwidW5zaGlmdCIsInJldmVudWVEYXRhIiwic3VtbWFyeSIsImRhdGEiLCJjb25zb2xlIiwibWVzc2FnZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/provider/revenue.ts\n");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fprovider%2Frevenue&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fprovider%2Frevenue.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();