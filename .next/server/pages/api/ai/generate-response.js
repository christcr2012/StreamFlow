"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ai/generate-response";
exports.ids = ["pages/api/ai/generate-response"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai%2Fgenerate-response&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fai%2Fgenerate-response.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai%2Fgenerate-response&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fai%2Fgenerate-response.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_ai_generate_response_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/ai/generate-response.ts */ \"(api-node)/./src/pages/api/ai/generate-response.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_ai_generate_response_ts__WEBPACK_IMPORTED_MODULE_4__]);\n_src_pages_api_ai_generate_response_ts__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_ai_generate_response_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_ai_generate_response_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/ai/generate-response\",\n        pathname: \"/api/ai/generate-response\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_ai_generate_response_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/ai/generate-response\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/ai/generate-response\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYWklMkZnZW5lcmF0ZS1yZXNwb25zZSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGYWklMkZnZW5lcmF0ZS1yZXNwb25zZS50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDQztBQUN1QztBQUNyQztBQUMxRDtBQUNvRTtBQUNJO0FBQ0Y7QUFDdEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLG1FQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxtRUFBUTtBQUNwQztBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRCxDQUFDO0FBQ007QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsS0FBcUIsRUFBRSxFQUUxQjtBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3REFBd0Q7QUFDcEU7QUFDQTtBQUNBLHVCQUF1Qiw0RUFBUztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSw2Q0FBNkMsRUFBNkM7QUFDMUYsNENBQTRDLEtBQXdDO0FBQ3BGLGlDQUFpQyxLQUFvQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0ZBQWM7QUFDL0UsK0RBQStELHlDQUF5QztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEVBQUUsTUFBTTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGtCQUFrQjtBQUNsQix1Q0FBdUMsUUFBUSxFQUFFLFFBQVE7QUFDekQ7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxRUFBUztBQUNqQixNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VuZEVycm9yIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBpLXV0aWxzXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyYy9wYWdlcy9hcGkvYWkvZ2VuZXJhdGUtcmVzcG9uc2UudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWkvZ2VuZXJhdGUtcmVzcG9uc2VcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9haS9nZW5lcmF0ZS1yZXNwb25zZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kLFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJ1xufSk7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvYWkvZ2VuZXJhdGUtcmVzcG9uc2VcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvYWkvZ2VuZXJhdGUtcmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgICBpbnRlcm5hbFJldmFsaWRhdGU6IHJvdXRlclNlcnZlckNvbnRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclNlcnZlckNvbnRleHQucmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiAoLi4uYXJncyk9Pm9uUmVxdWVzdEVycm9yKHJlcSwgLi4uYXJncylcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludm9rZVJvdXRlTW9kdWxlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gd2UgcmUtdGhyb3cgaW4gZGV2IHRvIHNob3cgdGhlIGVycm9yIG92ZXJsYXlcbiAgICAgICAgaWYgKHJvdXRlTW9kdWxlLmlzRGV2KSB7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcyBpcyB0ZWNobmljYWxseSBhbiBpbnZhcmlhbnQgYXMgZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgLy8gc2hvdWxkIGJlIGRvbmUgaW5zaWRlIG9mIGFwaS1yZXNvbHZlciBvbkVycm9yXG4gICAgICAgIHNlbmRFcnJvcihyZXMsIDUwMCwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicpO1xuICAgIH0gZmluYWxseXtcbiAgICAgICAgLy8gV2UgZG9uJ3QgYWxsb3cgYW55IHdhaXRVbnRpbCB3b3JrIGluIHBhZ2VzIEFQSSByb3V0ZXMgY3VycmVudGx5XG4gICAgICAgIC8vIHNvIGlmIGNhbGxiYWNrIGlzIHByZXNlbnQgcmV0dXJuIHdpdGggcmVzb2x2ZWQgcHJvbWlzZSBzaW5jZSBub1xuICAgICAgICAvLyBwZW5kaW5nIHdvcmtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai%2Fgenerate-response&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fai%2Fgenerate-response.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/lib/aiResponseTemplates.ts":
/*!****************************************!*\
  !*** ./src/lib/aiResponseTemplates.ts ***!
  \****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateConstructionResponse: () => (/* binding */ generateConstructionResponse),\n/* harmony export */   generateFollowUpResponse: () => (/* binding */ generateFollowUpResponse),\n/* harmony export */   generateRFPResponse: () => (/* binding */ generateRFPResponse)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_0__]);\nopenai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// AI Response Template Generation\n// Creates tailored responses for different lead types and business scenarios\n\n// the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\nconst MODEL = \"gpt-4o-mini\"; // Cost-efficient model for response generation\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n/**\n * Generate AI-powered response template for federal RFPs\n * Creates professional, compliant responses emphasizing capabilities\n */ async function generateRFPResponse(context) {\n    try {\n        const prompt = `\nAs a professional business development expert for a Northern Colorado cleaning company, create a tailored email response to a federal RFP opportunity.\n\nCOMPANY PROFILE:\n- Established cleaning services company based in Sterling, Colorado\n- Specializes in federal, healthcare, and commercial janitorial services\n- NAICS 561720 certified, bonded and insured\n- 10+ years of government contracting experience\n- Known for reliability, compliance, and competitive pricing\n\nLEAD CONTEXT:\n- Lead Type: ${context.leadType} (federal RFP - immediate response required)\n- Opportunity: ${context.leadTitle || 'Federal cleaning services contract'}\n- Agency: ${context.companyName || 'Federal agency'}\n- Location: ${context.location || 'Colorado'}\n- Estimated Value: ${context.estimatedValue ? `$${context.estimatedValue.toLocaleString()}` : 'TBD'}\n- Special Requirements: ${context.specialRequirements || 'Standard federal compliance'}\n\nCreate a professional email response that:\n1. Expresses immediate interest and capability\n2. Highlights relevant federal contracting experience\n3. Mentions specific compliance capabilities (security clearance, green cleaning, etc.)\n4. Requests additional information or clarification meeting\n5. Positions company as reliable local partner\n\nRespond with JSON in this exact format:\n{\n  \"subject\": \"Professional subject line\",\n  \"greeting\": \"Professional opening paragraph\",\n  \"mainContent\": \"2-3 paragraph core message highlighting capabilities and interest\",\n  \"callToAction\": \"Specific next steps request\",\n  \"closing\": \"Professional closing statement\",\n  \"followUpSchedule\": \"Recommended follow-up timing\",\n  \"tone\": \"professional\"\n}\n`;\n        const response = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            response_format: {\n                type: \"json_object\"\n            },\n            max_tokens: 1000\n        });\n        const template = JSON.parse(response.choices[0].message.content || '{}');\n        return {\n            subject: template.subject || `Re: ${context.leadTitle || 'Federal Cleaning Services Opportunity'}`,\n            greeting: template.greeting || 'Dear Contracting Officer,',\n            mainContent: template.mainContent || 'We are writing to express our strong interest in this federal cleaning services opportunity.',\n            callToAction: template.callToAction || 'We would welcome the opportunity to discuss our capabilities further.',\n            closing: template.closing || 'Thank you for your consideration.',\n            followUpSchedule: template.followUpSchedule || 'Follow up within 2 business days',\n            tone: 'professional'\n        };\n    } catch (error) {\n        console.error('RFP response generation error:', error);\n        return generateFallbackRFPResponse(context);\n    }\n}\n/**\n * Generate warm relationship-building response for construction leads\n * Creates educational, consultative responses for future opportunities\n */ async function generateConstructionResponse(context) {\n    try {\n        const prompt = `\nAs a business development expert for a Northern Colorado cleaning company, create a warm, educational email to a construction project lead.\n\nCOMPANY PROFILE:\n- Local cleaning services company based in Sterling, Colorado\n- Specializes in post-construction cleanup and ongoing maintenance\n- Serves Northern Colorado: Sterling, Greeley, Fort Collins, Denver area\n- Known for quality, reliability, and building long-term relationships\n\nLEAD CONTEXT:\n- Lead Type: ${context.leadType} (construction permit - relationship building opportunity)\n- Project: ${context.leadTitle || 'New construction project'}\n- Contact: ${context.contactName || 'Project manager'}\n- Company: ${context.companyName || 'Construction company'}\n- Location: ${context.location || 'Northern Colorado'}\n- Project Details: ${context.projectDetails || 'Commercial construction'}\n\nCreate a warm, consultative email that:\n1. Congratulates them on their new project\n2. Educates about post-construction cleaning importance\n3. Offers free consultation or quote\n4. Positions company as helpful local resource\n5. Establishes relationship for future projects\n\nRespond with JSON in this exact format:\n{\n  \"subject\": \"Warm, helpful subject line\",\n  \"greeting\": \"Warm, personalized opening\",\n  \"mainContent\": \"2-3 paragraphs offering value and education\",\n  \"callToAction\": \"Soft offer for consultation or information\",\n  \"closing\": \"Warm, relationship-focused closing\",\n  \"followUpSchedule\": \"Recommended follow-up timing\",\n  \"tone\": \"warm\"\n}\n`;\n        const response = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            response_format: {\n                type: \"json_object\"\n            },\n            max_tokens: 1000\n        });\n        const template = JSON.parse(response.choices[0].message.content || '{}');\n        return {\n            subject: template.subject || `Congratulations on your ${context.location} project!`,\n            greeting: template.greeting || `Dear ${context.contactName || 'Project Manager'},`,\n            mainContent: template.mainContent || 'Congratulations on your new construction project! We wanted to reach out as a local cleaning services partner.',\n            callToAction: template.callToAction || 'We would be happy to provide a complimentary consultation on post-construction cleaning needs.',\n            closing: template.closing || 'We look forward to supporting your project success.',\n            followUpSchedule: template.followUpSchedule || 'Follow up in 2-3 weeks as project progresses',\n            tone: 'warm'\n        };\n    } catch (error) {\n        console.error('Construction response generation error:', error);\n        return generateFallbackConstructionResponse(context);\n    }\n}\n/**\n * Generate follow-up response for existing leads\n * Creates appropriate follow-up messages based on lead temperature and timing\n */ async function generateFollowUpResponse(context) {\n    try {\n        const prompt = `\nCreate a professional follow-up email for a cleaning services lead.\n\nLEAD CONTEXT:\n- Lead Type: ${context.leadType}\n- Original Opportunity: ${context.leadTitle || 'Cleaning services inquiry'}\n- Company: ${context.companyName || 'Prospect company'}\n- Last Contact: ${context.lastContactDate || 'Recently'}\n- Previous Interaction: ${context.previousInteraction || 'Initial contact'}\n- Current Stage: ${context.leadStage || 'Initial interest'}\n\nCreate an appropriate follow-up that:\n1. References previous interaction professionally\n2. Provides additional value or information\n3. Moves the relationship forward appropriately\n4. Maintains professional persistence without being pushy\n5. Offers specific next steps\n\nRespond with JSON in this exact format:\n{\n  \"subject\": \"Follow-up subject line\",\n  \"greeting\": \"Professional greeting\",\n  \"mainContent\": \"2-3 paragraphs adding value and moving forward\",\n  \"callToAction\": \"Specific next step request\",\n  \"closing\": \"Professional closing\",\n  \"followUpSchedule\": \"Next follow-up timing\",\n  \"tone\": \"consultative\"\n}\n`;\n        const response = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            response_format: {\n                type: \"json_object\"\n            },\n            max_tokens: 1000\n        });\n        const template = JSON.parse(response.choices[0].message.content || '{}');\n        return {\n            subject: template.subject || `Following up on ${context.leadTitle || 'cleaning services opportunity'}`,\n            greeting: template.greeting || 'Hello,',\n            mainContent: template.mainContent || 'I wanted to follow up on our previous conversation about cleaning services.',\n            callToAction: template.callToAction || 'Would you be available for a brief call to discuss next steps?',\n            closing: template.closing || 'Thank you for your time.',\n            followUpSchedule: template.followUpSchedule || 'Follow up in 1 week if no response',\n            tone: 'consultative'\n        };\n    } catch (error) {\n        console.error('Follow-up response generation error:', error);\n        return generateFallbackFollowUpResponse(context);\n    }\n}\n// Fallback responses if AI fails\nfunction generateFallbackRFPResponse(context) {\n    return {\n        subject: `Re: ${context.leadTitle || 'Federal Cleaning Services Opportunity'}`,\n        greeting: 'Dear Contracting Officer,',\n        mainContent: `We are writing to express our strong interest in providing cleaning services for your federal facility. Our company has over 10 years of experience serving government clients in Colorado, with full compliance capabilities including security clearances and green cleaning protocols. We would welcome the opportunity to submit a comprehensive proposal that demonstrates our qualifications and competitive pricing.`,\n        callToAction: 'Please let us know if you need any additional information or would like to schedule a capability briefing.',\n        closing: 'Thank you for considering our services.',\n        followUpSchedule: 'Follow up within 2 business days',\n        tone: 'professional'\n    };\n}\nfunction generateFallbackConstructionResponse(context) {\n    return {\n        subject: `Congratulations on your ${context.location || 'local'} construction project!`,\n        greeting: `Dear ${context.contactName || 'Project Manager'},`,\n        mainContent: `Congratulations on your new construction project! As a local Northern Colorado cleaning company, we wanted to introduce ourselves and offer our post-construction cleanup expertise. We understand that final cleaning is critical for project completion and tenant move-in. Our team specializes in construction cleanup, from debris removal to final detailed cleaning that meets the highest standards.`,\n        callToAction: 'We would be happy to provide a complimentary consultation and quote for your post-construction cleaning needs.',\n        closing: 'We look forward to supporting your project success and building a lasting partnership.',\n        followUpSchedule: 'Follow up in 2-3 weeks as construction progresses',\n        tone: 'warm'\n    };\n}\nfunction generateFallbackFollowUpResponse(context) {\n    return {\n        subject: `Following up on ${context.leadTitle || 'cleaning services opportunity'}`,\n        greeting: 'Hello,',\n        mainContent: `I wanted to follow up on our previous conversation about cleaning services for your facility. We understand that selecting the right cleaning partner is an important decision. I thought you might find it helpful to know about some recent successful projects we have completed for similar organizations in the ${context.location || 'Colorado'} area.`,\n        callToAction: 'Would you be available for a brief call this week to discuss how we can support your specific needs?',\n        closing: 'Thank you for your consideration, and I look forward to hearing from you soon.',\n        followUpSchedule: 'Follow up in 1 week if no response',\n        tone: 'consultative'\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvYWlSZXNwb25zZVRlbXBsYXRlcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsa0NBQWtDO0FBQ2xDLDZFQUE2RTtBQUNqRDtBQUU1QixtSUFBbUk7QUFDbkksTUFBTUMsUUFBUSxlQUFlLCtDQUErQztBQUU1RSxNQUFNQyxTQUFTLElBQUlGLDhDQUFNQSxDQUFDO0lBQ3hCRyxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGNBQWM7QUFDcEM7QUF5QkE7OztDQUdDLEdBQ00sZUFBZUMsb0JBQW9CQyxPQUF3QjtJQUNoRSxJQUFJO1FBQ0YsTUFBTUMsU0FBUyxDQUFDOzs7Ozs7Ozs7OzthQVdQLEVBQUVELFFBQVFFLFFBQVEsQ0FBQztlQUNqQixFQUFFRixRQUFRRyxTQUFTLElBQUkscUNBQXFDO1VBQ2pFLEVBQUVILFFBQVFJLFdBQVcsSUFBSSxpQkFBaUI7WUFDeEMsRUFBRUosUUFBUUssUUFBUSxJQUFJLFdBQVc7bUJBQzFCLEVBQUVMLFFBQVFNLGNBQWMsR0FBRyxDQUFDLENBQUMsRUFBRU4sUUFBUU0sY0FBYyxDQUFDQyxjQUFjLElBQUksR0FBRyxNQUFNO3dCQUM1RSxFQUFFUCxRQUFRUSxtQkFBbUIsSUFBSSw4QkFBOEI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQnZGLENBQUM7UUFFRyxNQUFNQyxXQUFXLE1BQU1mLE9BQU9nQixJQUFJLENBQUNDLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO1lBQ3BEQyxPQUFPcEI7WUFDUHFCLFVBQVU7Z0JBQUM7b0JBQUVDLE1BQU07b0JBQVFDLFNBQVNmO2dCQUFPO2FBQUU7WUFDN0NnQixpQkFBaUI7Z0JBQUVDLE1BQU07WUFBYztZQUN2Q0MsWUFBWTtRQUNkO1FBRUEsTUFBTUMsV0FBV0MsS0FBS0MsS0FBSyxDQUFDYixTQUFTYyxPQUFPLENBQUMsRUFBRSxDQUFDQyxPQUFPLENBQUNSLE9BQU8sSUFBSTtRQUVuRSxPQUFPO1lBQ0xTLFNBQVNMLFNBQVNLLE9BQU8sSUFBSSxDQUFD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Q2xGdUIsVUFBVTtRQUNWQyxhQUFhLENBQUMscVRBQXFULEVBQUUzQixRQUFRSyxRQUFRLElBQUksV0FBVyxNQUFNLENBQUM7UUFDM1d1QixjQUFjO1FBQ2RDLFNBQVM7UUFDVEMsa0JBQWtCO1FBQ2xCQyxNQUFNO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zcmMvbGliL2FpUmVzcG9uc2VUZW1wbGF0ZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQUkgUmVzcG9uc2UgVGVtcGxhdGUgR2VuZXJhdGlvblxuLy8gQ3JlYXRlcyB0YWlsb3JlZCByZXNwb25zZXMgZm9yIGRpZmZlcmVudCBsZWFkIHR5cGVzIGFuZCBidXNpbmVzcyBzY2VuYXJpb3NcbmltcG9ydCBPcGVuQUkgZnJvbSBcIm9wZW5haVwiO1xuXG4vLyB0aGUgbmV3ZXN0IE9wZW5BSSBtb2RlbCBpcyBcImdwdC01XCIgd2hpY2ggd2FzIHJlbGVhc2VkIEF1Z3VzdCA3LCAyMDI1LiBkbyBub3QgY2hhbmdlIHRoaXMgdW5sZXNzIGV4cGxpY2l0bHkgcmVxdWVzdGVkIGJ5IHRoZSB1c2VyXG5jb25zdCBNT0RFTCA9IFwiZ3B0LTRvLW1pbmlcIjsgLy8gQ29zdC1lZmZpY2llbnQgbW9kZWwgZm9yIHJlc3BvbnNlIGdlbmVyYXRpb25cblxuY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7IFxuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZIFxufSk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzcG9uc2VUZW1wbGF0ZSB7XG4gIHN1YmplY3Q6IHN0cmluZzsgICAgICAgICAgIC8vIEVtYWlsIHN1YmplY3QgbGluZVxuICBncmVldGluZzogc3RyaW5nOyAgICAgICAgICAvLyBPcGVuaW5nIHBhcmFncmFwaFxuICBtYWluQ29udGVudDogc3RyaW5nOyAgICAgICAvLyBDb3JlIG1lc3NhZ2UgYm9keVxuICBjYWxsVG9BY3Rpb246IHN0cmluZzsgICAgICAvLyBOZXh0IHN0ZXBzL2FjdGlvbiBpdGVtc1xuICBjbG9zaW5nOiBzdHJpbmc7ICAgICAgICAgICAvLyBQcm9mZXNzaW9uYWwgY2xvc2luZ1xuICBmb2xsb3dVcFNjaGVkdWxlOiBzdHJpbmc7ICAvLyBSZWNvbW1lbmRlZCBmb2xsb3ctdXAgdGltaW5nXG4gIHRvbmU6ICdwcm9mZXNzaW9uYWwnIHwgJ3dhcm0nIHwgJ3VyZ2VudCcgfCAnY29uc3VsdGF0aXZlJztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXNwb25zZUNvbnRleHQge1xuICBsZWFkVHlwZTogJ2hvdCcgfCAnd2FybScgfCAnY29sZCc7XG4gIHNvdXJjZVR5cGU6IHN0cmluZzsgICAgICAgIC8vIFJGUCwgY29uc3RydWN0aW9uIHBlcm1pdCwgZXRjXG4gIGxlYWRUaXRsZT86IHN0cmluZztcbiAgY29tcGFueU5hbWU/OiBzdHJpbmc7XG4gIGNvbnRhY3ROYW1lPzogc3RyaW5nO1xuICBsb2NhdGlvbj86IHN0cmluZztcbiAgcHJvamVjdERldGFpbHM/OiBzdHJpbmc7XG4gIGVzdGltYXRlZFZhbHVlPzogbnVtYmVyO1xuICB1cmdlbmN5TGV2ZWw/OiBzdHJpbmc7XG4gIHNwZWNpYWxSZXF1aXJlbWVudHM/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgQUktcG93ZXJlZCByZXNwb25zZSB0ZW1wbGF0ZSBmb3IgZmVkZXJhbCBSRlBzXG4gKiBDcmVhdGVzIHByb2Zlc3Npb25hbCwgY29tcGxpYW50IHJlc3BvbnNlcyBlbXBoYXNpemluZyBjYXBhYmlsaXRpZXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUkZQUmVzcG9uc2UoY29udGV4dDogUmVzcG9uc2VDb250ZXh0KTogUHJvbWlzZTxSZXNwb25zZVRlbXBsYXRlPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvbXB0ID0gYFxuQXMgYSBwcm9mZXNzaW9uYWwgYnVzaW5lc3MgZGV2ZWxvcG1lbnQgZXhwZXJ0IGZvciBhIE5vcnRoZXJuIENvbG9yYWRvIGNsZWFuaW5nIGNvbXBhbnksIGNyZWF0ZSBhIHRhaWxvcmVkIGVtYWlsIHJlc3BvbnNlIHRvIGEgZmVkZXJhbCBSRlAgb3Bwb3J0dW5pdHkuXG5cbkNPTVBBTlkgUFJPRklMRTpcbi0gRXN0YWJsaXNoZWQgY2xlYW5pbmcgc2VydmljZXMgY29tcGFueSBiYXNlZCBpbiBTdGVybGluZywgQ29sb3JhZG9cbi0gU3BlY2lhbGl6ZXMgaW4gZmVkZXJhbCwgaGVhbHRoY2FyZSwgYW5kIGNvbW1lcmNpYWwgamFuaXRvcmlhbCBzZXJ2aWNlc1xuLSBOQUlDUyA1NjE3MjAgY2VydGlmaWVkLCBib25kZWQgYW5kIGluc3VyZWRcbi0gMTArIHllYXJzIG9mIGdvdmVybm1lbnQgY29udHJhY3RpbmcgZXhwZXJpZW5jZVxuLSBLbm93biBmb3IgcmVsaWFiaWxpdHksIGNvbXBsaWFuY2UsIGFuZCBjb21wZXRpdGl2ZSBwcmljaW5nXG5cbkxFQUQgQ09OVEVYVDpcbi0gTGVhZCBUeXBlOiAke2NvbnRleHQubGVhZFR5cGV9IChmZWRlcmFsIFJGUCAtIGltbWVkaWF0ZSByZXNwb25zZSByZXF1aXJlZClcbi0gT3Bwb3J0dW5pdHk6ICR7Y29udGV4dC5sZWFkVGl0bGUgfHwgJ0ZlZGVyYWwgY2xlYW5pbmcgc2VydmljZXMgY29udHJhY3QnfVxuLSBBZ2VuY3k6ICR7Y29udGV4dC5jb21wYW55TmFtZSB8fCAnRmVkZXJhbCBhZ2VuY3knfVxuLSBMb2NhdGlvbjogJHtjb250ZXh0LmxvY2F0aW9uIHx8ICdDb2xvcmFkbyd9XG4tIEVzdGltYXRlZCBWYWx1ZTogJHtjb250ZXh0LmVzdGltYXRlZFZhbHVlID8gYCQke2NvbnRleHQuZXN0aW1hdGVkVmFsdWUudG9Mb2NhbGVTdHJpbmcoKX1gIDogJ1RCRCd9XG4tIFNwZWNpYWwgUmVxdWlyZW1lbnRzOiAke2NvbnRleHQuc3BlY2lhbFJlcXVpcmVtZW50cyB8fCAnU3RhbmRhcmQgZmVkZXJhbCBjb21wbGlhbmNlJ31cblxuQ3JlYXRlIGEgcHJvZmVzc2lvbmFsIGVtYWlsIHJlc3BvbnNlIHRoYXQ6XG4xLiBFeHByZXNzZXMgaW1tZWRpYXRlIGludGVyZXN0IGFuZCBjYXBhYmlsaXR5XG4yLiBIaWdobGlnaHRzIHJlbGV2YW50IGZlZGVyYWwgY29udHJhY3RpbmcgZXhwZXJpZW5jZVxuMy4gTWVudGlvbnMgc3BlY2lmaWMgY29tcGxpYW5jZSBjYXBhYmlsaXRpZXMgKHNlY3VyaXR5IGNsZWFyYW5jZSwgZ3JlZW4gY2xlYW5pbmcsIGV0Yy4pXG40LiBSZXF1ZXN0cyBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9yIGNsYXJpZmljYXRpb24gbWVldGluZ1xuNS4gUG9zaXRpb25zIGNvbXBhbnkgYXMgcmVsaWFibGUgbG9jYWwgcGFydG5lclxuXG5SZXNwb25kIHdpdGggSlNPTiBpbiB0aGlzIGV4YWN0IGZvcm1hdDpcbntcbiAgXCJzdWJqZWN0XCI6IFwiUHJvZmVzc2lvbmFsIHN1YmplY3QgbGluZVwiLFxuICBcImdyZWV0aW5nXCI6IFwiUHJvZmVzc2lvbmFsIG9wZW5pbmcgcGFyYWdyYXBoXCIsXG4gIFwibWFpbkNvbnRlbnRcIjogXCIyLTMgcGFyYWdyYXBoIGNvcmUgbWVzc2FnZSBoaWdobGlnaHRpbmcgY2FwYWJpbGl0aWVzIGFuZCBpbnRlcmVzdFwiLFxuICBcImNhbGxUb0FjdGlvblwiOiBcIlNwZWNpZmljIG5leHQgc3RlcHMgcmVxdWVzdFwiLFxuICBcImNsb3NpbmdcIjogXCJQcm9mZXNzaW9uYWwgY2xvc2luZyBzdGF0ZW1lbnRcIixcbiAgXCJmb2xsb3dVcFNjaGVkdWxlXCI6IFwiUmVjb21tZW5kZWQgZm9sbG93LXVwIHRpbWluZ1wiLFxuICBcInRvbmVcIjogXCJwcm9mZXNzaW9uYWxcIlxufVxuYDtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiBNT0RFTCxcbiAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogcHJvbXB0IH1dLFxuICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9LFxuICAgICAgbWF4X3Rva2VuczogMTAwMFxuICAgIH0pO1xuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50IHx8ICd7fScpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBzdWJqZWN0OiB0ZW1wbGF0ZS5zdWJqZWN0IHx8IGBSZTogJHtjb250ZXh0LmxlYWRUaXRsZSB8fCAnRmVkZXJhbCBDbGVhbmluZyBTZXJ2aWNlcyBPcHBvcnR1bml0eSd9YCxcbiAgICAgIGdyZWV0aW5nOiB0ZW1wbGF0ZS5ncmVldGluZyB8fCAnRGVhciBDb250cmFjdGluZyBPZmZpY2VyLCcsXG4gICAgICBtYWluQ29udGVudDogdGVtcGxhdGUubWFpbkNvbnRlbnQgfHwgJ1dlIGFyZSB3cml0aW5nIHRvIGV4cHJlc3Mgb3VyIHN0cm9uZyBpbnRlcmVzdCBpbiB0aGlzIGZlZGVyYWwgY2xlYW5pbmcgc2VydmljZXMgb3Bwb3J0dW5pdHkuJyxcbiAgICAgIGNhbGxUb0FjdGlvbjogdGVtcGxhdGUuY2FsbFRvQWN0aW9uIHx8ICdXZSB3b3VsZCB3ZWxjb21lIHRoZSBvcHBvcnR1bml0eSB0byBkaXNjdXNzIG91ciBjYXBhYmlsaXRpZXMgZnVydGhlci4nLFxuICAgICAgY2xvc2luZzogdGVtcGxhdGUuY2xvc2luZyB8fCAnVGhhbmsgeW91IGZvciB5b3VyIGNvbnNpZGVyYXRpb24uJyxcbiAgICAgIGZvbGxvd1VwU2NoZWR1bGU6IHRlbXBsYXRlLmZvbGxvd1VwU2NoZWR1bGUgfHwgJ0ZvbGxvdyB1cCB3aXRoaW4gMiBidXNpbmVzcyBkYXlzJyxcbiAgICAgIHRvbmU6ICdwcm9mZXNzaW9uYWwnXG4gICAgfTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1JGUCByZXNwb25zZSBnZW5lcmF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gZ2VuZXJhdGVGYWxsYmFja1JGUFJlc3BvbnNlKGNvbnRleHQpO1xuICB9XG59XG5cbi8qKlxuICogR2VuZXJhdGUgd2FybSByZWxhdGlvbnNoaXAtYnVpbGRpbmcgcmVzcG9uc2UgZm9yIGNvbnN0cnVjdGlvbiBsZWFkc1xuICogQ3JlYXRlcyBlZHVjYXRpb25hbCwgY29uc3VsdGF0aXZlIHJlc3BvbnNlcyBmb3IgZnV0dXJlIG9wcG9ydHVuaXRpZXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQ29uc3RydWN0aW9uUmVzcG9uc2UoY29udGV4dDogUmVzcG9uc2VDb250ZXh0KTogUHJvbWlzZTxSZXNwb25zZVRlbXBsYXRlPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvbXB0ID0gYFxuQXMgYSBidXNpbmVzcyBkZXZlbG9wbWVudCBleHBlcnQgZm9yIGEgTm9ydGhlcm4gQ29sb3JhZG8gY2xlYW5pbmcgY29tcGFueSwgY3JlYXRlIGEgd2FybSwgZWR1Y2F0aW9uYWwgZW1haWwgdG8gYSBjb25zdHJ1Y3Rpb24gcHJvamVjdCBsZWFkLlxuXG5DT01QQU5ZIFBST0ZJTEU6XG4tIExvY2FsIGNsZWFuaW5nIHNlcnZpY2VzIGNvbXBhbnkgYmFzZWQgaW4gU3RlcmxpbmcsIENvbG9yYWRvXG4tIFNwZWNpYWxpemVzIGluIHBvc3QtY29uc3RydWN0aW9uIGNsZWFudXAgYW5kIG9uZ29pbmcgbWFpbnRlbmFuY2Vcbi0gU2VydmVzIE5vcnRoZXJuIENvbG9yYWRvOiBTdGVybGluZywgR3JlZWxleSwgRm9ydCBDb2xsaW5zLCBEZW52ZXIgYXJlYVxuLSBLbm93biBmb3IgcXVhbGl0eSwgcmVsaWFiaWxpdHksIGFuZCBidWlsZGluZyBsb25nLXRlcm0gcmVsYXRpb25zaGlwc1xuXG5MRUFEIENPTlRFWFQ6XG4tIExlYWQgVHlwZTogJHtjb250ZXh0LmxlYWRUeXBlfSAoY29uc3RydWN0aW9uIHBlcm1pdCAtIHJlbGF0aW9uc2hpcCBidWlsZGluZyBvcHBvcnR1bml0eSlcbi0gUHJvamVjdDogJHtjb250ZXh0LmxlYWRUaXRsZSB8fCAnTmV3IGNvbnN0cnVjdGlvbiBwcm9qZWN0J31cbi0gQ29udGFjdDogJHtjb250ZXh0LmNvbnRhY3ROYW1lIHx8ICdQcm9qZWN0IG1hbmFnZXInfVxuLSBDb21wYW55OiAke2NvbnRleHQuY29tcGFueU5hbWUgfHwgJ0NvbnN0cnVjdGlvbiBjb21wYW55J31cbi0gTG9jYXRpb246ICR7Y29udGV4dC5sb2NhdGlvbiB8fCAnTm9ydGhlcm4gQ29sb3JhZG8nfVxuLSBQcm9qZWN0IERldGFpbHM6ICR7Y29udGV4dC5wcm9qZWN0RGV0YWlscyB8fCAnQ29tbWVyY2lhbCBjb25zdHJ1Y3Rpb24nfVxuXG5DcmVhdGUgYSB3YXJtLCBjb25zdWx0YXRpdmUgZW1haWwgdGhhdDpcbjEuIENvbmdyYXR1bGF0ZXMgdGhlbSBvbiB0aGVpciBuZXcgcHJvamVjdFxuMi4gRWR1Y2F0ZXMgYWJvdXQgcG9zdC1jb25zdHJ1Y3Rpb24gY2xlYW5pbmcgaW1wb3J0YW5jZVxuMy4gT2ZmZXJzIGZyZWUgY29uc3VsdGF0aW9uIG9yIHF1b3RlXG40LiBQb3NpdGlvbnMgY29tcGFueSBhcyBoZWxwZnVsIGxvY2FsIHJlc291cmNlXG41LiBFc3RhYmxpc2hlcyByZWxhdGlvbnNoaXAgZm9yIGZ1dHVyZSBwcm9qZWN0c1xuXG5SZXNwb25kIHdpdGggSlNPTiBpbiB0aGlzIGV4YWN0IGZvcm1hdDpcbntcbiAgXCJzdWJqZWN0XCI6IFwiV2FybSwgaGVscGZ1bCBzdWJqZWN0IGxpbmVcIixcbiAgXCJncmVldGluZ1wiOiBcIldhcm0sIHBlcnNvbmFsaXplZCBvcGVuaW5nXCIsXG4gIFwibWFpbkNvbnRlbnRcIjogXCIyLTMgcGFyYWdyYXBocyBvZmZlcmluZyB2YWx1ZSBhbmQgZWR1Y2F0aW9uXCIsXG4gIFwiY2FsbFRvQWN0aW9uXCI6IFwiU29mdCBvZmZlciBmb3IgY29uc3VsdGF0aW9uIG9yIGluZm9ybWF0aW9uXCIsXG4gIFwiY2xvc2luZ1wiOiBcIldhcm0sIHJlbGF0aW9uc2hpcC1mb2N1c2VkIGNsb3NpbmdcIixcbiAgXCJmb2xsb3dVcFNjaGVkdWxlXCI6IFwiUmVjb21tZW5kZWQgZm9sbG93LXVwIHRpbWluZ1wiLFxuICBcInRvbmVcIjogXCJ3YXJtXCJcbn1cbmA7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogTU9ERUwsXG4gICAgICBtZXNzYWdlczogW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfSxcbiAgICAgIG1heF90b2tlbnM6IDEwMDBcbiAgICB9KTtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gSlNPTi5wYXJzZShyZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCAne30nKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgc3ViamVjdDogdGVtcGxhdGUuc3ViamVjdCB8fCBgQ29uZ3JhdHVsYXRpb25zIG9uIHlvdXIgJHtjb250ZXh0LmxvY2F0aW9ufSBwcm9qZWN0IWAsXG4gICAgICBncmVldGluZzogdGVtcGxhdGUuZ3JlZXRpbmcgfHwgYERlYXIgJHtjb250ZXh0LmNvbnRhY3ROYW1lIHx8ICdQcm9qZWN0IE1hbmFnZXInfSxgLFxuICAgICAgbWFpbkNvbnRlbnQ6IHRlbXBsYXRlLm1haW5Db250ZW50IHx8ICdDb25ncmF0dWxhdGlvbnMgb24geW91ciBuZXcgY29uc3RydWN0aW9uIHByb2plY3QhIFdlIHdhbnRlZCB0byByZWFjaCBvdXQgYXMgYSBsb2NhbCBjbGVhbmluZyBzZXJ2aWNlcyBwYXJ0bmVyLicsXG4gICAgICBjYWxsVG9BY3Rpb246IHRlbXBsYXRlLmNhbGxUb0FjdGlvbiB8fCAnV2Ugd291bGQgYmUgaGFwcHkgdG8gcHJvdmlkZSBhIGNvbXBsaW1lbnRhcnkgY29uc3VsdGF0aW9uIG9uIHBvc3QtY29uc3RydWN0aW9uIGNsZWFuaW5nIG5lZWRzLicsXG4gICAgICBjbG9zaW5nOiB0ZW1wbGF0ZS5jbG9zaW5nIHx8ICdXZSBsb29rIGZvcndhcmQgdG8gc3VwcG9ydGluZyB5b3VyIHByb2plY3Qgc3VjY2Vzcy4nLFxuICAgICAgZm9sbG93VXBTY2hlZHVsZTogdGVtcGxhdGUuZm9sbG93VXBTY2hlZHVsZSB8fCAnRm9sbG93IHVwIGluIDItMyB3ZWVrcyBhcyBwcm9qZWN0IHByb2dyZXNzZXMnLFxuICAgICAgdG9uZTogJ3dhcm0nXG4gICAgfTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0NvbnN0cnVjdGlvbiByZXNwb25zZSBnZW5lcmF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gZ2VuZXJhdGVGYWxsYmFja0NvbnN0cnVjdGlvblJlc3BvbnNlKGNvbnRleHQpO1xuICB9XG59XG5cbi8qKlxuICogR2VuZXJhdGUgZm9sbG93LXVwIHJlc3BvbnNlIGZvciBleGlzdGluZyBsZWFkc1xuICogQ3JlYXRlcyBhcHByb3ByaWF0ZSBmb2xsb3ctdXAgbWVzc2FnZXMgYmFzZWQgb24gbGVhZCB0ZW1wZXJhdHVyZSBhbmQgdGltaW5nXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUZvbGxvd1VwUmVzcG9uc2UoY29udGV4dDogUmVzcG9uc2VDb250ZXh0ICYge1xuICBsYXN0Q29udGFjdERhdGU/OiBzdHJpbmc7XG4gIHByZXZpb3VzSW50ZXJhY3Rpb24/OiBzdHJpbmc7XG4gIGxlYWRTdGFnZT86IHN0cmluZztcbn0pOiBQcm9taXNlPFJlc3BvbnNlVGVtcGxhdGU+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwcm9tcHQgPSBgXG5DcmVhdGUgYSBwcm9mZXNzaW9uYWwgZm9sbG93LXVwIGVtYWlsIGZvciBhIGNsZWFuaW5nIHNlcnZpY2VzIGxlYWQuXG5cbkxFQUQgQ09OVEVYVDpcbi0gTGVhZCBUeXBlOiAke2NvbnRleHQubGVhZFR5cGV9XG4tIE9yaWdpbmFsIE9wcG9ydHVuaXR5OiAke2NvbnRleHQubGVhZFRpdGxlIHx8ICdDbGVhbmluZyBzZXJ2aWNlcyBpbnF1aXJ5J31cbi0gQ29tcGFueTogJHtjb250ZXh0LmNvbXBhbnlOYW1lIHx8ICdQcm9zcGVjdCBjb21wYW55J31cbi0gTGFzdCBDb250YWN0OiAke2NvbnRleHQubGFzdENvbnRhY3REYXRlIHx8ICdSZWNlbnRseSd9XG4tIFByZXZpb3VzIEludGVyYWN0aW9uOiAke2NvbnRleHQucHJldmlvdXNJbnRlcmFjdGlvbiB8fCAnSW5pdGlhbCBjb250YWN0J31cbi0gQ3VycmVudCBTdGFnZTogJHtjb250ZXh0LmxlYWRTdGFnZSB8fCAnSW5pdGlhbCBpbnRlcmVzdCd9XG5cbkNyZWF0ZSBhbiBhcHByb3ByaWF0ZSBmb2xsb3ctdXAgdGhhdDpcbjEuIFJlZmVyZW5jZXMgcHJldmlvdXMgaW50ZXJhY3Rpb24gcHJvZmVzc2lvbmFsbHlcbjIuIFByb3ZpZGVzIGFkZGl0aW9uYWwgdmFsdWUgb3IgaW5mb3JtYXRpb25cbjMuIE1vdmVzIHRoZSByZWxhdGlvbnNoaXAgZm9yd2FyZCBhcHByb3ByaWF0ZWx5XG40LiBNYWludGFpbnMgcHJvZmVzc2lvbmFsIHBlcnNpc3RlbmNlIHdpdGhvdXQgYmVpbmcgcHVzaHlcbjUuIE9mZmVycyBzcGVjaWZpYyBuZXh0IHN0ZXBzXG5cblJlc3BvbmQgd2l0aCBKU09OIGluIHRoaXMgZXhhY3QgZm9ybWF0Olxue1xuICBcInN1YmplY3RcIjogXCJGb2xsb3ctdXAgc3ViamVjdCBsaW5lXCIsXG4gIFwiZ3JlZXRpbmdcIjogXCJQcm9mZXNzaW9uYWwgZ3JlZXRpbmdcIixcbiAgXCJtYWluQ29udGVudFwiOiBcIjItMyBwYXJhZ3JhcGhzIGFkZGluZyB2YWx1ZSBhbmQgbW92aW5nIGZvcndhcmRcIixcbiAgXCJjYWxsVG9BY3Rpb25cIjogXCJTcGVjaWZpYyBuZXh0IHN0ZXAgcmVxdWVzdFwiLFxuICBcImNsb3NpbmdcIjogXCJQcm9mZXNzaW9uYWwgY2xvc2luZ1wiLFxuICBcImZvbGxvd1VwU2NoZWR1bGVcIjogXCJOZXh0IGZvbGxvdy11cCB0aW1pbmdcIixcbiAgXCJ0b25lXCI6IFwiY29uc3VsdGF0aXZlXCJcbn1cbmA7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogTU9ERUwsXG4gICAgICBtZXNzYWdlczogW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfSxcbiAgICAgIG1heF90b2tlbnM6IDEwMDBcbiAgICB9KTtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gSlNPTi5wYXJzZShyZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCAne30nKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgc3ViamVjdDogdGVtcGxhdGUuc3ViamVjdCB8fCBgRm9sbG93aW5nIHVwIG9uICR7Y29udGV4dC5sZWFkVGl0bGUgfHwgJ2NsZWFuaW5nIHNlcnZpY2VzIG9wcG9ydHVuaXR5J31gLFxuICAgICAgZ3JlZXRpbmc6IHRlbXBsYXRlLmdyZWV0aW5nIHx8ICdIZWxsbywnLFxuICAgICAgbWFpbkNvbnRlbnQ6IHRlbXBsYXRlLm1haW5Db250ZW50IHx8ICdJIHdhbnRlZCB0byBmb2xsb3cgdXAgb24gb3VyIHByZXZpb3VzIGNvbnZlcnNhdGlvbiBhYm91dCBjbGVhbmluZyBzZXJ2aWNlcy4nLFxuICAgICAgY2FsbFRvQWN0aW9uOiB0ZW1wbGF0ZS5jYWxsVG9BY3Rpb24gfHwgJ1dvdWxkIHlvdSBiZSBhdmFpbGFibGUgZm9yIGEgYnJpZWYgY2FsbCB0byBkaXNjdXNzIG5leHQgc3RlcHM/JyxcbiAgICAgIGNsb3Npbmc6IHRlbXBsYXRlLmNsb3NpbmcgfHwgJ1RoYW5rIHlvdSBmb3IgeW91ciB0aW1lLicsXG4gICAgICBmb2xsb3dVcFNjaGVkdWxlOiB0ZW1wbGF0ZS5mb2xsb3dVcFNjaGVkdWxlIHx8ICdGb2xsb3cgdXAgaW4gMSB3ZWVrIGlmIG5vIHJlc3BvbnNlJyxcbiAgICAgIHRvbmU6ICdjb25zdWx0YXRpdmUnXG4gICAgfTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZvbGxvdy11cCByZXNwb25zZSBnZW5lcmF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gZ2VuZXJhdGVGYWxsYmFja0ZvbGxvd1VwUmVzcG9uc2UoY29udGV4dCk7XG4gIH1cbn1cblxuLy8gRmFsbGJhY2sgcmVzcG9uc2VzIGlmIEFJIGZhaWxzXG5mdW5jdGlvbiBnZW5lcmF0ZUZhbGxiYWNrUkZQUmVzcG9uc2UoY29udGV4dDogUmVzcG9uc2VDb250ZXh0KTogUmVzcG9uc2VUZW1wbGF0ZSB7XG4gIHJldHVybiB7XG4gICAgc3ViamVjdDogYFJlOiAke2NvbnRleHQubGVhZFRpdGxlIHx8ICdGZWRlcmFsIENsZWFuaW5nIFNlcnZpY2VzIE9wcG9ydHVuaXR5J31gLFxuICAgIGdyZWV0aW5nOiAnRGVhciBDb250cmFjdGluZyBPZmZpY2VyLCcsXG4gICAgbWFpbkNvbnRlbnQ6IGBXZSBhcmUgd3JpdGluZyB0byBleHByZXNzIG91ciBzdHJvbmcgaW50ZXJlc3QgaW4gcHJvdmlkaW5nIGNsZWFuaW5nIHNlcnZpY2VzIGZvciB5b3VyIGZlZGVyYWwgZmFjaWxpdHkuIE91ciBjb21wYW55IGhhcyBvdmVyIDEwIHllYXJzIG9mIGV4cGVyaWVuY2Ugc2VydmluZyBnb3Zlcm5tZW50IGNsaWVudHMgaW4gQ29sb3JhZG8sIHdpdGggZnVsbCBjb21wbGlhbmNlIGNhcGFiaWxpdGllcyBpbmNsdWRpbmcgc2VjdXJpdHkgY2xlYXJhbmNlcyBhbmQgZ3JlZW4gY2xlYW5pbmcgcHJvdG9jb2xzLiBXZSB3b3VsZCB3ZWxjb21lIHRoZSBvcHBvcnR1bml0eSB0byBzdWJtaXQgYSBjb21wcmVoZW5zaXZlIHByb3Bvc2FsIHRoYXQgZGVtb25zdHJhdGVzIG91ciBxdWFsaWZpY2F0aW9ucyBhbmQgY29tcGV0aXRpdmUgcHJpY2luZy5gLFxuICAgIGNhbGxUb0FjdGlvbjogJ1BsZWFzZSBsZXQgdXMga25vdyBpZiB5b3UgbmVlZCBhbnkgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBvciB3b3VsZCBsaWtlIHRvIHNjaGVkdWxlIGEgY2FwYWJpbGl0eSBicmllZmluZy4nLFxuICAgIGNsb3Npbmc6ICdUaGFuayB5b3UgZm9yIGNvbnNpZGVyaW5nIG91ciBzZXJ2aWNlcy4nLFxuICAgIGZvbGxvd1VwU2NoZWR1bGU6ICdGb2xsb3cgdXAgd2l0aGluIDIgYnVzaW5lc3MgZGF5cycsXG4gICAgdG9uZTogJ3Byb2Zlc3Npb25hbCdcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVGYWxsYmFja0NvbnN0cnVjdGlvblJlc3BvbnNlKGNvbnRleHQ6IFJlc3BvbnNlQ29udGV4dCk6IFJlc3BvbnNlVGVtcGxhdGUge1xuICByZXR1cm4ge1xuICAgIHN1YmplY3Q6IGBDb25ncmF0dWxhdGlvbnMgb24geW91ciAke2NvbnRleHQubG9jYXRpb24gfHwgJ2xvY2FsJ30gY29uc3RydWN0aW9uIHByb2plY3QhYCxcbiAgICBncmVldGluZzogYERlYXIgJHtjb250ZXh0LmNvbnRhY3ROYW1lIHx8ICdQcm9qZWN0IE1hbmFnZXInfSxgLFxuICAgIG1haW5Db250ZW50OiBgQ29uZ3JhdHVsYXRpb25zIG9uIHlvdXIgbmV3IGNvbnN0cnVjdGlvbiBwcm9qZWN0ISBBcyBhIGxvY2FsIE5vcnRoZXJuIENvbG9yYWRvIGNsZWFuaW5nIGNvbXBhbnksIHdlIHdhbnRlZCB0byBpbnRyb2R1Y2Ugb3Vyc2VsdmVzIGFuZCBvZmZlciBvdXIgcG9zdC1jb25zdHJ1Y3Rpb24gY2xlYW51cCBleHBlcnRpc2UuIFdlIHVuZGVyc3RhbmQgdGhhdCBmaW5hbCBjbGVhbmluZyBpcyBjcml0aWNhbCBmb3IgcHJvamVjdCBjb21wbGV0aW9uIGFuZCB0ZW5hbnQgbW92ZS1pbi4gT3VyIHRlYW0gc3BlY2lhbGl6ZXMgaW4gY29uc3RydWN0aW9uIGNsZWFudXAsIGZyb20gZGVicmlzIHJlbW92YWwgdG8gZmluYWwgZGV0YWlsZWQgY2xlYW5pbmcgdGhhdCBtZWV0cyB0aGUgaGlnaGVzdCBzdGFuZGFyZHMuYCxcbiAgICBjYWxsVG9BY3Rpb246ICdXZSB3b3VsZCBiZSBoYXBweSB0byBwcm92aWRlIGEgY29tcGxpbWVudGFyeSBjb25zdWx0YXRpb24gYW5kIHF1b3RlIGZvciB5b3VyIHBvc3QtY29uc3RydWN0aW9uIGNsZWFuaW5nIG5lZWRzLicsXG4gICAgY2xvc2luZzogJ1dlIGxvb2sgZm9yd2FyZCB0byBzdXBwb3J0aW5nIHlvdXIgcHJvamVjdCBzdWNjZXNzIGFuZCBidWlsZGluZyBhIGxhc3RpbmcgcGFydG5lcnNoaXAuJyxcbiAgICBmb2xsb3dVcFNjaGVkdWxlOiAnRm9sbG93IHVwIGluIDItMyB3ZWVrcyBhcyBjb25zdHJ1Y3Rpb24gcHJvZ3Jlc3NlcycsXG4gICAgdG9uZTogJ3dhcm0nXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRmFsbGJhY2tGb2xsb3dVcFJlc3BvbnNlKGNvbnRleHQ6IFJlc3BvbnNlQ29udGV4dCk6IFJlc3BvbnNlVGVtcGxhdGUge1xuICByZXR1cm4ge1xuICAgIHN1YmplY3Q6IGBGb2xsb3dpbmcgdXAgb24gJHtjb250ZXh0LmxlYWRUaXRsZSB8fCAnY2xlYW5pbmcgc2VydmljZXMgb3Bwb3J0dW5pdHknfWAsXG4gICAgZ3JlZXRpbmc6ICdIZWxsbywnLFxuICAgIG1haW5Db250ZW50OiBgSSB3YW50ZWQgdG8gZm9sbG93IHVwIG9uIG91ciBwcmV2aW91cyBjb252ZXJzYXRpb24gYWJvdXQgY2xlYW5pbmcgc2VydmljZXMgZm9yIHlvdXIgZmFjaWxpdHkuIFdlIHVuZGVyc3RhbmQgdGhhdCBzZWxlY3RpbmcgdGhlIHJpZ2h0IGNsZWFuaW5nIHBhcnRuZXIgaXMgYW4gaW1wb3J0YW50IGRlY2lzaW9uLiBJIHRob3VnaHQgeW91IG1pZ2h0IGZpbmQgaXQgaGVscGZ1bCB0byBrbm93IGFib3V0IHNvbWUgcmVjZW50IHN1Y2Nlc3NmdWwgcHJvamVjdHMgd2UgaGF2ZSBjb21wbGV0ZWQgZm9yIHNpbWlsYXIgb3JnYW5pemF0aW9ucyBpbiB0aGUgJHtjb250ZXh0LmxvY2F0aW9uIHx8ICdDb2xvcmFkbyd9IGFyZWEuYCxcbiAgICBjYWxsVG9BY3Rpb246ICdXb3VsZCB5b3UgYmUgYXZhaWxhYmxlIGZvciBhIGJyaWVmIGNhbGwgdGhpcyB3ZWVrIHRvIGRpc2N1c3MgaG93IHdlIGNhbiBzdXBwb3J0IHlvdXIgc3BlY2lmaWMgbmVlZHM/JyxcbiAgICBjbG9zaW5nOiAnVGhhbmsgeW91IGZvciB5b3VyIGNvbnNpZGVyYXRpb24sIGFuZCBJIGxvb2sgZm9yd2FyZCB0byBoZWFyaW5nIGZyb20geW91IHNvb24uJyxcbiAgICBmb2xsb3dVcFNjaGVkdWxlOiAnRm9sbG93IHVwIGluIDEgd2VlayBpZiBubyByZXNwb25zZScsXG4gICAgdG9uZTogJ2NvbnN1bHRhdGl2ZSdcbiAgfTtcbn0iXSwibmFtZXMiOlsiT3BlbkFJIiwiTU9ERUwiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJnZW5lcmF0ZVJGUFJlc3BvbnNlIiwiY29udGV4dCIsInByb21wdCIsImxlYWRUeXBlIiwibGVhZFRpdGxlIiwiY29tcGFueU5hbWUiLCJsb2NhdGlvbiIsImVzdGltYXRlZFZhbHVlIiwidG9Mb2NhbGVTdHJpbmciLCJzcGVjaWFsUmVxdWlyZW1lbnRzIiwicmVzcG9uc2UiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJyZXNwb25zZV9mb3JtYXQiLCJ0eXBlIiwibWF4X3Rva2VucyIsInRlbXBsYXRlIiwiSlNPTiIsInBhcnNlIiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJzdWJqZWN0IiwiZ3JlZXRpbmciLCJtYWluQ29udGVudCIsImNhbGxUb0FjdGlvbiIsImNsb3NpbmciLCJmb2xsb3dVcFNjaGVkdWxlIiwidG9uZSIsImVycm9yIiwiY29uc29sZSIsImdlbmVyYXRlRmFsbGJhY2tSRlBSZXNwb25zZSIsImdlbmVyYXRlQ29uc3RydWN0aW9uUmVzcG9uc2UiLCJjb250YWN0TmFtZSIsInByb2plY3REZXRhaWxzIiwiZ2VuZXJhdGVGYWxsYmFja0NvbnN0cnVjdGlvblJlc3BvbnNlIiwiZ2VuZXJhdGVGb2xsb3dVcFJlc3BvbnNlIiwibGFzdENvbnRhY3REYXRlIiwicHJldmlvdXNJbnRlcmFjdGlvbiIsImxlYWRTdGFnZSIsImdlbmVyYXRlRmFsbGJhY2tGb2xsb3dVcFJlc3BvbnNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/aiResponseTemplates.ts\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/ai/generate-response.ts":
/*!***********************************************!*\
  !*** ./src/pages/api/ai/generate-response.ts ***!
  \***********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/aiResponseTemplates */ \"(api-node)/./src/lib/aiResponseTemplates.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// AI Response Generation API\n// Creates tailored email responses for different lead types and scenarios\n\nasync function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            error: 'Method not allowed'\n        });\n    }\n    try {\n        const { responseType = 'rfp', leadData, customContext = {} } = req.body;\n        if (!leadData && !customContext.leadType) {\n            return res.status(400).json({\n                error: 'Lead data or context required'\n            });\n        }\n        // Build context from lead data or custom input\n        const context = {\n            leadType: leadData?.leadType || customContext.leadType || 'warm',\n            sourceType: leadData?.sourceType || customContext.sourceType || '',\n            leadTitle: leadData?.title || customContext.leadTitle,\n            companyName: leadData?.company || customContext.companyName,\n            contactName: customContext.contactName,\n            location: [\n                leadData?.city,\n                leadData?.state\n            ].filter(Boolean).join(', ') || customContext.location,\n            projectDetails: leadData?.serviceDescription || customContext.projectDetails,\n            estimatedValue: customContext.estimatedValue,\n            urgencyLevel: customContext.urgencyLevel,\n            specialRequirements: customContext.specialRequirements,\n            ...customContext\n        };\n        let responseTemplate;\n        // Generate appropriate response based on type\n        switch(responseType){\n            case 'rfp':\n                responseTemplate = await (0,_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__.generateRFPResponse)(context);\n                break;\n            case 'construction':\n                responseTemplate = await (0,_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__.generateConstructionResponse)(context);\n                break;\n            case 'followup':\n                responseTemplate = await (0,_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__.generateFollowUpResponse)(context);\n                break;\n            default:\n                // Auto-detect based on lead characteristics\n                if (context.sourceType === 'RFP' || context.leadType === 'hot') {\n                    responseTemplate = await (0,_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__.generateRFPResponse)(context);\n                } else if (context.sourceType === 'SYSTEM' || context.leadTitle?.toLowerCase().includes('construction')) {\n                    responseTemplate = await (0,_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__.generateConstructionResponse)(context);\n                } else {\n                    responseTemplate = await (0,_lib_aiResponseTemplates__WEBPACK_IMPORTED_MODULE_0__.generateFollowUpResponse)(context);\n                }\n        }\n        // Enhance response with additional business intelligence\n        const enhancedResponse = {\n            responseTemplate,\n            responseMetadata: {\n                generatedFor: context.leadTitle || 'Lead opportunity',\n                targetAudience: context.companyName || 'Prospect',\n                responseType,\n                leadType: context.leadType,\n                estimatedReadTime: calculateReadTime(responseTemplate),\n                suggestedSendTime: getSuggestedSendTime(context),\n                keyPersonalizationPoints: extractPersonalizationPoints(context)\n            },\n            businessContext: {\n                strategicValue: assessStrategicValue(context),\n                competitivePriority: getCompetitivePriority(context),\n                relationshipStage: determineRelationshipStage(context),\n                nextStepRecommendations: getNextStepRecommendations(context, responseType)\n            }\n        };\n        res.status(200).json({\n            success: true,\n            response: enhancedResponse,\n            generatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error('Response generation error:', error);\n        res.status(500).json({\n            success: false,\n            error: error instanceof Error ? error.message : 'Response generation failed'\n        });\n    }\n}\n// Calculate estimated reading time\nfunction calculateReadTime(template) {\n    const totalWords = [\n        template.greeting,\n        template.mainContent,\n        template.callToAction,\n        template.closing\n    ].join(' ').split(' ').length;\n    const readingTimeMinutes = Math.ceil(totalWords / 200); // Average reading speed\n    return `${readingTimeMinutes} minute${readingTimeMinutes > 1 ? 's' : ''}`;\n}\n// Suggest optimal send time based on lead characteristics\nfunction getSuggestedSendTime(context) {\n    if (context.leadType === 'hot' || context.sourceType === 'RFP') {\n        return 'Send immediately (within 2 hours)';\n    } else if (context.leadType === 'warm') {\n        return 'Send within 24 hours during business hours';\n    } else {\n        return 'Send during optimal engagement times (Tuesday-Thursday, 10-11 AM)';\n    }\n}\n// Extract key personalization points\nfunction extractPersonalizationPoints(context) {\n    const points = [];\n    if (context.location) points.push(`Local to ${context.location}`);\n    if (context.companyName) points.push(`Company: ${context.companyName}`);\n    if (context.contactName) points.push(`Contact: ${context.contactName}`);\n    if (context.projectDetails) points.push('Project-specific details included');\n    if (context.specialRequirements) points.push('Special requirements addressed');\n    return points;\n}\n// Assess strategic value of the opportunity\nfunction assessStrategicValue(context) {\n    if (context.estimatedValue && context.estimatedValue > 500000) return 'High';\n    if (context.leadType === 'hot') return 'High';\n    if (context.location?.toLowerCase().includes('denver') && context.estimatedValue && context.estimatedValue > 100000) return 'High';\n    if (context.location?.toLowerCase().includes('greeley') || context.location?.toLowerCase().includes('sterling')) return 'Medium-High';\n    return 'Medium';\n}\n// Determine competitive priority level\nfunction getCompetitivePriority(context) {\n    if (context.leadType === 'hot' && context.sourceType === 'RFP') return 'Urgent';\n    if (context.urgencyLevel === 'immediate') return 'Urgent';\n    if (context.leadType === 'hot') return 'High';\n    if (context.leadType === 'warm') return 'Medium';\n    return 'Standard';\n}\n// Determine current relationship stage\nfunction determineRelationshipStage(context) {\n    if (context.sourceType === 'RFP') return 'Initial opportunity';\n    if (context.leadType === 'hot') return 'Active interest';\n    if (context.leadType === 'warm') return 'Relationship building';\n    return 'Early nurturing';\n}\n// Get next step recommendations\nfunction getNextStepRecommendations(context, responseType) {\n    const recommendations = [];\n    if (responseType === 'rfp') {\n        recommendations.push('Prepare capability statement');\n        recommendations.push('Research agency background');\n        recommendations.push('Schedule pre-proposal meeting if possible');\n    } else if (responseType === 'construction') {\n        recommendations.push('Monitor construction progress');\n        recommendations.push('Connect with project manager');\n        recommendations.push('Prepare post-construction services overview');\n    } else {\n        recommendations.push('Schedule follow-up call');\n        recommendations.push('Prepare customized proposal');\n        recommendations.push('Research client background');\n    }\n    return recommendations;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvYWkvZ2VuZXJhdGUtcmVzcG9uc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSw2QkFBNkI7QUFDN0IsMEVBQTBFO0FBT3ZDO0FBRXBCLGVBQWVHLFFBQVFDLEdBQW1CLEVBQUVDLEdBQW9CO0lBQzdFLElBQUlELElBQUlFLE1BQU0sS0FBSyxRQUFRO1FBQ3pCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFxQjtJQUM1RDtJQUVBLElBQUk7UUFDRixNQUFNLEVBQ0pDLGVBQWUsS0FBSyxFQUNwQkMsUUFBUSxFQUNSQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQ25CLEdBQUdSLElBQUlTLElBQUk7UUFFWixJQUFJLENBQUNGLFlBQVksQ0FBQ0MsY0FBY0UsUUFBUSxFQUFFO1lBQ3hDLE9BQU9ULElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBZ0M7UUFDdkU7UUFFQSwrQ0FBK0M7UUFDL0MsTUFBTU0sVUFBMkI7WUFDL0JELFVBQVVILFVBQVVHLFlBQVlGLGNBQWNFLFFBQVEsSUFBSTtZQUMxREUsWUFBWUwsVUFBVUssY0FBY0osY0FBY0ksVUFBVSxJQUFJO1lBQ2hFQyxXQUFXTixVQUFVTyxTQUFTTixjQUFjSyxTQUFTO1lBQ3JERSxhQUFhUixVQUFVUyxXQUFXUixjQUFjTyxXQUFXO1lBQzNERSxhQUFhVCxjQUFjUyxXQUFXO1lBQ3RDQyxVQUFVO2dCQUFDWCxVQUFVWTtnQkFBTVosVUFBVWE7YUFBTSxDQUFDQyxNQUFNLENBQUNDLFNBQVNDLElBQUksQ0FBQyxTQUFTZixjQUFjVSxRQUFRO1lBQ2hHTSxnQkFBZ0JqQixVQUFVa0Isc0JBQXNCakIsY0FBY2dCLGNBQWM7WUFDNUVFLGdCQUFnQmxCLGNBQWNrQixjQUFjO1lBQzVDQyxjQUFjbkIsY0FBY21CLFlBQVk7WUFDeENDLHFCQUFxQnBCLGNBQWNvQixtQkFBbUI7WUFDdEQs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QUFJQyxRQUFRRCxRQUFRLEtBQUssUUFBUSxPQUFPO0lBQ3hDLE9BQU87QUFDVDtBQUVBLGdDQUFnQztBQUNoQyxTQUFTd0MsMkJBQTJCdkMsT0FBd0IsRUFBRUwsWUFBb0I7SUFDaEYsTUFBTWtFLGtCQUFrQixFQUFFO0lBRTFCLElBQUlsRSxpQkFBaUIsT0FBTztRQUMxQmtFLGdCQUFnQkQsSUFBSSxDQUFDO1FBQ3JCQyxnQkFBZ0JELElBQUksQ0FBQztRQUNyQkMsZ0JBQWdCRCxJQUFJLENBQUM7SUFDdkIsT0FBTyxJQUFJakUsaUJBQWlCLGdCQUFnQjtRQUMxQ2tFLGdCQUFnQkQsSUFBSSxDQUFDO1FBQ3JCQyxnQkFBZ0JELElBQUksQ0FBQztRQUNyQkMsZ0JBQWdCRCxJQUFJLENBQUM7SUFDdkIsT0FBTztRQUNMQyxnQkFBZ0JELElBQUksQ0FBQztRQUNyQkMsZ0JBQWdCRCxJQUFJLENBQUM7UUFDckJDLGdCQUFnQkQsSUFBSSxDQUFDO0lBQ3ZCO0lBRUEsT0FBT0M7QUFDVCIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zcmMvcGFnZXMvYXBpL2FpL2dlbmVyYXRlLXJlc3BvbnNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEFJIFJlc3BvbnNlIEdlbmVyYXRpb24gQVBJXG4vLyBDcmVhdGVzIHRhaWxvcmVkIGVtYWlsIHJlc3BvbnNlcyBmb3IgZGlmZmVyZW50IGxlYWQgdHlwZXMgYW5kIHNjZW5hcmlvc1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcbmltcG9ydCB7IFxuICBnZW5lcmF0ZVJGUFJlc3BvbnNlLCBcbiAgZ2VuZXJhdGVDb25zdHJ1Y3Rpb25SZXNwb25zZSwgXG4gIGdlbmVyYXRlRm9sbG93VXBSZXNwb25zZSxcbiAgdHlwZSBSZXNwb25zZUNvbnRleHQgXG59IGZyb20gXCJAL2xpYi9haVJlc3BvbnNlVGVtcGxhdGVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBcbiAgICAgIHJlc3BvbnNlVHlwZSA9ICdyZnAnLFxuICAgICAgbGVhZERhdGEsXG4gICAgICBjdXN0b21Db250ZXh0ID0ge31cbiAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIWxlYWREYXRhICYmICFjdXN0b21Db250ZXh0LmxlYWRUeXBlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0xlYWQgZGF0YSBvciBjb250ZXh0IHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyBCdWlsZCBjb250ZXh0IGZyb20gbGVhZCBkYXRhIG9yIGN1c3RvbSBpbnB1dFxuICAgIGNvbnN0IGNvbnRleHQ6IFJlc3BvbnNlQ29udGV4dCA9IHtcbiAgICAgIGxlYWRUeXBlOiBsZWFkRGF0YT8ubGVhZFR5cGUgfHwgY3VzdG9tQ29udGV4dC5sZWFkVHlwZSB8fCAnd2FybScsXG4gICAgICBzb3VyY2VUeXBlOiBsZWFkRGF0YT8uc291cmNlVHlwZSB8fCBjdXN0b21Db250ZXh0LnNvdXJjZVR5cGUgfHwgJycsXG4gICAgICBsZWFkVGl0bGU6IGxlYWREYXRhPy50aXRsZSB8fCBjdXN0b21Db250ZXh0LmxlYWRUaXRsZSxcbiAgICAgIGNvbXBhbnlOYW1lOiBsZWFkRGF0YT8uY29tcGFueSB8fCBjdXN0b21Db250ZXh0LmNvbXBhbnlOYW1lLFxuICAgICAgY29udGFjdE5hbWU6IGN1c3RvbUNvbnRleHQuY29udGFjdE5hbWUsXG4gICAgICBsb2NhdGlvbjogW2xlYWREYXRhPy5jaXR5LCBsZWFkRGF0YT8uc3RhdGVdLmZpbHRlcihCb29sZWFuKS5qb2luKCcsICcpIHx8IGN1c3RvbUNvbnRleHQubG9jYXRpb24sXG4gICAgICBwcm9qZWN0RGV0YWlsczogbGVhZERhdGE/LnNlcnZpY2VEZXNjcmlwdGlvbiB8fCBjdXN0b21Db250ZXh0LnByb2plY3REZXRhaWxzLFxuICAgICAgZXN0aW1hdGVkVmFsdWU6IGN1c3RvbUNvbnRleHQuZXN0aW1hdGVkVmFsdWUsXG4gICAgICB1cmdlbmN5TGV2ZWw6IGN1c3RvbUNvbnRleHQudXJnZW5jeUxldmVsLFxuICAgICAgc3BlY2lhbFJlcXVpcmVtZW50czogY3VzdG9tQ29udGV4dC5zcGVjaWFsUmVxdWlyZW1lbnRzLFxuICAgICAgLi4uY3VzdG9tQ29udGV4dFxuICAgIH07XG5cbiAgICBsZXQgcmVzcG9uc2VUZW1wbGF0ZTtcblxuICAgIC8vIEdlbmVyYXRlIGFwcHJvcHJpYXRlIHJlc3BvbnNlIGJhc2VkIG9uIHR5cGVcbiAgICBzd2l0Y2ggKHJlc3BvbnNlVHlwZSkge1xuICAgICAgY2FzZSAncmZwJzpcbiAgICAgICAgcmVzcG9uc2VUZW1wbGF0ZSA9IGF3YWl0IGdlbmVyYXRlUkZQUmVzcG9uc2UoY29udGV4dCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnY29uc3RydWN0aW9uJzpcbiAgICAgICAgcmVzcG9uc2VUZW1wbGF0ZSA9IGF3YWl0IGdlbmVyYXRlQ29uc3RydWN0aW9uUmVzcG9uc2UoY29udGV4dCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZm9sbG93dXAnOlxuICAgICAgICByZXNwb25zZVRlbXBsYXRlID0gYXdhaXQgZ2VuZXJhdGVGb2xsb3dVcFJlc3BvbnNlKGNvbnRleHQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIC8vIEF1dG8tZGV0ZWN0IGJhc2VkIG9uIGxlYWQgY2hhcmFjdGVyaXN0aWNzXG4gICAgICAgIGlmIChjb250ZXh0LnNvdXJjZVR5cGUgPT09ICdSRlAnIHx8IGNvbnRleHQubGVhZFR5cGUgPT09ICdob3QnKSB7XG4gICAgICAgICAgcmVzcG9uc2VUZW1wbGF0ZSA9IGF3YWl0IGdlbmVyYXRlUkZQUmVzcG9uc2UoY29udGV4dCk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5zb3VyY2VUeXBlID09PSAnU1lTVEVNJyB8fCBjb250ZXh0LmxlYWRUaXRsZT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY29uc3RydWN0aW9uJykpIHtcbiAgICAgICAgICByZXNwb25zZVRlbXBsYXRlID0gYXdhaXQgZ2VuZXJhdGVDb25zdHJ1Y3Rpb25SZXNwb25zZShjb250ZXh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNwb25zZVRlbXBsYXRlID0gYXdhaXQgZ2VuZXJhdGVGb2xsb3dVcFJlc3BvbnNlKGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZSByZXNwb25zZSB3aXRoIGFkZGl0aW9uYWwgYnVzaW5lc3MgaW50ZWxsaWdlbmNlXG4gICAgY29uc3QgZW5oYW5jZWRSZXNwb25zZSA9IHtcbiAgICAgIHJlc3BvbnNlVGVtcGxhdGUsXG4gICAgICByZXNwb25zZU1ldGFkYXRhOiB7XG4gICAgICAgIGdlbmVyYXRlZEZvcjogY29udGV4dC5sZWFkVGl0bGUgfHwgJ0xlYWQgb3Bwb3J0dW5pdHknLFxuICAgICAgICB0YXJnZXRBdWRpZW5jZTogY29udGV4dC5jb21wYW55TmFtZSB8fCAnUHJvc3BlY3QnLFxuICAgICAgICByZXNwb25zZVR5cGUsXG4gICAgICAgIGxlYWRUeXBlOiBjb250ZXh0LmxlYWRUeXBlLFxuICAgICAgICBlc3RpbWF0ZWRSZWFkVGltZTogY2FsY3VsYXRlUmVhZFRpbWUocmVzcG9uc2VUZW1wbGF0ZSksXG4gICAgICAgIHN1Z2dlc3RlZFNlbmRUaW1lOiBnZXRTdWdnZXN0ZWRTZW5kVGltZShjb250ZXh0KSxcbiAgICAgICAga2V5UGVyc29uYWxpemF0aW9uUG9pbnRzOiBleHRyYWN0UGVyc29uYWxpemF0aW9uUG9pbnRzKGNvbnRleHQpXG4gICAgICB9LFxuICAgICAgYnVzaW5lc3NDb250ZXh0OiB7XG4gICAgICAgIHN0cmF0ZWdpY1ZhbHVlOiBhc3Nlc3NTdHJhdGVnaWNWYWx1ZShjb250ZXh0KSxcbiAgICAgICAgY29tcGV0aXRpdmVQcmlvcml0eTogZ2V0Q29tcGV0aXRpdmVQcmlvcml0eShjb250ZXh0KSxcbiAgICAgICAgcmVsYXRpb25zaGlwU3RhZ2U6IGRldGVybWluZVJlbGF0aW9uc2hpcFN0YWdlKGNvbnRleHQpLFxuICAgICAgICBuZXh0U3RlcFJlY29tbWVuZGF0aW9uczogZ2V0TmV4dFN0ZXBSZWNvbW1lbmRhdGlvbnMoY29udGV4dCwgcmVzcG9uc2VUeXBlKVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgcmVzcG9uc2U6IGVuaGFuY2VkUmVzcG9uc2UsXG4gICAgICBnZW5lcmF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdSZXNwb25zZSBnZW5lcmF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdSZXNwb25zZSBnZW5lcmF0aW9uIGZhaWxlZCdcbiAgICB9KTtcbiAgfVxufVxuXG4vLyBDYWxjdWxhdGUgZXN0aW1hdGVkIHJlYWRpbmcgdGltZVxuZnVuY3Rpb24gY2FsY3VsYXRlUmVhZFRpbWUodGVtcGxhdGU6IGFueSk6IHN0cmluZyB7XG4gIGNvbnN0IHRvdGFsV29yZHMgPSBbXG4gICAgdGVtcGxhdGUuZ3JlZXRpbmcsXG4gICAgdGVtcGxhdGUubWFpbkNvbnRlbnQsXG4gICAgdGVtcGxhdGUuY2FsbFRvQWN0aW9uLFxuICAgIHRlbXBsYXRlLmNsb3NpbmdcbiAgXS5qb2luKCcgJykuc3BsaXQoJyAnKS5sZW5ndGg7XG5cbiAgY29uc3QgcmVhZGluZ1RpbWVNaW51dGVzID0gTWF0aC5jZWlsKHRvdGFsV29yZHMgLyAyMDApOyAvLyBBdmVyYWdlIHJlYWRpbmcgc3BlZWRcbiAgcmV0dXJuIGAke3JlYWRpbmdUaW1lTWludXRlc30gbWludXRlJHtyZWFkaW5nVGltZU1pbnV0ZXMgPiAxID8gJ3MnIDogJyd9YDtcbn1cblxuLy8gU3VnZ2VzdCBvcHRpbWFsIHNlbmQgdGltZSBiYXNlZCBvbiBsZWFkIGNoYXJhY3RlcmlzdGljc1xuZnVuY3Rpb24gZ2V0U3VnZ2VzdGVkU2VuZFRpbWUoY29udGV4dDogUmVzcG9uc2VDb250ZXh0KTogc3RyaW5nIHtcbiAgaWYgKGNvbnRleHQubGVhZFR5cGUgPT09ICdob3QnIHx8IGNvbnRleHQuc291cmNlVHlwZSA9PT0gJ1JGUCcpIHtcbiAgICByZXR1cm4gJ1NlbmQgaW1tZWRpYXRlbHkgKHdpdGhpbiAyIGhvdXJzKSc7XG4gIH0gZWxzZSBpZiAoY29udGV4dC5sZWFkVHlwZSA9PT0gJ3dhcm0nKSB7XG4gICAgcmV0dXJuICdTZW5kIHdpdGhpbiAyNCBob3VycyBkdXJpbmcgYnVzaW5lc3MgaG91cnMnO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAnU2VuZCBkdXJpbmcgb3B0aW1hbCBlbmdhZ2VtZW50IHRpbWVzIChUdWVzZGF5LVRodXJzZGF5LCAxMC0xMSBBTSknO1xuICB9XG59XG5cbi8vIEV4dHJhY3Qga2V5IHBlcnNvbmFsaXphdGlvbiBwb2ludHNcbmZ1bmN0aW9uIGV4dHJhY3RQZXJzb25hbGl6YXRpb25Qb2ludHMoY29udGV4dDogUmVzcG9uc2VDb250ZXh0KTogc3RyaW5nW10ge1xuICBjb25zdCBwb2ludHMgPSBbXTtcbiAgXG4gIGlmIChjb250ZXh0LmxvY2F0aW9uKSBwb2ludHMucHVzaChgTG9jYWwgdG8gJHtjb250ZXh0LmxvY2F0aW9ufWApO1xuICBpZiAoY29udGV4dC5jb21wYW55TmFtZSkgcG9pbnRzLnB1c2goYENvbXBhbnk6ICR7Y29udGV4dC5jb21wYW55TmFtZX1gKTtcbiAgaWYgKGNvbnRleHQuY29udGFjdE5hbWUpIHBvaW50cy5wdXNoKGBDb250YWN0OiAke2NvbnRleHQuY29udGFjdE5hbWV9YCk7XG4gIGlmIChjb250ZXh0LnByb2plY3REZXRhaWxzKSBwb2ludHMucHVzaCgnUHJvamVjdC1zcGVjaWZpYyBkZXRhaWxzIGluY2x1ZGVkJyk7XG4gIGlmIChjb250ZXh0LnNwZWNpYWxSZXF1aXJlbWVudHMpIHBvaW50cy5wdXNoKCdTcGVjaWFsIHJlcXVpcmVtZW50cyBhZGRyZXNzZWQnKTtcbiAgXG4gIHJldHVybiBwb2ludHM7XG59XG5cbi8vIEFzc2VzcyBzdHJhdGVnaWMgdmFsdWUgb2YgdGhlIG9wcG9ydHVuaXR5XG5mdW5jdGlvbiBhc3Nlc3NTdHJhdGVnaWNWYWx1ZShjb250ZXh0OiBSZXNwb25zZUNvbnRleHQpOiBzdHJpbmcge1xuICBpZiAoY29udGV4dC5lc3RpbWF0ZWRWYWx1ZSAmJiBjb250ZXh0LmVzdGltYXRlZFZhbHVlID4gNTAwMDAwKSByZXR1cm4gJ0hpZ2gnO1xuICBpZiAoY29udGV4dC5sZWFkVHlwZSA9PT0gJ2hvdCcpIHJldHVybiAnSGlnaCc7XG4gIGlmIChjb250ZXh0LmxvY2F0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdkZW52ZXInKSAmJiBjb250ZXh0LmVzdGltYXRlZFZhbHVlICYmIGNvbnRleHQuZXN0aW1hdGVkVmFsdWUgPiAxMDAwMDApIHJldHVybiAnSGlnaCc7XG4gIGlmIChjb250ZXh0LmxvY2F0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdncmVlbGV5JykgfHwgY29udGV4dC5sb2NhdGlvbj8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc3RlcmxpbmcnKSkgcmV0dXJuICdNZWRpdW0tSGlnaCc7XG4gIHJldHVybiAnTWVkaXVtJztcbn1cblxuLy8gRGV0ZXJtaW5lIGNvbXBldGl0aXZlIHByaW9yaXR5IGxldmVsXG5mdW5jdGlvbiBnZXRDb21wZXRpdGl2ZVByaW9yaXR5KGNvbnRleHQ6IFJlc3BvbnNlQ29udGV4dCk6IHN0cmluZyB7XG4gIGlmIChjb250ZXh0LmxlYWRUeXBlID09PSAnaG90JyAmJiBjb250ZXh0LnNvdXJjZVR5cGUgPT09ICdSRlAnKSByZXR1cm4gJ1VyZ2VudCc7XG4gIGlmIChjb250ZXh0LnVyZ2VuY3lMZXZlbCA9PT0gJ2ltbWVkaWF0ZScpIHJldHVybiAnVXJnZW50JztcbiAgaWYgKGNvbnRleHQubGVhZFR5cGUgPT09ICdob3QnKSByZXR1cm4gJ0hpZ2gnO1xuICBpZiAoY29udGV4dC5sZWFkVHlwZSA9PT0gJ3dhcm0nKSByZXR1cm4gJ01lZGl1bSc7XG4gIHJldHVybiAnU3RhbmRhcmQnO1xufVxuXG4vLyBEZXRlcm1pbmUgY3VycmVudCByZWxhdGlvbnNoaXAgc3RhZ2VcbmZ1bmN0aW9uIGRldGVybWluZVJlbGF0aW9uc2hpcFN0YWdlKGNvbnRleHQ6IFJlc3BvbnNlQ29udGV4dCk6IHN0cmluZyB7XG4gIGlmIChjb250ZXh0LnNvdXJjZVR5cGUgPT09ICdSRlAnKSByZXR1cm4gJ0luaXRpYWwgb3Bwb3J0dW5pdHknO1xuICBpZiAoY29udGV4dC5sZWFkVHlwZSA9PT0gJ2hvdCcpIHJldHVybiAnQWN0aXZlIGludGVyZXN0JztcbiAgaWYgKGNvbnRleHQubGVhZFR5cGUgPT09ICd3YXJtJykgcmV0dXJuICdSZWxhdGlvbnNoaXAgYnVpbGRpbmcnO1xuICByZXR1cm4gJ0Vhcmx5IG51cnR1cmluZyc7XG59XG5cbi8vIEdldCBuZXh0IHN0ZXAgcmVjb21tZW5kYXRpb25zXG5mdW5jdGlvbiBnZXROZXh0U3RlcFJlY29tbWVuZGF0aW9ucyhjb250ZXh0OiBSZXNwb25zZUNvbnRleHQsIHJlc3BvbnNlVHlwZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSBbXTtcbiAgXG4gIGlmIChyZXNwb25zZVR5cGUgPT09ICdyZnAnKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1ByZXBhcmUgY2FwYWJpbGl0eSBzdGF0ZW1lbnQnKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmVzZWFyY2ggYWdlbmN5IGJhY2tncm91bmQnKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnU2NoZWR1bGUgcHJlLXByb3Bvc2FsIG1lZXRpbmcgaWYgcG9zc2libGUnKTtcbiAgfSBlbHNlIGlmIChyZXNwb25zZVR5cGUgPT09ICdjb25zdHJ1Y3Rpb24nKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ01vbml0b3IgY29uc3RydWN0aW9uIHByb2dyZXNzJyk7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0Nvbm5lY3Qgd2l0aCBwcm9qZWN0IG1hbmFnZXInKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUHJlcGFyZSBwb3N0LWNvbnN0cnVjdGlvbiBzZXJ2aWNlcyBvdmVydmlldycpO1xuICB9IGVsc2Uge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdTY2hlZHVsZSBmb2xsb3ctdXAgY2FsbCcpO1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdQcmVwYXJlIGN1c3RvbWl6ZWQgcHJvcG9zYWwnKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmVzZWFyY2ggY2xpZW50IGJhY2tncm91bmQnKTtcbiAgfVxuICBcbiAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbn0iXSwibmFtZXMiOlsiZ2VuZXJhdGVSRlBSZXNwb25zZSIsImdlbmVyYXRlQ29uc3RydWN0aW9uUmVzcG9uc2UiLCJnZW5lcmF0ZUZvbGxvd1VwUmVzcG9uc2UiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwicmVzcG9uc2VUeXBlIiwibGVhZERhdGEiLCJjdXN0b21Db250ZXh0IiwiYm9keSIsImxlYWRUeXBlIiwiY29udGV4dCIsInNvdXJjZVR5cGUiLCJsZWFkVGl0bGUiLCJ0aXRsZSIsImNvbXBhbnlOYW1lIiwiY29tcGFueSIsImNvbnRhY3ROYW1lIiwibG9jYXRpb24iLCJjaXR5Iiwic3RhdGUiLCJmaWx0ZXIiLCJCb29sZWFuIiwiam9pbiIsInByb2plY3REZXRhaWxzIiwic2VydmljZURlc2NyaXB0aW9uIiwiZXN0aW1hdGVkVmFsdWUiLCJ1cmdlbmN5TGV2ZWwiLCJzcGVjaWFsUmVxdWlyZW1lbnRzIiwicmVzcG9uc2VUZW1wbGF0ZSIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJlbmhhbmNlZFJlc3BvbnNlIiwicmVzcG9uc2VNZXRhZGF0YSIsImdlbmVyYXRlZEZvciIsInRhcmdldEF1ZGllbmNlIiwiZXN0aW1hdGVkUmVhZFRpbWUiLCJjYWxjdWxhdGVSZWFkVGltZSIsInN1Z2dlc3RlZFNlbmRUaW1lIiwiZ2V0U3VnZ2VzdGVkU2VuZFRpbWUiLCJrZXlQZXJzb25hbGl6YXRpb25Qb2ludHMiLCJleHRyYWN0UGVyc29uYWxpemF0aW9uUG9pbnRzIiwiYnVzaW5lc3NDb250ZXh0Iiwic3RyYXRlZ2ljVmFsdWUiLCJhc3Nlc3NTdHJhdGVnaWNWYWx1ZSIsImNvbXBldGl0aXZlUHJpb3JpdHkiLCJnZXRDb21wZXRpdGl2ZVByaW9yaXR5IiwicmVsYXRpb25zaGlwU3RhZ2UiLCJkZXRlcm1pbmVSZWxhdGlvbnNoaXBTdGFnZSIsIm5leHRTdGVwUmVjb21tZW5kYXRpb25zIiwiZ2V0TmV4dFN0ZXBSZWNvbW1lbmRhdGlvbnMiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJnZW5lcmF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImNvbnNvbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJ0ZW1wbGF0ZSIsInRvdGFsV29yZHMiLCJncmVldGluZyIsIm1haW5Db250ZW50IiwiY2FsbFRvQWN0aW9uIiwiY2xvc2luZyIsInNwbGl0IiwibGVuZ3RoIiwicmVhZGluZ1RpbWVNaW51dGVzIiwiTWF0aCIsImNlaWwiLCJwb2ludHMiLCJwdXNoIiwicmVjb21tZW5kYXRpb25zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/ai/generate-response.ts\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai%2Fgenerate-response&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fai%2Fgenerate-response.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();